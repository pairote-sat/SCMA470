[["index.html", "SCMA 470 : Risk Analysis and Credibility Tutorial 3 Chapter 1 Basic Probability Concepts 1.1 Random Variables 1.2 Expectation 1.3 Variances of Random Variables 1.4 Moments and Moment Generating Function 1.5 Probability generating function 1.6 Multivariate Distributions 1.7 Independent random variables 1.8 Conditional Distributions 1.9 Covariance 1.10 Correlation 1.11 Model Fitting 1.12 The method of moments 1.13 The method of maximum likelihood 1.14 Goodness of fit tests 1.15 the Pearson chi-square goodness-of-fit criterion 1.16 Kolmogorov-Smirnov (K-S) test.", " SCMA 470 : Risk Analysis and Credibility Tutorial 3 Pairote Satiracoo 2022-12-09 Chapter 1 Basic Probability Concepts 1.1 Random Variables Definition 1.1 Let \\(S\\) be the sample space of an experiment. A real-valued function \\(X : S \\rightarrow \\mathbb{R}\\) is called a random variable of the experiment if, for each interval \\(I \\subset \\mathbb{R}, \\, \\{s : X(s) \\in I \\}\\) is an event. Random variables are often used for the calculation of the probabilities of events. The real-valued function \\(P(X \\le t)\\) characterizes \\(X\\), it tells us almost everything about \\(X\\). This function is called the cumulative distribution function of \\(X\\). The cumulative distribution function describes how the probabilities accumulate. Definition 1.2 If \\(X\\) is a random variable, then the function \\(F\\) defined on \\(\\mathbb{R}\\) by \\[F(x) = P(X \\le x)\\] is called the cumulative distribution function or simply distribution function (c.d.f) of \\(X\\). Functions that define the probability measure for discrete and continuous random variables are the probability mass function and the probability density function. Definition 1.3 Suppose \\(X\\) is a discrete random variable. Then the function \\[f(x) = P(X = x)\\] that is defined for each \\(x\\) in the range of \\(X\\) is called the probability mass function (p.m.f) of a random variable \\(X\\). Definition 1.4 Suppose \\(X\\) is a continuous random variable with c.d.f \\(F\\) and there exists a nonnegative, integrable function \\(f\\), \\(f: \\mathbb{R} \\rightarrow [0, \\infty)\\) such that \\[F(x) = \\int_{-\\infty}^x f(y)\\, dy\\] Then the function \\(f\\) is called the probability density function (p.d.f) of a random variable \\(X\\). 1.1.1 R Functions for Probability Distributions In R, density, distribution function, for the Poisson distribution with parameter \\(\\lambda\\) is shown as follows: Distribution Density function: \\(P(X = x)\\) Distribution function: \\(P(X ≤ x)\\) Quantile function (inverse c.d.f.) random generation Poisson dpois(x, lambda, log = FALSE) ppois(q, lambda, lower.tail = TRUE, log.p = FALSE) qpois(p, lambda, lower.tail = TRUE, log.p = FALSE) rpois(n, lambda) For the binomial distribution, these functions are pbinom, qbinom, dbinom, and rbinom. For the normal distribution, these functions are pnorm, qnorm, dnorm, and rnorm. And so forth. library(ggplot2) x &lt;- 0:20 myData &lt;- data.frame( k = factor(x), pK = dbinom(x, 20, .5)) ggplot(myData,aes(k,ymin=0,ymax=pK)) + geom_linerange() + ylab(&quot;p(k)&quot;) + scale_x_discrete(breaks=seq(0,20,5)) + ggtitle(&quot;p.m.f of binomial distribution&quot;) To plot continuous probability distribution in R, we use stat_function to add the density function as its arguement. To specify a different mean or standard deviation, we use the args parameter to supply new values. library(ggplot2) df &lt;- data.frame(x=seq(-10,10,by=0.1)) ggplot(df) + stat_function(aes(x),fun=dnorm, args = list(mean = 0, sd = 1)) + labs(x = &quot;x&quot;, y = &quot;f(x)&quot;, title = &quot;Normal Distribution With Mean = 0 &amp; SD = 1&quot;) 1.2 Expectation Definition 1.5 The expected value of a discrete random variable \\(X\\) with the set of possible values \\(A\\) and probability mass function \\(f(x)\\) is defined by \\[\\mathrm{E}(X) = \\sum_{x \\in A} x f(x)\\] The expected value of a random variable \\(X\\) is also called the mean, or the mathematical expectation, or simply the expectation of \\(X\\). It is also occasionally denoted by \\(\\mathrm{E}[X]\\), \\(\\mu_X\\), or \\(\\mu\\). Note that if each value \\(x\\) of \\(X\\) is weighted by \\(f(x) = P(X = x)\\), then \\(\\displaystyle \\sum_{x \\in A} x f(x)\\) is nothing but the weighted average of \\(X\\). Theorem 1.1 Let \\(X\\) be a discrete random variable with set of possible values \\(A\\) and probability mass function \\(f(x)\\), and let \\(g\\) be a real-valued function. Then \\(g(X)\\) is a random variable with \\[\\mathrm{E}[g(X)] = \\sum_{x \\in A} g(x) f(x)\\] Definition 1.6 If \\(X\\) is a continuous random variable with probability density function \\(f\\) , the expected value of \\(X\\) is defined by \\[\\mathrm{E}(X) = \\int_{-\\infty}^\\infty x f(x)\\, dx\\] Theorem 1.2 Let \\(X\\) be a continuous random variable with probability density function \\(f (x)\\); then for any function \\(h: \\mathbb{R} \\rightarrow \\mathbb{R}\\), \\[\\mathrm{E}[h(X)] = \\int_{-\\infty}^\\infty h(x)\\, f(x)\\, dx\\] * Theorem 1.3 Let \\(X\\) be a random variable. Let \\(h_1, h_2, . . . , h_n\\) be real-valued functions, and \\(a_1, a_2, \\ldots, a_n\\) be real numbers. Then \\[\\mathrm{E}[a_1 h_1(X) + a_2 h_2(X) + \\cdots + a_n h_n(X)] = a_1 \\mathrm{E}[h_1(X)] + a_2 \\mathrm{E}[h_2(X)] + \\ldots + a_n \\mathrm{E}[h_n(X)]\\] Moreover, if \\(a\\) and \\(b\\) are constants, then \\[\\mathrm{E}(aX +b) = a\\mathrm{E}(x) + b\\] 1.3 Variances of Random Variables Definition 1.7 Let \\(X\\) be a discrete random variable with a set of possible values \\(A\\), probability mass function \\(f(x)\\), and \\(\\mathrm{E}(X) = \\mu\\). then \\(\\mathrm{Var}(X)\\) and \\(\\sigma_X\\), called the variance and standard deviation of \\(X\\), respectively, are defined by \\[\\mathrm{Var}(X) = \\mathrm{E}[(X- \\mu)^2] = \\sum_{x \\in A} (x - \\mu)^2 f(x),\\] \\[\\sigma_X = \\sqrt{\\mathrm{E}[(X- \\mu)^2]}\\] Definition 1.8 If \\(X\\) is a continuous random variable with \\(\\mathrm{E}(X) = \\mu\\), then \\(\\mathrm{Var}(X)\\) and \\(\\sigma_X\\), called the variance and standard deviation of \\(X\\), respectively, are defined by \\[\\mathrm{Var}(X) = \\mathrm{E}[(X- \\mu)^2] = \\int_{-\\infty}^\\infty (x - \\mu)^2\\, f(x)\\, dx ,\\] \\[\\sigma_X = \\sqrt{\\mathrm{E}[(X- \\mu)^2]}\\] We have the following important relations \\[\\mathrm{Var}(x) = \\mathrm{E}(X^2) - (\\mathrm{E}(x))^2 ,\\] \\[\\mathrm{Var}(aX + b) = a^2\\ Var(X), \\quad \\sigma_{aX + b}= |a|\\sigma_X\\] where \\(a\\) and \\(b\\) are constants. 1.4 Moments and Moment Generating Function Definition 1.9 For \\(r &gt; 0\\), the \\(r\\)th moment of \\(X\\) (the \\(r\\)th moment about the origin) is \\(\\mathrm{E}[X^r]\\), when it is defined. The \\(r\\)th central moment of a random variable \\(X\\) (the \\(r\\)th moment about the mean) is \\(\\mathrm{E}[(X - \\mathrm{E}[X])^r].\\) Definition 1.10 The skewness of \\(X\\) is defined to be the third central moment, \\[\\mathrm{E}[(X - \\mathrm{E}[X])^3],\\] and the coefficient of skewness to be given by \\[\\frac{\\mathrm{E}[(X - \\mathrm{E}[X])^3]}{(\\mathrm{Var}[X])^{3/2}}.\\] Definition 1.11 The coefficient of kurtosis of \\(X\\) is defined by \\[\\frac{\\mathrm{E}[(X - \\mathrm{E}[X])^4]}{(\\mathrm{Var}[X])^{4/2}}.\\] Note In the formula, subtract from the mean and normalise or divide by the standard deviation center and scale to the standard values. Odd-order moments are increased if there is a long tail to the right and decreased if there is a long tail to the left, while even-order moments are increased if either tail is long. A negative value of the coefficient of skewness that the distribution is skewed to the left, or negatively skewed, meaning that the deviations above the mean tend to be smaller than the deviations below the mean, and vice versa. If the coefficent of skewness is close to zero, this could mean symmetry, Note The fourth moment measures the fatness in the tails, which is always positive. The kurtosis of the standard normal distribution is 3. Using the standard normal distribution as a benchmark, the excess kurtosis of a random variable is defined as the kurtosis minus 3. A higher kurtosis corresponds to a larger extremity of deviations (or outliers), which is called excess kurtosis. The following diagram compares the shape between the normal distribution and Student’s t-distribution. Note that to use the legend with the stat_function in ggplot2, we use scale_colour_manual along with colour = inside the aes() as shown below and give names for specific density plots. library(ggplot2) df &lt;- data.frame(x=seq(-10,10,by=0.1)) ggplot(df) + stat_function(aes(x, colour = &quot;dnorm&quot;),fun = dnorm, args = list(mean = 0, sd = 1)) + stat_function(aes(x, colour =&quot;dt&quot;),fun = dt, args = list(df = 4)) + scale_colour_manual(&quot;Legend title&quot;, values = c(&quot;black&quot;, &quot;blue&quot;)) + labs(x = &quot;x&quot;, y = &quot;f(x)&quot;, title = &quot;Normal Distribution With Mean = 0 &amp; SD = 1&quot;) + theme(plot.title = element_text(hjust = 0.5)) Next we will simulate 10000 samples from a normal distribution with mean 0, and standard deviation 1, then compute and interpret for the skewness and kurtosis, and plot the histogram. Here we also use the function set.seed() to set the seed of R’s random number generator, this is useful for creating simulations or random objects that can be reproduced. set.seed(15) # Set the seed of R&#39;s random number generator #Simulation n.sample &lt;- rnorm(n = 10000, mean = 0, sd = 1) #Skewness and Kurtosis library(moments) skewness(n.sample) ## [1] -0.03585812 kurtosis(n.sample) ## [1] 2.963189 ggplot(data.frame(x = n.sample),aes(x)) + geom_histogram(binwidth = 0.5) set.seed(15) #Simulation t.sample &lt;- rt(n = 10000, df = 5) #Skewness and Kurtosis library(moments) skewness(t.sample) ## [1] 0.06196269 kurtosis(t.sample) ## [1] 7.646659 ggplot(data.frame(x = t.sample),aes(x)) + geom_histogram(binwidth = 0.5) Example Let us count the number of samples greater than 5 from the samples of the normal and Student’s t distributions. Comment on your results eyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiIjIFdyaXRlIHlvdXIgY29kZSBoZXJlXG5zZXQuc2VlZCgxNSlcbm4uc2FtcGxlIDwtIHJub3JtKG4gPSAxMDAwMCwgbWVhbiA9IDAsIHNkID0gMSlcbnQuc2FtcGxlIDwtIHJ0KG4gPSAxMDAwMCwgZGYgPSA1KSJ9 Definition 1.12 The moment generating function (mgf) of a random variable \\(X\\) is defined to be \\[M_X(t) = E[e^{tX}],\\] if the expectation exists. Note The moment generating function of \\(X\\) may not defined (may not be finite) for all \\(t\\) in \\(\\mathbb{R}\\). If \\(M_X(t)\\) is finite for \\(|t| &lt; h\\) for some \\(h &gt; 0\\), then, for any \\(k = 1, 2, \\ldots,\\) the function \\(M_X(t)\\) is k-times differentiable at \\(t = 0\\), with \\[M^{(k)}_X (0) = \\mathrm{E}[X^k],\\] with \\(\\mathrm{E}[|X|^k]\\) finite. We can obtain the moments by succesive differentiation of \\(M_X(t)\\) and letting \\(t = 0\\). Example 1.1 Derive the formula for the mgf of the standard normal distribution. Hint: its mgf is \\(e^{\\frac{1}{2} t^2}\\). 1.5 Probability generating function Definition 1.13 For a counting variable \\(N\\) (a variable which assumes some or all of the values \\(0, 1, 2, \\ldots,\\) but no others), The probability generating function of \\(N\\) is \\[G_N(t) = E[t^N],\\] for those \\(t\\) in \\(\\mathbb{R}\\) for which the series converges absolutely. Let \\(p_k = P(N = k)\\). Then \\[G_N(t) = E[t^N] = \\sum_{k=0}^\\infty t^k p_k.\\] It can be shown that if \\(E[N] &lt; \\infty\\) then \\[\\mathrm{E}[N] = G&#39;_N(1),\\] and if \\(E[N^2] &lt; \\infty\\) then \\[\\mathrm{Var}[N] = G&#39;&#39;_N(1) + G&#39;_N(1) - (G&#39;_N(1))^2.\\] Moreover, when both pgf and mgf of \\(N\\) are defined, we have \\[G_N(t) = M_N(\\log(t)) \\quad \\text{ and } M_N(t) = G_N(e^t).\\] 1.6 Multivariate Distributions When \\(X_1,X_2,\\ldots ,X_n\\) be random variables defined on the same sample space, a multivariate probability density function or probability mass function \\(f(x_1, x_2, \\ldots x_n)\\) can be defined. The following definitions can be extended to more than two random variables and the case of discrete random variables. Definition 1.14 Two random variables \\(X\\) and \\(Y\\), defined on the same sample space, have a continuous joint distribution if there exists a nonnegative function of two variables, \\(f(x, y)\\) on \\(\\mathbb{R} \\times \\mathbb{R}\\) , such that for any region \\(R\\) in the \\(xy\\)-plane that can be formed from rectangles by a countable number of set operations, \\[P((X, Y) \\in R) = \\iint_R f(x,y) \\, dx\\, dy\\] The function \\(f (x, y)\\) is called the joint probability density function of \\(X\\) and \\(Y\\). Let \\(X\\) and \\(Y\\) have joint probability density function \\(f (x, y)\\). Let \\(f_Y\\) be the probability density function of \\(Y\\) . To find \\(f_Y\\) in terms of \\(f\\) , note that, on the one hand, for any subset \\(B\\) of \\(R\\), \\[P(Y \\in B) = \\int_B f_Y(y) \\, dy,\\] and on the other hand, we also have \\[P(Y \\in B) = P(X \\in (-\\infty, \\infty), Y \\in B) = \\int_B \\left( \\int_{-\\infty}^\\infty f(x,y)\\, dx \\right) \\, dy.\\] We have \\[\\begin{equation} \\tag{1.1} f_Y(y) = \\int_{-\\infty}^\\infty f(x,y)\\, dx \\end{equation}\\] and \\[\\begin{equation} \\tag{1.2} f_X(x) = \\int_{-\\infty}^\\infty f(x,y)\\, dy \\end{equation}\\] Definition 1.15 Let \\(X\\) and \\(Y\\) have joint probability density function \\(f (x, y)\\); then the functions \\(f_X\\) and \\(f_Y\\) in (1.1) and (1.2) are called, respectively, the marginal probability density functions of \\(X\\) and \\(Y\\) . Let \\(X\\) and \\(Y\\) be two random variables (discrete, continuous, or mixed). The joint probability distribution function, or joint cumulative probability distribution function, or simply the joint distribution of \\(X\\) and \\(Y\\), is defined by \\[F(t, u) = P(X \\le t, Y \\le u)\\] for all \\(t, u \\in (-\\infty, \\infty)\\). The marginal probability distribution function of \\(X\\), \\(F_X\\), can be found from \\(F\\) as follows: \\[F_X(t) = \\lim_{n \\rightarrow \\infty} F(t,u) = F(t, \\infty)\\] and \\[F_Y(u) = \\lim_{n \\rightarrow \\infty}F(t,u) = F( \\infty, u)\\] The following relationship between \\(f(x,y)\\) and \\(F(t,u)\\) is as follows: \\[F(t,u) = \\int_{-\\infty}^{u}\\int_{-\\infty}^{t} f(x,y)\\, dx\\, dy.\\] We also have \\[\\mathrm{E}(X) = \\int_{-\\infty}^\\infty x f_X(x)\\, dx , \\quad \\mathrm{E}(Y) = \\int_{-\\infty}^\\infty y f_Y(y)\\, dy\\] Theorem 1.4 Let \\(f (x, y)\\) be the joint probability density function of random variables \\(X\\) and \\(Y\\). If \\(h\\) is a function of two variables from \\(\\mathbb{R}^2\\) to \\(\\mathbb{R}\\), then \\(h(X, Y )\\) is a random variable with the expected value given by \\[\\mathrm{E}[h(X,Y)] = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} h(x,y) \\, f(x,y)\\, dx\\, dy\\] provided that the integral is absolutely convergent. As a consequence of the above theorem, for random variables \\(X\\) and \\(Y\\), \\[\\mathrm{E}(X + Y) = \\mathrm{E}(X) + \\mathrm{E}(Y)\\] 1.7 Independent random variables Definition 1.16 Two random variables \\(X\\) and \\(Y\\) are called independent if, for arbitrary subsets \\(A\\) and \\(B\\) of real numbers, the events \\(\\{X \\in A\\}\\) and \\(\\{Y \\in B\\}\\) are independent, that is, if \\[P(X \\in A, Y \\in B) = P(X \\in A) P(Y \\in B).\\] Theorem 1.5 Let \\(X\\) and \\(Y\\) be two random variables defined on the same sample space. If \\(F\\) is the joint probability distribution function of \\(X\\) and \\(Y\\), then \\(X\\) and \\(Y\\) are independent if and only if for all real numbers \\(t\\) and \\(u\\), \\[F(t,u) = F_X(t) F_Y(u).\\] Theorem 1.6 Let \\(X\\) and \\(Y\\) be jointly continuous random variables with joint probability density function \\(f (x, y)\\). Then \\(X\\) and \\(Y\\) are independent if and only if \\[f (x, y) = f_X(x) f_Y (y).\\] Theorem 1.7 Let \\(X\\) and \\(Y\\) be independent random variables and \\(g : \\mathbb{R} \\rightarrow\\mathbb{R}\\) and \\(h : \\mathbb{R} \\rightarrow\\mathbb{R}\\) be real-valued functions; then \\(g(X)\\) and \\(h(Y )\\) are also independent random variables. As a consequence of the above theorem, we obtain Theorem 1.8 Let \\(X\\) and \\(Y\\) be independent random variables. Then for all real-value functions \\(g : \\mathbb{R} \\rightarrow\\mathbb{R}\\) and \\(h : \\mathbb{R} \\rightarrow\\mathbb{R}\\), \\[\\mathrm{E}[g(X)h(Y)] = \\mathrm{E}[g(X)]\\mathrm{E}[h(Y)]\\] 1.8 Conditional Distributions Let \\(X\\) and \\(Y\\) be two continuous random variables with the joint probability density function \\(f (x, y)\\). Note that the case of discrete random variables can be considered in the same way. When no information is given about the value of \\(Y\\), the marginal probability density function of \\(X\\), \\(f_X(x)\\) is used to calculate the probabilities of events concerning \\(X\\). However, when the value of \\(Y\\) is known, to find such probabilities, \\(f_{X|Y} (x|y)\\), the conditional probability density function of \\(X\\) given that \\(Y = y\\) is used and is defined as follows: \\[f_{X|Y} (x|y) = \\frac{f(x,y)}{f_Y(y)}\\] provided that \\(f_Y (y) &gt; 0\\). Note also that the conditional probability density function of \\(X\\) given that \\(Y = y\\) is itseof a probability density function, i.e. \\[\\int_{-\\infty}^\\infty f_{X|Y}(x|y)\\, dx = 1.\\] Note that the conditional probability distribution function of \\(X\\) given that \\(Y = y\\), the conditional expectation of \\(X\\) given that \\(Y = y\\) can be as follows: \\[F_{Y|X}(x|y) = P(X \\le x | Y = y) = \\int_ {-\\infty}^x f_{X|Y}(t|y) \\, dt\\] and \\[\\mathrm{E}(X|Y = y) = \\int_{-\\infty}^{\\infty} x f_{X|Y}(x|y) \\, dx,\\] where \\(f_Y(y) &gt; 0\\). Note that if \\(X\\) and \\(Y\\) are independent, then \\(f_{X|Y}\\) coincides with \\(f_X\\) because \\[f_{X|Y}(x|y) = \\frac{f(x,y)}{f_Y(y)} =\\frac{f_X(x)f_Y(y)}{f_Y(y)} = f_X(x).\\] 1.9 Covariance The notion of the variance of a random variable \\(X\\), \\(\\mathrm{Var}(X) = \\mathrm{E}[ ( X - \\mathrm{E}(X))^2]\\) measures the average magnitude of the fluctuations of the random variable \\(X\\) from its expectation, \\(\\mathrm{E}(X)\\). This quantity measures the dispersion, or spread, of the distribution of \\(X\\) about its expectation. Now suppose that \\(X\\) and \\(Y\\) are two jointly distributed random variables. Covariance is a measure of how much two random variables vary together. Let us calculuate \\(\\mathrm{Var}(aX + bY)\\) the joint spread, or dispersion, of \\(X\\) and \\(Y\\) along the \\((ax + by)\\)-direction for arbitrary real numbers \\(a\\) and \\(b\\): \\[\\mathrm{Var}(aX + bY) = a^2 \\mathrm{Var}(X) + b^2 \\mathrm{Var}(Y) + 2 a b \\mathrm{E}[(X - \\mathrm{E}(X))(Y - \\mathrm{E}(Y))].\\] However, \\(\\mathrm{Var}(X)\\) and \\(\\mathrm{Var}(Y )\\) determine the dispersions of \\(X\\) and \\(Y\\) independently; therefore, \\(\\mathrm{E}[(X - \\mathrm{E}(X))(Y - \\mathrm{E}(Y))]\\) is the quantity that gives information about the joint spread, or dispersion, \\(X\\) and \\(Y\\) . Definition 1.17 Let \\(X\\) and \\(Y\\) be jointly distributed random variables; then the covariance of \\(X\\) and \\(Y\\) is defined by \\[\\mathrm{Cov}(X,Y) = \\mathrm{E}[(X - \\mathrm{E}(X))(Y - \\mathrm{E}(Y))].\\] Note that for random variables \\(X, Y\\) and \\(Z\\), and \\(ab &gt; 0\\), then the joint dispersion of \\(X\\) and \\(Y\\) along the \\((ax + by)\\)-direction is greater than the joint dispersion of \\(X\\) and \\(Z\\) along the \\((ax + bz)\\)-direction if and only if \\(\\mathrm{Cov}(X, Y) &gt; \\mathrm{Cov}(X,Z).\\) Note that \\[\\mathrm{Cov}(X, X) = \\mathrm{Var}(X).\\] Moreover, \\[\\mathrm{Cov}(X,Y) = \\mathrm{E}(XY) - \\mathrm{E}(X)\\mathrm{E}(Y).\\] Properties of covariance are as follows: for arbitrary real numbers \\(a, b, c, d\\) and random variables \\(X\\) and \\(Y\\), \\[\\mathrm{Var}(aX + bY) = a^2 \\mathrm{Var}(X) + b^2 \\mathrm{Var}(Y) + 2 a b \\mathrm{Cov}(X,Y).\\] \\[\\mathrm{Cov}(aX + b, cY + d) = acCov(X, Y)\\] For random variables \\(X_1, X_2, . . . , X_n\\) and \\(Y_1, Y_2, . . . , Y_m\\), \\[\\mathrm{Cov}(\\sum_{i=1}^n a_i X_i, \\sum_{j=1}^m b_j Y_j) = \\sum_{i=1}^n\\sum_{j=1}^m a_i\\,b_j\\, \\mathrm{Cov}(X_i,Y_j).\\] If \\(\\mathrm{Cov}(X, Y) &gt; 0\\), we say that \\(X\\) and \\(Y\\) are positively correlated. If \\(\\mathrm{Cov}(X, Y) &lt; 0\\), we say that they are negatively correlated. If \\(\\mathrm{Cov}(X, Y) = 0\\), we say that \\(X\\) and \\(Y\\) are uncorrelated. If \\(X\\) and \\(Y\\) are independent, then \\[\\mathrm{Cov}(X,Y) = 0.\\] However, the converse of this is not true; that is, two dependent random variables might be uncorrelated. 1.10 Correlation A large covariance can mean a strong relationship between variables. However, we cannot compare variances over data sets with different scales. A weak covariance in one data set may be a strong one in a different data set with different scales. The problem can be fixed by dividing the covariance by the standard deviation to get the correlation coefficient. Definition 1.18 Let \\(X\\) and \\(Y\\) be two random variables with \\(0&lt; \\sigma^2_X, \\sigma^2_Y &lt; \\infty\\). The covariance between the standardized \\(X\\) and the standardized \\(Y\\) is called the correlation coefficient between \\(X\\) and \\(Y\\) and is denoted \\(\\rho = \\rho(X,Y)\\), \\[\\rho(X,Y) = \\frac{\\mathrm{Cov}(X,Y)}{\\sigma_X \\sigma_Y}.\\] Note that \\(\\rho(X, Y ) &gt; 0\\) if and only if \\(X\\) and \\(Y\\) are positively correlated; \\(\\rho(X, Y ) &lt; 0\\) if and only if \\(X\\) and \\(Y\\) are negatively correlated; and \\(\\rho(X, Y ) = 0\\) if and only if \\(X\\) and \\(Y\\) are uncorrelated. \\(\\rho(X, Y )\\) roughly measures the amount and the sign of linear relationship between \\(X\\) and \\(Y\\). In the case of perfect linear relationship, we have \\(\\rho(X, Y ) = \\pm1\\). A correlation of 0, i.e. \\(\\rho(X, Y ) = 0\\) does not mean zero relationship between two variables; rather, it means zero linear relationship. Some importants properties of correlation are \\[-1 \\le \\rho(X, Y ) \\le 1\\] \\[\\rho(a X + b, cY +d) = \\text{sign}(ac) \\rho(X, Y )\\] 1.11 Model Fitting The contents in this section are taken from Gray and Pitts. To fit a parametric model, we have to calculate estimates of the unknown parameters of the probability distribution. Various criteria are available, including the method of moments, the method of maximum likelihood, etc. 1.12 The method of moments The method of moments leads to parameter estimates by simply matching the moments of the model, \\(\\mathrm{E}[X], \\mathrm{E}[X^2], \\mathrm{E}[X^3], \\ldots ,\\) in turn to the required number of corresponding sample moments calculated from the data \\(x_1, x_2, \\ldots , x_n\\), where \\(n\\) is the number of observations available. The sample moments are simply \\[\\frac{1}{n}\\sum_{i=1}^n x_i, \\quad \\frac{1}{n}\\sum_{i=1}^n x^2_i, \\quad \\frac{1}{n}\\sum_{i=1}^n x^3_i, \\ldots.\\] It is often more convenient to match the mean and central moments, in particular matching \\(\\mathrm{E}[X]\\) to the sample mean \\(\\bar{x}\\) and \\(\\mathrm{Var}[X]\\) to the sample variance \\[s^2 = \\frac{1}{n-1}\\sum_{i=1}^n (x_i - \\bar{x})^2.\\] An estimate produced using the method of moments is called an MME, and the MME of a parameter \\(\\theta\\), say, is usually denoted \\(\\tilde{\\theta}\\). 1.13 The method of maximum likelihood The method of maximum likelihood is the most widely used method for parameter estimation. The estimates it produces are those values of the parameters which give the maximum value attainable by the likelihood function, denoted \\(L\\), which is the joint probability mass or density function for the data we have (under the chosen parametric distribution), regarded as a function of the unknown parameters. In practice, it is often easier to maximise the loglikelihood function, which is the logarithm of the likelihood function, rather than the likelihood itself. An estimate produced using the method of maximum likelihood is called an MLE, and the MLE of a parameter \\(\\theta\\), say, is denoted \\(\\hat{\\theta}\\). MLEs have many desirable theoretical properties, especially in the case of large samples. In some simple cases we can derive MLE(s) analytically as explicit functions of summaries of the data. Thus, suppose our data consist of a random sample \\(x_1, x_2, \\ldots , x_n\\), from a parametric distribution whose parameter(s) we want to estimate. Some straightforward cases include the following: the MLE of \\(\\lambda\\) for a \\(Poi(\\lambda)\\) distribution is the sample mean, that is \\(\\hat{\\lambda} = \\bar{x}\\) the MLE of \\(\\lambda\\) for an \\(Exp(\\lambda)\\) distribution is the reciprocal of the sample mean, that is \\(\\hat{\\lambda} = 1/\\bar{x}\\) 1.14 Goodness of fit tests We can assess how well the fitted distributions reflect the distribution of the data in various ways. We should, of course, examine and compare the tables of frequencies and, if appropriate, plot and compare empirical distribution functions. More formally, we can perform certain statistical tests. Here we will use the Pearson chi-square goodness-of-fit criterion. 1.15 the Pearson chi-square goodness-of-fit criterion We construct the test statistic \\[\\chi^2 = \\frac{\\sum(O - E)^2}{E},\\] where \\(O\\) is the observed frequency in a cell in the frequency table and \\(E\\) is the fitted or expected frequency (the frequency expected in that cell under the fitted model), and where we sum over all usable cells. The null hypothesis is that the sample comes from a specified distribution. The value of the test statistic is then evaluated in one of two ways. We convert it to a \\(P\\)-value, which is a measure of the strength of the evidence against the hypothesis that the data do follow the fitted distribution. If the \\(P\\)-value is small enough, we conclude that the data do not follow the fitted distribution – we say “the fitted distribution does not provide a good fit to the data” (and quote the \\(P\\)-value in support of this conclusion). We compare it with values in published tables of the distribution function of the appropriate \\(\\chi^2\\) distribution, and if the value of the statistic is high enough to be in a tail of specified size of this reference distribution, we conclude that the fitted distribution does not provide a good fit to the data. 1.16 Kolmogorov-Smirnov (K-S) test. The K-S test statistic is the maximum difference between the values of the ecdf of the sample and the cdf of the fully specified fitted distribution. The course does not emphasis on the Goodness of Fit Test. Please refer to the reference text for more details. "],["loss-distributions.html", "Chapter 2 Loss distributions 2.1 Introduction 2.2 Loss Distributions 2.3 Exponential Distribution 2.4 Gamma distribution 2.5 Lognormal distribution 2.6 Pareto distribution", " Chapter 2 Loss distributions 2.1 Introduction The main objective of the course is to provide methods for analysing insurance data leading to decisions with an emphasis in an insurance context. 2.1.1 The importance of insurance or the benefits of insurance for society Let us begin with the importance of insurance or the benefits of insurance for society. The insurer protects the wealth of society through a variety of insurance plans. Life insurance provides protection against loss of human wealth. General insurance protects property from damage by fire, theft, accidents, earthquakes, etc. Consequently, both general insurance and life insurance provide security to maintain financial and business conditions. The insurance policy is a contract between the insurer and the policyholder, which sets out the claims that the insurer is legally obliged to pay. The insurer guarantees compensation for losses caused by risks covered by the insurance policy, called the insurance claim in return for an initial payment, called the premium. 2.1.2 The types of insurance Families and organisations that do not want to bear their own risks can choose from a variety of insurance policies.The following questions can be asked about an insurance policy (Click here for more details): the nature of insurance is who buys it: Is it a personal, group or commercial? the nature of insurance is the type of risk being covered: Is it a life/health insurance policy or a property/casualty policy? the nature of insurance is by the duration of an insurance contract, known as the term: Is it a short-term or a long-term contract? Is it issued by a private insurer or a government agency? Was it taken out voluntarily or involuntarily? Notes The amount of benefits provided by life insurance policies is often specified in the policies. In contrast, most non-life insurance policies provide compensation for insured losses that were not known prior to the event (usually the compensation amounts are limited). The time value of money is important in a life insurance contract that runs over a long period of time. In a non-life contract, the random amount of compensation takes priority. 2.1.3 Insurance Operations and Data Analytics The ultimate goal is to use insurance data as a basis for decision-making. Throughout the course, we will learn more about techniques for analysing and extrapolating data. To begin with, we will describe five key operational areas of insurance companies and highlight the role of data and analytics in each operational area. Initiate insurance: The company decides at this stage whether or not to accept a risk (the underwriting step) and then determines the appropriate premium (or rate). The basics of insurance analysis are found in ratemaking, where analysts try to find the appropriate price for the appropriate risk. Renewal of insurance: Many policies, especially in general insurance, are only valid for a few months or a year. The insurer has the option of refusing cover and changing the premium, even though it assumes that such contracts would be renewed. The purpose of this phase of policy renewal, where analytics are also used, is to retain profitable customers. Claims management: Analytics have been used for years to (1) identify claims. and prevent claims fraud, (2) control claims costs, including identifying the right type of support to cover the costs associated with claims handling, and (3) capture additional layers for reinsurance and retention. Reserves for losses: Management obtains an accurate estimate of future responsibilities using analytical techniques, and the uncertainty of these predictions is quantified. Capital allocation and solvency: Among the important analytical operations is the choice of the amount of capital required and its allocation to the various investments. Companies need to be aware of their capital requirements in order to have sufficient cash flow to meet their obligations when they are likely to occur (solvency). This is an important concern not only for management, but also for clients, shareholders, regulators and the public. 2.2 Loss Distributions The aim of the course is to provide a fundamental basis which applies mainly in general insurance. General insurance companies’ products are short-term policies that can be purchased for a short period of time. Examples of insurance products are motor insurance; home insurance; health insurance; and travel insurance. In case of an occurrence of an insured event, two important components of financial losses which are of importance for management of an insurance company are the number of claims; and the amounts of those claims. Mathematical and statistical techniques used to model these sources of uncertainty will be discussed. This will enable insurance companies to calculate premium rates to charge policy holders; and decide how much reserve should be set aside for the future payment of incurred claims. In the chapter, statistical distributions and their properties which are suitable for modelling claim sizes are reviewed. These distribution are also known as loss distributions. In practice, the shape of loss distributions are positive skew with a long right tail. The main features of loss distributions include: having a few small claims; rising to a peak; tailing off gradually with a few very large claims. 2.3 Exponential Distribution A random variable \\(X\\) has an exponential distribution with a parameter \\(\\lambda &gt; 0\\), denoted by \\(X \\sim \\text{Exp}(\\lambda)\\) if its probability density function is given by \\[f_X(x) = \\lambda e^{-\\lambda x}, \\quad x &gt; 0.\\] Example 2.1 Let \\(X \\sim \\text{Exp}(\\lambda)\\) and \\(0 &lt; a &lt; b\\). Find the distribution \\(F_X(x)\\). Express \\(P(a &lt; X &lt; B)\\) in terms of \\(f_X(x)\\) and \\(F_X(x)\\). Show that the moment generating function of \\(X\\) is \\[M_X(t) = \\left(1 - \\frac{t}{\\lambda}\\right)^{-1}, \\quad t &lt; \\lambda.\\] Derive the \\(r\\)-th moment about the origin \\(\\mathrm{E}[X^r].\\) Derive the coefficient of skewness for \\(X\\). Simulate a random sample of size n = 200 from \\(X \\sim \\text{Exp}(0.5)\\) using the command sample = rexp(n, rate = lambda) where \\(n\\) and \\(\\lambda\\) are the chosen parameter values. Plot a histogram of the random sample using the command hist(sample) (use help for available options for hist function in R). Solution: The code for questions 6 and 7 is given below. The histogram can be generated from the code below. # set.seed is used so that random number generated from different simulations are the same. # The number 5353 can be set arbitrarily. set.seed(5353) nsample &lt;- 200 data_exp &lt;- rexp(nsample, rate = 0.5) dataset &lt;- data_exp hist(dataset, breaks=100,probability = TRUE, xlab = &quot;claim sizes&quot; , ylab = &quot;density&quot;, main = paste(&quot;Histogram of claim sizes&quot; )) hist(dataset, breaks=100, xlab = &quot;claim sizes&quot; , ylab = &quot;count&quot;, main = paste(&quot;Histogram of claim sizes&quot; )) Copy and paste the code above and run it. eyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiJzZXQuc2VlZCg1MzUzKVxuXG5uc2FtcGxlIDwtIDIwMFxuZGF0YV9leHAgPC0gcmV4cChuc2FtcGxlLCByYXRlID0gMC41KVxuXG5kYXRhc2V0IDwtIGRhdGFfZXhwXG5oaXN0KGRhdGFzZXQsIGJyZWFrcz0xMDAscHJvYmFiaWxpdHkgPSBUUlVFLCB4bGFiID0gXCJjbGFpbSBzaXplc1wiIFxuICAgICAsIHlsYWIgPSBcImRlbnNpdHlcIiwgbWFpbiA9IHBhc3RlKFwiSGlzdG9ncmFtIG9mIGNsYWltIHNpemVzXCIgKSkifQ== eyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiJzZXQuc2VlZCg1MzUzKVxuXG5uc2FtcGxlIDwtIDIwMFxuZGF0YV9leHAgPC0gcmV4cChuc2FtcGxlLCByYXRlID0gMC41KVxuXG5kYXRhc2V0IDwtIGRhdGFfZXhwXG5cblxuaGlzdChkYXRhc2V0LCBicmVha3M9MTAwLCB4bGFiID0gXCJjbGFpbSBzaXplc1wiIFxuICAgICAsIHlsYWIgPSBcImNvdW50XCIsIG1haW4gPSBwYXN0ZShcIkhpc3RvZ3JhbSBvZiBjbGFpbSBzaXplc1wiICkpIn0= Notes The exponential distribution can used to model the inter-arrival time of an event. The exponential distribution has an important property called lack of memory: if \\(X \\sim \\text{Exp}(\\lambda)\\), then the random variable \\(X-w\\) conditional on \\(X &gt; w\\) has the same distribution as \\(X\\), i.e. \\[X \\sim \\text{Exp}(\\lambda)\\Rightarrow X - w | X &gt; w \\sim \\text{Exp}(\\lambda).\\] We can use R to plot the probability density functions (pdf) of exponential distributions with various parameters \\(\\lambda\\), which are shown in Figure 2.1. Here we use scale_colour_manual to override defaults with scales package (see cheat sheet for details). library(ggplot2) ggplot(data.frame(x=c(0,10)), aes(x=x)) + labs(y=&quot;Probability density&quot;, x = &quot;x&quot;) + ggtitle(&quot;Exponential distributions&quot;) + theme(plot.title = element_text(hjust = 0.5)) + stat_function(fun=dexp,geom =&quot;line&quot;, args = (mean=0.5), aes(colour = &quot;0.5&quot;)) + stat_function(fun=dexp,geom =&quot;line&quot;, args = (mean=1), aes(colour = &quot;1&quot;)) + stat_function(fun=dexp,geom =&quot;line&quot;, args = (mean=1.5), aes(colour = &quot;1.5&quot;)) + stat_function(fun=dexp,geom =&quot;line&quot;, args = (mean=2), aes(colour = &quot;2&quot;)) + scale_colour_manual(expression(paste(lambda, &quot; = &quot;)), values = c(&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;, &quot;orange&quot;)) Figure 2.1: The probability density functions (pdf) of exponential distributions with various parameters lambda. 2.4 Gamma distribution A random variable \\(X\\) has a gamma distribution with parameters \\(\\alpha &gt; 0\\) and \\(\\lambda &gt; 0\\), denoted by \\(X \\sim \\mathcal{G}(\\alpha, \\lambda)\\) or \\(X \\sim \\text{gamma}(\\alpha, \\lambda)\\) if its probability density function is given by \\[f_X(x) = \\frac{\\lambda^\\alpha}{\\Gamma(\\alpha)} x^{\\alpha -1} e^{-\\lambda x}, \\quad x &gt; 0.\\] The symbol \\(\\Gamma\\) denotes the gamma function, which is defined as \\[\\Gamma(\\alpha) = \\int_{0}^\\infty x^{\\alpha - 1} e^{-x} \\mathop{}\\!dx, \\quad \\text{for } \\alpha &gt; 0.\\] It follows that \\(\\Gamma(\\alpha + 1) = \\alpha \\Gamma(\\alpha)\\) and that for a positive integer \\(n\\), \\(\\Gamma(n) = (n-1)!\\). The properties of the gamma distribution are summarised. The mean and variance of \\(X\\) are \\[\\mathrm{E}[X] = \\frac{\\alpha}{\\lambda} \\text{ and } \\mathrm{Var}[X] =\\frac{\\alpha}{\\lambda^2}\\] The \\(r\\)-th moment about the origin is \\[\\mathrm{E}[X^r] = \\frac{1}{\\lambda^r} \\frac{\\Gamma(\\alpha + r)}{\\Gamma(\\alpha )}, \\quad r &gt; 0.\\] The moment generating function (mgf) of \\(X\\) is \\[M_X(t) = \\left(1 - \\frac{t}{\\lambda}\\right)^{-\\alpha}, \\quad t &lt; \\lambda.\\] The coefficient of skewness is \\[\\frac{2}{\\sqrt{\\alpha}}.\\] Notes 1. The exponential function is a special case of the gamma distribution, i.e. \\(\\text{Exp}(\\lambda)= \\mathcal{G}(1,\\lambda)\\) If \\(\\alpha\\) is a positive integer, the sum of \\(\\alpha\\) independent, identically distributed as \\(\\text{Exp}(\\lambda)\\), is \\(\\mathcal{G}(\\alpha, \\lambda)\\). If \\(X_1, X_2, \\ldots, X_n\\) are independent, identically distributed, each with a \\(\\mathcal{G}(\\alpha, \\lambda)\\) distribution, then \\[\\sum_{i = 1}^n X_i \\sim \\mathcal{G}(n\\alpha, \\lambda).\\] The exponential and gamma distributions are not fat-tailed, and may not provide a good fit to claim amounts. Example 2.2 Using the moment generating function of a gamma distribution, show that the sum of independent gamma random variables with the same scale parameter \\(\\lambda\\), \\(X \\sim \\mathcal{G}(\\alpha_1, \\lambda)\\) and \\(Y \\sim \\mathcal{G}(\\alpha_2, \\lambda)\\), is \\(S = X+ Y \\sim \\mathcal{G}(\\alpha_1 + \\alpha_2, \\lambda).\\) Solution: Because \\(X\\) and \\(Y\\) are independent, \\[\\begin{aligned} M_S(t) &amp;= M_{X+Y}(t) = M_X(t) \\cdot M_Y(t)\\\\ &amp;= (1 - \\frac{t}{\\lambda})^{-\\alpha_1} \\cdot (1 - \\frac{t}{\\lambda})^{-\\alpha_2} \\\\ &amp;= (1 - \\frac{t}{\\lambda})^{-(\\alpha_1 + \\alpha_2)}. \\end{aligned}\\] Hence \\(S = X + Y \\sim \\mathcal{G}(\\alpha_1 + \\alpha_2, \\lambda).\\) The probability density functions (pdf) of gamma distributions with various shape parameters \\(\\alpha\\) and rate parameter \\(\\lambda\\) = 1 are shown in Figure 2.2. ggplot(data.frame(x=c(0,20)), aes(x=x)) + labs(y=&quot;Probability density&quot;, x = &quot;x&quot;) + ggtitle(&quot;Gamma distribution&quot;) + theme(plot.title = element_text(hjust = 0.5)) + stat_function(fun=dgamma, args=list(shape=2, rate=1), aes(colour = &quot;2&quot;)) + stat_function(fun=dgamma, args=list(shape=6, rate=1) , aes(colour = &quot;6&quot;)) + scale_colour_manual(expression(paste(lambda, &quot; = 1 and &quot;, alpha ,&quot; = &quot;)), values = c(&quot;red&quot;, &quot;blue&quot;)) Figure 2.2: The probability density functions (pdf) of gamma distributions with various shape alpha and rate parameter lambda = 1. 2.5 Lognormal distribution A random variable \\(X\\) has a lognormal distribution with parameters \\(\\mu\\) and \\(\\sigma^2\\), denoted by \\(X \\sim \\mathcal{LN}(\\mu, \\sigma^2)\\) if its probability density function is given by \\[f_X(x) = \\frac{1}{\\sigma x \\sqrt{2 \\pi}} \\exp\\left(-\\frac{1}{2} \\left( \\frac{\\log(x) - \\mu}{\\sigma} \\right)^2 \\right) , \\quad x &gt; 0.\\] The following relation holds: \\[X \\sim \\mathcal{LN}(\\mu, \\sigma^2)\\Leftrightarrow Y = \\log X \\sim \\mathcal{N}(\\mu, \\sigma^2).\\] The properties of the lognormal distribution are summarised. The mean and variance of \\(X\\) are \\[\\mathrm{E}[X] = \\exp\\left(\\mu + \\frac{1}{2} \\sigma^2 \\right) \\text{ and } \\mathrm{Var}[X] =\\exp\\left(2\\mu + \\sigma^2 \\right) (\\exp(\\sigma^2) - 1).\\] The \\(r\\)-th moment about the origin is \\[\\mathrm{E}[X^r] =\\exp\\left(r\\mu + \\frac{1}{2}r^2 \\sigma^2 \\right).\\] The moment generating function (mgf) of \\(X\\) is not finite for any positive value of \\(t\\). The coefficient of skewness is \\[(\\exp(\\sigma^2) + 2) \\left(\\exp(\\sigma^2) -1 \\right)^{1/2} .\\] The probability density functions (pdf) of gamma distributions with various shape parameters \\(\\alpha\\) and rate parameter \\(\\lambda = 1\\) is shown in Figure 2.3. ggplot(data.frame(x=c(0,10)), aes(x=x)) + labs(y=&quot;Probability density&quot;, x = &quot;x&quot;) + ggtitle(&quot;lognormal distribution&quot;) + theme(plot.title = element_text(hjust = 0.5)) + stat_function(fun=dlnorm, args = list(meanlog = 0, sdlog = 0.25), aes(colour = &quot;0.25&quot;)) + stat_function(fun=dlnorm, args = list(meanlog = 0, sdlog = 1), aes(colour = &quot;1&quot;)) + scale_colour_manual(expression(paste(mu, &quot; = 0 and &quot;, sigma, &quot;= &quot;)), values = c(&quot;red&quot;, &quot;blue&quot;)) Figure 2.3: The probability density functions (pdf) of lognormal distributions with mu = 0 and sigma = 0.25 or 1. 2.6 Pareto distribution A random variable \\(X\\) has a Pareto distribution with parameters \\(\\alpha &gt; 0\\) and \\(\\lambda &gt; 0\\), denoted by \\(X \\sim \\text{Pa}(\\alpha, \\lambda)\\) if its probability density function is given by \\[f_X(x) = \\frac{\\alpha \\lambda^\\alpha}{(\\lambda + x)^{\\alpha + 1}}, \\quad x &gt; 0.\\] The distribution function is given by \\[F_X(x) = 1 - \\left( \\frac{\\lambda}{\\lambda + \\alpha} \\right)^\\alpha, \\quad x &gt; 0.\\] The properties of the Pareto distribution are summarized. The mean and variance of \\(X\\) are \\[\\mathrm{E}[X] = \\frac{\\lambda}{\\alpha - 1}, \\alpha &gt; 1 \\text{ and } \\mathrm{Var}[X] = \\frac{\\alpha \\lambda^2}{(\\alpha - 1)^2(\\alpha - 2)}, \\alpha &gt; 2.\\] The \\(r\\)-th moment about the origin is \\[\\mathrm{E}[X^r] =\\frac{\\Gamma(\\alpha-r) \\Gamma(1+ r)}{\\Gamma(\\alpha)} \\lambda^r, \\quad 0 &lt; r &lt; \\alpha.\\] The moment generating function (mgf) of \\(X\\) is not finite for any positive value of \\(t\\). The coefficient of skewness is \\[\\frac{2(\\alpha + 1)}{\\alpha - 3} \\sqrt{\\frac{\\alpha-2}{\\alpha}} , \\quad \\alpha &gt; 3.\\] Note 1. The following conditional tail property for a Pareto distribution is useful for reinsurance calculation. Let \\(X \\sim \\text{Pa}(\\alpha, \\lambda)\\). Then the random variable \\(X - w\\) conditional on \\(X &gt; w\\) has a Pareto distribution with parameters \\(\\alpha\\) and \\(\\lambda + w\\), i.e. \\[X \\sim \\text{Pa}(\\alpha, \\lambda)\\Rightarrow X - w | X &gt; w \\sim \\text{Pa}(\\alpha,\\lambda + w).\\] The lognormal and Pareto distributions, in practice, provide a better fit to claim amounts than exponential and gamma distributions. Other loss distribution are useful in practice including Burr, Weibull and loggamma distributions. library(actuar) ggplot(data.frame(x=c(0,60)), aes(x=x)) + labs(y=&quot;Probability density&quot;, x = &quot;x&quot;) + ggtitle(&quot;Pareto distribution&quot;) + theme(plot.title = element_text(hjust = 0.5)) + stat_function(fun=dpareto, args=list(shape=3, scale=20), aes(colour = &quot;alpha = 3, lambda = 20&quot;)) + stat_function(fun=dpareto, args=list(shape=6, scale=50), aes(colour = &quot;alpha = 6, lambda = 50&quot;)) + scale_colour_manual(&quot;Parameters&quot;, values = c(&quot;red&quot;, &quot;blue&quot;), labels = c(expression(paste(alpha, &quot; = 3 and &quot;, lambda, &quot;= 20&quot;)), expression(paste(alpha, &quot; = 6 and &quot;, lambda, &quot;= 50&quot;)))) Figure 2.4: The probability density functions (pdf) of Pareto distributions with various shape alpha and rate parameter lambda = 1. Example 2.3 Consider a data set consisting of 200 claim amounts in one year from a general insurance portfolio. Calculate the sample mean and sample standard deviation. Use the method of moments to fit these data with both exponential and gamma distributions. Calculate the boundaries for groups or bins so that the expected number of claims in each bin is 20 under the fitted exponential distribution. Count the values of the observed claim amounts in each bin. With these bin boundaries, find the expected number of claims when the data are fitted with the gamma, lognormal and Pareto distributions. Plot a histogram for the data set along with fitted exponential distribution and fitted gamma distribution. In addition, plot another histogram for the data set along with fitted lognormal and fitted Pareto distribution. Comment on the goodness of fit of the fitted distributions. Solution: 1. Given that \\(\\sum_{i=1}^n x_i = 206046.4\\) and \\(\\sum_{i=1}^n x_i^2 = 1,472,400,135\\), we have \\[\\bar{x} = \\frac{\\sum_{i=1}^n x_i}{n} = \\frac{206046.4}{200} = 1030.232.\\] The sample variance and standard deviation are \\[s^2 = \\frac{1}{n-1} \\left( \\sum_{i=1}^n x_i^2 - \\frac{(\\sum_{i=1}^n x_i)^2}{n} \\right) = 6332284,\\] and \\[s = 2516.403.\\] We calculate estimates of unknown parameters of both exponential and gamma distributions by the method of moments. We simply match the mean and central moments, i.e. matching \\(\\mathrm{E}[X]\\) to the sample mean \\(\\bar{x}\\) and \\(\\mathrm{Var}[X]\\) to the sample variance. The MME (moment matching estimation) of the required distributions are as follows: the MME of \\(\\lambda\\) for an \\(\\text{Exp}(\\lambda)\\) distribution is the reciprocal of the sample mean, \\[\\tilde{\\lambda} = \\frac{1}{\\bar{x}} = 0.000971.\\] the MMEs of \\(\\alpha\\) and \\(\\lambda\\) for a \\(\\mathcal{G}(\\alpha, \\lambda)\\) distribution are \\[\\begin{aligned} \\tilde{\\alpha} &amp;= \\left(\\frac{\\bar{x}}{s}\\right)^2 = 0.167614, \\\\ \\tilde{\\lambda} &amp;= \\frac{\\tilde{\\alpha}}{\\bar{x}} = 0.000163.\\end{aligned}\\] the MMEs of \\(\\mu\\) and \\(\\sigma\\) for a \\(\\mathcal{LN}(\\mu, \\sigma^2)\\) distribution are \\[\\begin{aligned} \\tilde{\\sigma} &amp;= \\sqrt{ \\ln \\left( \\frac{s^2}{\\bar{x}^2} + 1 \\right) } = 1.393218, \\\\ \\tilde{\\mu} &amp;= \\ln(\\bar{x}) - \\frac{\\tilde{\\sigma}^2 }{2} = 5.967012.\\end{aligned}\\] the MMEs of \\(\\alpha\\) and \\(\\lambda\\) for a \\(\\text{Pa}(\\alpha, \\lambda)\\) distribution are \\[\\begin{aligned} \\tilde{\\alpha} &amp;= \\displaystyle{ 2 \\left( \\frac{s^2}{\\bar{x}^2} \\right) \\frac{1}{(\\frac{s^2}{\\bar{x}^2} - 1)} } = 2.402731,\\\\ \\tilde{\\lambda} &amp;= \\bar{x} (\\tilde{\\alpha} - 1) = 1445.138.\\end{aligned}\\] The upper boundaries for the 10 groups or bins so that the expected number of claims in each bin is 20 under the fitted exponential distribution are determined by \\[\\Pr(X \\le \\text{upbd}_j) = \\frac{j}{10}, \\quad j = 1,2,3, \\ldots, 9.\\] With \\(\\tilde{\\lambda}\\) from the MME for an \\(\\text{Exp}(\\lambda)\\) from the previous, \\[\\Pr(X \\le x) = 1 - \\exp(-\\tilde{\\lambda} x).\\] We obtain \\[\\text{upbd}_j = -\\frac{1}{\\tilde{\\lambda}} \\ln\\left( 1 - \\frac{j}{10}\\right).\\] The results are given in Table 2.1. The following table shows frequency distributions for observed and fitted claims sizes for exponential, gamma, and also lognormal and Pareto fits. Table 2.1: Frequency distributions for observed and fitted claims sizes. Range Observation Exp Gamma Lognormal Pareto (0,109] 60 20 109.4 36 31.9 (109,230] 31 20 14.3 34.4 27.8 (230,367] 25 20 9.7 26 24.2 (367,526] 17 20 7.8 20.5 21.2 (526,714] 14 20 6.8 16.6 18.6 (714,944] 13 20 6.3 13.9 16.4 (944,1240] 6 20 6.2 11.9 14.6 (1240,1658] 7 20 6.5 10.8 13.2 (1658,2372] 10 20 7.7 10.4 12.5 (2372,\\(\\infty\\)) 17 20 25.4 19.5 19.4 Let \\(X\\) be the claim size. The expected number of claims for the fitted exponential distribution in the range \\((a,b]\\) is \\[200 \\cdot \\Pr( a &lt; X \\le b) = 200( e^{-\\tilde{\\lambda} a} - e^{-\\tilde{\\lambda} b} ).\\] In our case, the expected frequencies under the fitted exponential distribution are given in the third column of Table 2.1. (Excel) The expected number of claims for the fitted gamma distribution in the range \\((a,b]\\) is \\[200 \\cdot\\left( \\text{GAMMADIST}\\left(b, \\tilde{\\alpha}, \\frac{1}{\\tilde{\\lambda}}, \\text{TRUE}\\right) - \\text{GAMMADIST}\\left(a, \\tilde{\\alpha}, \\frac{1}{\\tilde{\\lambda}}, \\text{TRUE}\\right) \\right).\\] The expected frequencies under the fitted gamma distribution are given in the fourth column of Table 2.1. (Excel) For the fitted lognormal, the expected number of claims in the range \\((a,b]\\) can be obtained from \\[200 \\cdot\\left( \\text{NORMDIST} \\left(\\frac{LN(b) - \\tilde{\\mu}}{\\tilde{\\sigma}}\\right) - \\text{NORMDIST}\\left(\\frac{LN(a) - \\tilde{\\mu}}{\\tilde{\\sigma}}\\right) \\right).\\] For the fitted Pareto distribution, the expected number of claims in the range \\((a,b]\\) can be obtained from \\[200 \\left[ \\left(\\frac{\\tilde{\\lambda}}{\\tilde{\\lambda} + a} \\right)^{\\tilde{\\alpha}} - \\left(\\frac{\\tilde{\\lambda}}{\\tilde{\\lambda} + b} \\right)^{\\tilde{\\alpha}} \\right].\\] The histograms for the data set with fitted distributions are shown in Figures 2.5 and 2.6. Comments: The high positive skewness of the sample reflects the fact that SD is large when compared to the mean. Consequently, the exponential distribution may not fit the data well. Five claims (2.5%) are greater than 10,000, which is one of the main features of the loss distribution. The fit is poor for the exponential distribution, as we see that the model under-fits the data for small claims up to 367 and over-fits for large claims between 944 to 2372. The gamma fit is again poor. We see that the model over-fits for small claims between 0-109 and under-fits for claims 230 and 944. Which one of the lognormal and Pareto distributions provides a better fit to the observed claim data? library(stats) library(MASS) library(ggplot2) xbar &lt;- mean(dat$claims) s &lt;- sd(dat$claims) # MME of alpha and lambda for Gamma distribution alpha_tilde &lt;- (xbar/s)^2 lambda_tilde &lt;- alpha_tilde/xbar ggplot(dat) + geom_histogram(aes(x = claims, y = ..density..), bins = 90 , fill = &quot;grey&quot;, color = &quot;black&quot;) + stat_function(fun=dexp, geom =&quot;line&quot;, args = (rate = 1/mean(dat$claims)), aes(colour = &quot;Exponential&quot;)) + stat_function(fun=dgamma, geom =&quot;line&quot;, args = list(shape = alpha_tilde ,rate = lambda_tilde), aes(colour = &quot;Gamma&quot;)) + ylim(0, 0.0015) + scale_color_discrete(name=&quot;Fitted Distributions&quot;) Figure 2.5: Histogram of claim sizes with fitted exponential and gamma distributions. library(actuar) # MME of mu and sigma for lognormal distribution sigma_tilda &lt;- sqrt(log( var(dat$claims)/mean(dat$claims)^2 +1 )) # gives \\tilde\\sigma mu_tilda &lt;- log(mean(dat$claims)) - sigma_tilda^2/2 # gives \\tilde\\mu # MME of alpha and lambda for Pareto distribution alpha_tilda &lt;- 2*var(dat$claims)/mean(dat$claims)^2 * 1/(var(dat$claims)/mean(dat$claims)^2 - 1) #/tilde/alpha lambda_tilda &lt;- mean(dat$claims)*(alpha_tilda -1) ggplot(dat) + geom_histogram(aes(x = claims, y = ..density..), bins = 90 , fill = &quot;grey&quot;, color = &quot;black&quot;) + stat_function(fun=dlnorm, geom =&quot;line&quot;, args = list(meanlog = mu_tilda, sdlog = sigma_tilda), aes(colour = &quot;Lognormal&quot;)) + stat_function(fun=dpareto, geom =&quot;line&quot;, args = list(shape = alpha_tilda, scale = lambda_tilda), aes(colour = &quot;Pareto&quot;)) + scale_color_discrete(name=&quot;Fitted Distributions&quot;) Figure 2.6: Histogram of claim sizes with fitted lognormal and pareto distributions. Let us plot the histogram of claim sizes with fitted exponential and gamma distributions in this interaction area. Note that the data set is stored in the variable dat. eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImxpYnJhcnkoc3RhdHMpXG5saWJyYXJ5KE1BU1MpXG5saWJyYXJ5KGdncGxvdDIpXG5kYXQgPC0gYygzMS4wODk0MjE1Niw5MTUuMDI1OTM2MiwzMi4wMjM3OTU2Miw4ODUuODc1NDUxLDkzMTQuMTAwNzk3LDcwNy4xNzM4ODY2LDIxMTQuMzYyNDg2LDYwMS41ODI3ODY2LDQzNS4zNzg4MTM1LDQ5LjgwMTc5NjE5LDE4MDIuMzgzODIsMjExLjYzNjQzOSwxNTMuNTk4NDcxOSw2MC4wNTk2Njk5Miw0OC4xNzE1NzY5Nyw5NDguNzIzNDYyNiwxMzIuNDI3MzEwOSwxNTEuNzEwODE1LDI5NjcuOTYxMDM2LDczNS40MTQ5MzMyLDMwNC41ODA3NTg3LDUwLjUzMzExMDY5LDIyNC43NjY1NTQ2LDM1Ni4xODA5NDM4LDQ3NS43NjY4NDQxLDMwNDQuMTQ5NTEzLDEzLjUwNjY0ODk0LDY3Ljk4Mjc0NDQ5LDMwNC4xNDM5OTY2LDIzOC4wMDAxMDUsMzk5LjA3OTgyNjMsMTQ5LjI4MDc4LDEyOC4yODQ4Mzc5LDIxLjQyMDI3NzE4LDczLjMxNDI2NzMyLDQ5LjQ2ODgyNzkxLDY2Ny41MzI3Mjc1LDQ0LjY3MzYwMTg1LDE0ODk0LjA3ODM5LDY2MC43NjE0MzA3LDEwMC43NjI4NjI4LDYzMi4yODEyMzkxLDQyLjkwODg0Nzc3LDY2LjE3NjkzMTM1LDUwLjY5NDU0MTMyLDE4Ni44NzgxNjY3LDE2OC41NDA4NjE1LDE1MS43Mzk5NzgsMjQxOS41MzIzNTQsNDM0LjQ1NjQwMzIsNjkuMDM0NjAyMzIsMTYyLjY2OTg1OTMsMjI2LjYxMTAzOTUsMzMuNjE1MDM0OTUsMjMzLjAyNzk5NiwzMjQ0Ljk0NTg5MywzNTQuMjUzNDgxMyw3OC42MTA1Mjc0NCwyMzEuNTY2NjE0LDI4My4wMjA2NDkxLDQ1Ny42Nzg1NDI2LDEzNC4yOTMzMDU4LDYxLjM0MjY1MDYzLDM4LjI1NjkxOTEyLDE1NzguOTA5MDQ4LDQ0MS42MTk5ODI2LDc2MS40MTc3Nzc3LDI3NS42OTc4NTg4LDUyMS4wMzU1OTE2LDIxODkuNjI3ODMsMTE3LjI2Njc4ODUsMjQwLjM0MDMxNTMsNjcyLjQ1MTI5MzgsNzUzLjg5NTgwMTksODQuOTg4ODMwNzksMzY2NS40MTc5NzYsNjAuMzU5Nzc1MTUsNC4wMTkzMzMwOSwxNC45NTk1MTM2NiwxOTYuNzE0NjQwMywxNTMuNzEzMzE2NSw5OC4zMTg3NTA1MywxMDQuNDQ4NjMyNCwzNTguOTIwNTg3OCwyLjI1NDk4NjMzMSwyMDU5LjYwMzk1OSwzNy42Mzg5ODYwOCw1Ni40ODk0NDAzNSwxMTQzLjA4Mjk0OCw0MTAuNzU4NTUxNiwxMi42NTQwMjk4NiwxOS44MzMyMjUxNCwxMzA1LjEzNDc5NywyMDE5LjM2MDczNSwxMjg2Ljk4NDc5LDg4OTIuMTgyMTMxLDUuODE0NTE4NzQ5LDI5Ni4xNTUxMjk1LDg2Ljc1MzA4MTYxLDQ4Ni43ODUxNDA1LDcuNDkxMzg5Nzk4LDE4MC4zMjU1MjgxLDE0MTQuMjk3NzQ4LDUyNC40NjI4MjA4LDEwNDIuNjkwMzM0LDEyOTEuNDgxNDc0LDExNS40OTUwOTk4LDM2MC42MzEwNzM3LDMyMzMuNzE2ODM4LDE0OS41MTkxMDM5LDguODQ1ODM3NDczLDgzLjg3Mjk2MzI0LDQyLjk5NjE0NTE3LDYyMy45NzA0ODUzLDQ1Ljc0OTkwMDc0LDE0NC4yNDQ5NzkzLDM2OC41NzU2NDIsODY2LjkyNzI1NDUsNTcuNjE1OTI5MjEsMTgxMi4yMzEzMTUsMjIyOS45OTg3NTQsMzQ0OC4zMzI4ODgsMTEzMTMuMzQ3MjEsMTQ5Mi40OTg4NTYsMTk2LjcyNjI1NzEsNzEuMTE4MTc2MDEsNDI1LjA2MTQ0ODMsMzguMjg2NTMwNDgsNDQuNTA5MDAxNiwzMDguODc4MTY1NywxOTA4MC41MTc0OSw4Mi4wNzYxMzkzLDI1MC4wODM1MjMsNzkuMDc0OTIwNDIsMTgzLjg2OTc2ODYsMzMuODMxNjAzOTEsMjIuNzgyMTgyOTksNjk4Ljk1NDE2NDgsMzIuNzU0MjcwMDMsNDU3LjAxMDQ5MTksMTEyLjE3MTU1NjcsMzk2LjcxNTUyMzQsMTk1LjAyNDA3ODEsMTg2My4xODUzODUsMTgxLjY0NDExMjEsNTkuMDg3MzM2NTUsOTYuMzkwMDQxOTEsODI0LjczMDE4NCwxNTUuODIxNTE2MiwxMS44NTUxMDY2MSw4NzAuODY3OTUwMiw0MjUuMzEzMzA0NSw4NTQuNzI5NjQ3NCwyNTQuMzEwODg5Miw2NjQuMzMyMDEwNyw1Ni4yNjEyMDc1MiwzNzguMjQ0MDE2LDIwNjkuNDMxNDk1LDMxMjEuMDkwMSw4NDQuNDMzNzU5NCw3NDYuMzg1MzY3NSwxODUxLjQ2OTYzMyw0MzEuNzA2MDIzMiwzMzMuMzI1NDgxLDIyLjIzOTcwMTAyLDY2Mi4zODE2ODg4LDExNy43NTkwMDU3LDU3MC40NDEyODI5LDExMjcuMDM1MzA2LDI0Ni4yNjg2MTgzLDE0NjcuNTY4ODY3LDM0Ljg5MTg3MTEyLDIzNy41NzYxNjkzLDM0OS40NTAzOTY3LDIyOS4zMzYyODQ5LDkzNC42OTI2NTYxLDE2Mi45MjU0NDA4LDU4LjI4NDk3MTcyLDEyODAzLjA0NzI2LDE1Ljk0OTA0MTg5LDk1OS45NTQzNDAyLDU4NTMuODc4OTc5LDUzNy4zOTc0MjUzLDc1LjMwNTcyODgzLDcxOC42NTk3NTIxLDYzMy44MjE0NDM4LDM2My4wMzM4MDc2LDk1Ljg0NzYyNjYsODAuMzE3ODY1MywyODYuNzEyMTc2Myw2MzY3LjQ1MzQwOCwzMjEuNTY3NzExLDIxLjUxODM4MDIyLDU5OS40NzEyOTU4LDI0Ni43MDA3MDczLDEzODYzLjc4MTgxLDIxNC43MzQyNTk3LDIzNC4zMjEyOTUyLDk1OC45MTYxNzksMTY1LjI1MjEzODUpXG5kYXQgPC0gZGF0YS5mcmFtZShjbGFpbXMgPSBkYXQpIiwic2FtcGxlIjoiIyBOb3RlIHRoYXQgdGhlIG9iamVjdCBcImRhdFwiIGlzIGRhdGEgZnJhbWUuIFRvIGFjY2VzcyB0aGUgY2xhaW1zIGRhdGEgd2UgdXNlIGRhdCRjbGFpbXMuICMgRmlsbCB5b3VyIGNvZGUgYmVsb3cuIFxuY2xhc3MoZGF0KSIsInNvbHV0aW9uIjoiZ2dwbG90KGRhdCkgKyBcbiAgZ2VvbV9oaXN0b2dyYW0oYWVzKHggPSBjbGFpbXMsIHkgPSAuLmRlbnNpdHkuLiksIGJpbnMgPSA5MCAsIGZpbGwgPSBcImdyZXlcIiwgY29sb3IgPSBcImJsYWNrXCIpICsgXG4gIHN0YXRfZnVuY3Rpb24oZnVuPWRleHAsIGdlb20gPVwibGluZVwiLCBhcmdzID0gKHJhdGUgPSAxL21lYW4oZGF0JGNsYWltcykpLCBhZXMoY29sb3VyID0gXCJFeHBcIikpICtcbiAgc2NhbGVfY29sb3JfZGlzY3JldGUobmFtZT1cIkZpdHRlZCBEaXN0cmlidXRpb25zXCIpIn0= The following code can be used to obtain the expected number of claims for the fitted exponential distribution and perform goodness-of-fit test. eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImxpYnJhcnkoc3RhdHMpXG5saWJyYXJ5KE1BU1MpXG5saWJyYXJ5KGdncGxvdDIpXG5kYXQgPC0gYygzMS4wODk0MjE1Niw5MTUuMDI1OTM2MiwzMi4wMjM3OTU2Miw4ODUuODc1NDUxLDkzMTQuMTAwNzk3LDcwNy4xNzM4ODY2LDIxMTQuMzYyNDg2LDYwMS41ODI3ODY2LDQzNS4zNzg4MTM1LDQ5LjgwMTc5NjE5LDE4MDIuMzgzODIsMjExLjYzNjQzOSwxNTMuNTk4NDcxOSw2MC4wNTk2Njk5Miw0OC4xNzE1NzY5Nyw5NDguNzIzNDYyNiwxMzIuNDI3MzEwOSwxNTEuNzEwODE1LDI5NjcuOTYxMDM2LDczNS40MTQ5MzMyLDMwNC41ODA3NTg3LDUwLjUzMzExMDY5LDIyNC43NjY1NTQ2LDM1Ni4xODA5NDM4LDQ3NS43NjY4NDQxLDMwNDQuMTQ5NTEzLDEzLjUwNjY0ODk0LDY3Ljk4Mjc0NDQ5LDMwNC4xNDM5OTY2LDIzOC4wMDAxMDUsMzk5LjA3OTgyNjMsMTQ5LjI4MDc4LDEyOC4yODQ4Mzc5LDIxLjQyMDI3NzE4LDczLjMxNDI2NzMyLDQ5LjQ2ODgyNzkxLDY2Ny41MzI3Mjc1LDQ0LjY3MzYwMTg1LDE0ODk0LjA3ODM5LDY2MC43NjE0MzA3LDEwMC43NjI4NjI4LDYzMi4yODEyMzkxLDQyLjkwODg0Nzc3LDY2LjE3NjkzMTM1LDUwLjY5NDU0MTMyLDE4Ni44NzgxNjY3LDE2OC41NDA4NjE1LDE1MS43Mzk5NzgsMjQxOS41MzIzNTQsNDM0LjQ1NjQwMzIsNjkuMDM0NjAyMzIsMTYyLjY2OTg1OTMsMjI2LjYxMTAzOTUsMzMuNjE1MDM0OTUsMjMzLjAyNzk5NiwzMjQ0Ljk0NTg5MywzNTQuMjUzNDgxMyw3OC42MTA1Mjc0NCwyMzEuNTY2NjE0LDI4My4wMjA2NDkxLDQ1Ny42Nzg1NDI2LDEzNC4yOTMzMDU4LDYxLjM0MjY1MDYzLDM4LjI1NjkxOTEyLDE1NzguOTA5MDQ4LDQ0MS42MTk5ODI2LDc2MS40MTc3Nzc3LDI3NS42OTc4NTg4LDUyMS4wMzU1OTE2LDIxODkuNjI3ODMsMTE3LjI2Njc4ODUsMjQwLjM0MDMxNTMsNjcyLjQ1MTI5MzgsNzUzLjg5NTgwMTksODQuOTg4ODMwNzksMzY2NS40MTc5NzYsNjAuMzU5Nzc1MTUsNC4wMTkzMzMwOSwxNC45NTk1MTM2NiwxOTYuNzE0NjQwMywxNTMuNzEzMzE2NSw5OC4zMTg3NTA1MywxMDQuNDQ4NjMyNCwzNTguOTIwNTg3OCwyLjI1NDk4NjMzMSwyMDU5LjYwMzk1OSwzNy42Mzg5ODYwOCw1Ni40ODk0NDAzNSwxMTQzLjA4Mjk0OCw0MTAuNzU4NTUxNiwxMi42NTQwMjk4NiwxOS44MzMyMjUxNCwxMzA1LjEzNDc5NywyMDE5LjM2MDczNSwxMjg2Ljk4NDc5LDg4OTIuMTgyMTMxLDUuODE0NTE4NzQ5LDI5Ni4xNTUxMjk1LDg2Ljc1MzA4MTYxLDQ4Ni43ODUxNDA1LDcuNDkxMzg5Nzk4LDE4MC4zMjU1MjgxLDE0MTQuMjk3NzQ4LDUyNC40NjI4MjA4LDEwNDIuNjkwMzM0LDEyOTEuNDgxNDc0LDExNS40OTUwOTk4LDM2MC42MzEwNzM3LDMyMzMuNzE2ODM4LDE0OS41MTkxMDM5LDguODQ1ODM3NDczLDgzLjg3Mjk2MzI0LDQyLjk5NjE0NTE3LDYyMy45NzA0ODUzLDQ1Ljc0OTkwMDc0LDE0NC4yNDQ5NzkzLDM2OC41NzU2NDIsODY2LjkyNzI1NDUsNTcuNjE1OTI5MjEsMTgxMi4yMzEzMTUsMjIyOS45OTg3NTQsMzQ0OC4zMzI4ODgsMTEzMTMuMzQ3MjEsMTQ5Mi40OTg4NTYsMTk2LjcyNjI1NzEsNzEuMTE4MTc2MDEsNDI1LjA2MTQ0ODMsMzguMjg2NTMwNDgsNDQuNTA5MDAxNiwzMDguODc4MTY1NywxOTA4MC41MTc0OSw4Mi4wNzYxMzkzLDI1MC4wODM1MjMsNzkuMDc0OTIwNDIsMTgzLjg2OTc2ODYsMzMuODMxNjAzOTEsMjIuNzgyMTgyOTksNjk4Ljk1NDE2NDgsMzIuNzU0MjcwMDMsNDU3LjAxMDQ5MTksMTEyLjE3MTU1NjcsMzk2LjcxNTUyMzQsMTk1LjAyNDA3ODEsMTg2My4xODUzODUsMTgxLjY0NDExMjEsNTkuMDg3MzM2NTUsOTYuMzkwMDQxOTEsODI0LjczMDE4NCwxNTUuODIxNTE2MiwxMS44NTUxMDY2MSw4NzAuODY3OTUwMiw0MjUuMzEzMzA0NSw4NTQuNzI5NjQ3NCwyNTQuMzEwODg5Miw2NjQuMzMyMDEwNyw1Ni4yNjEyMDc1MiwzNzguMjQ0MDE2LDIwNjkuNDMxNDk1LDMxMjEuMDkwMSw4NDQuNDMzNzU5NCw3NDYuMzg1MzY3NSwxODUxLjQ2OTYzMyw0MzEuNzA2MDIzMiwzMzMuMzI1NDgxLDIyLjIzOTcwMTAyLDY2Mi4zODE2ODg4LDExNy43NTkwMDU3LDU3MC40NDEyODI5LDExMjcuMDM1MzA2LDI0Ni4yNjg2MTgzLDE0NjcuNTY4ODY3LDM0Ljg5MTg3MTEyLDIzNy41NzYxNjkzLDM0OS40NTAzOTY3LDIyOS4zMzYyODQ5LDkzNC42OTI2NTYxLDE2Mi45MjU0NDA4LDU4LjI4NDk3MTcyLDEyODAzLjA0NzI2LDE1Ljk0OTA0MTg5LDk1OS45NTQzNDAyLDU4NTMuODc4OTc5LDUzNy4zOTc0MjUzLDc1LjMwNTcyODgzLDcxOC42NTk3NTIxLDYzMy44MjE0NDM4LDM2My4wMzM4MDc2LDk1Ljg0NzYyNjYsODAuMzE3ODY1MywyODYuNzEyMTc2Myw2MzY3LjQ1MzQwOCwzMjEuNTY3NzExLDIxLjUxODM4MDIyLDU5OS40NzEyOTU4LDI0Ni43MDA3MDczLDEzODYzLjc4MTgxLDIxNC43MzQyNTk3LDIzNC4zMjEyOTUyLDk1OC45MTYxNzksMTY1LjI1MjEzODUpXG5kYXQgPC0gZGF0YS5mcmFtZShjbGFpbXMgPSBkYXQpIiwic2FtcGxlIjoibGlicmFyeSh0aWR5cilcbmogPSAwOjlcbnVwYmQgPSBxZXhwKGovMTAsIDEvbWVhbihkYXQkY2xhaW1zKSkgICMxL21lYW4oZGF0JGNsYWltcykgZ2l2ZXMgdGhlIHBhcmFtZXRlciBvZiBleHBvbmVudGlhbCBkaXN0XG5vYnNlcnZhdGlvbiA8LSBjdXQoZGF0JGNsYWltcywgYnJlYWtzID0gdXBiZCxkaWcubGFiPTEwKVxudGFibGUob2JzZXJ2YXRpb24pXG5cbiMgVG8gZml4IHRoZSBjbGFzcyBpbnRlcnZhbCAodXBiZCB3aGVuIGogPSA5LGluZmluaXR5KVxudXBiZFtsZW5ndGgodXBiZCkrMV0gPSAxMDAwMDAwXG51cGJkXG5vYnNlcnZhdGlvbiA8LSBjdXQoZGF0JGNsYWltcywgYnJlYWtzID0gdXBiZClcblxudGFiU3VtbWFyeSA8LSB0YWJsZShvYnNlcnZhdGlvbilcblxuYmFycGxvdCh0YWJTdW1tYXJ5LG1haW49XCJDbGFpbSBzaXplc1wiLGxhcz0yKVxuXG4jIE9idGFpbiBFKEV4cCksIHRoZSBmaXR0ZWQgY2xhaW0gc2l6ZXNcbmVleHAgPC0gZGlmZigyMDAqcGV4cCh1cGJkLCByYXRlID0gMS9tZWFuKGRhdCRjbGFpbXMpKSlcblxudGFiU3VtbWFyeSA8LSBkYXRhLmZyYW1lKHRhYlN1bW1hcnkpIFxuY29sbmFtZXModGFiU3VtbWFyeSkgPC0gYyhcIlJhbmdlXCIsIFwiT2JzZXJ2YXRpb25cIilcblxudGFiU3VtbWFyeSA8LSBkYXRhLmZyYW1lKHRhYlN1bW1hcnksIEV4cG9uZW50aWFsID0gZWV4cClcblxuI3N1bW1hcnkgb2YgZXhwb25lbnRpYWwgZml0XG5jaGlzcS50ZXN0KHggPSB0YWJTdW1tYXJ5JE9ic2VydmF0aW9uLFxuICAgICAgICAgICBwID0gZWV4cC9zdW0oZWV4cCkpXG5cbiMgTWFudWFsbHkgY29tcHV0ZSBjaGktc3F1YXJlIHN0YXRpc3RpY3NcbnN1bSgodGFiU3VtbWFyeSRPYnNlcnZhdGlvbiAtIGVleHApXjIgL2VleHApICAgIn0= "],["deductibles-and-reinsurance.html", "Chapter 3 Deductibles and reinsurance 3.1 Introduction 3.2 Deductibles 3.3 Reinsurance 3.4 Excess of loss reinsurance 3.5 Mixed distributions 3.6 The distribution of reinsurance claims 3.7 Proportional reinsurance", " Chapter 3 Deductibles and reinsurance 3.1 Introduction In this chapter, we will introduce the concept of risk-sharing. We will consider two types of risk-sharing including deductibles and reinsurance. The purpose of risk sharing is to spread the risk among the parties involved. For example, A policyholder purchases automobile insurance with a deductible. The policyholder is responsible for some of the risk , and transfer the larger portion of the risk to the insurer. The policyholder will submit a claim when the loss exceeds the deductible. A direct insurer can pass on some of the risks to another insurance company known as a reinsurer by purchasing insurance from the reinsurer. It will protect the insurer from paying large claims. The main goals of the chapter include the derivation of the distribution and corresponding moments of the claim amounts paid by the policyholder, direct insurer and the reinsurer in the presence of risk-sharing arrangements. In addition, the effects of risk-sharing arrangements will reduce the mean and variability of the amount paid by the direct insurer, and also the probability that the insurer will be involved on very large claims. 3.2 Deductibles The insurer can modify the policy so that the policyholder is responsible for some of the risk by including a deductible (also known as policy excess). Given a financial loss of \\(X\\) and a deductible of \\(d\\), the insured agrees to bear the first amount of \\(d\\) of any loss \\(X\\), and only submits a claim when \\(X\\) exceeds \\(d\\). the insurer will pay the remaining of \\(X - d\\) if the loss \\(X\\) exceeds \\(d\\). For example, suppose a policy has a deductible of 1000, and you incur a loss of 3000 in a car accident. You pay the deductible of 1000 and the car insurance company pays the remaining of 2000. Let \\(X\\) be the claim amount, \\(V\\) and \\(Y\\) the amounts of the claim paid by the policyholder, the (direct) insurer, respectively, i.e. \\[X = V + Y.\\] So the amount paid by the policyholder and the insurer are given by \\[\\begin{aligned} V = \\begin{cases} X &amp;\\text{if } X \\le d\\\\ d &amp;\\text{if } X &gt; d, \\end{cases} \\\\ Y = \\begin{cases} 0 &amp;\\text{if } X \\le d\\\\ X - d &amp;\\text{if } X &gt; d. \\end{cases}\\end{aligned}\\] The amounts \\(V\\) and \\(Y\\) can also be expressed as \\[V = \\min(X,d), \\quad Y = \\max(0,X-d).\\] The relationship between the policyholder and insurer is similar to that between the insurer and reinsurer. Therefore, the detailed analysis of a policy with a deductible is analogous to reinsurance, which will be discussed in the following section. 3.3 Reinsurance Reinsurance is insurance purchased by an insurance company in order to protect itself from large claims. There are two main types of reinsurance arrangement: excess of loss reinsurance; and proportional reinsurance. 3.4 Excess of loss reinsurance Under excess of loss reinsurance arrangement, the direct insurer sets a certain limit called a retention level \\(M &gt;0\\). For a claim \\(X\\), the insurance company pays any claim in full if \\(X \\le M\\); and the reinsurer (or reinsurance company) pays the remaining amount of \\(X - M\\) if \\(X &gt; M\\). The position of the reinsurer under excess of loss reinsurance is the same as that of the insurer for a policy with a deductible. Let \\(X\\) be the claim amount, \\(V, Y\\) and \\(Z\\) the amounts of the claim paid by the policyholder, (direct) insurer and reinsurer, respectively, i.e. \\[X = V + Y + Z.\\] In what follows, without stated otherwise, we consider the case in which there is no deductible in place, i.e. \\(V = 0\\) and \\[X = Y + Z.\\] So the amount paid by the direct insurer and the reinsurer are given by \\[\\begin{aligned} Y = \\begin{cases} X &amp;\\text{if } X \\le M\\\\ M &amp;\\text{if } X &gt; M, \\end{cases} \\\\ Z = \\begin{cases} 0 &amp;\\text{if } X \\le M\\\\ X - M &amp;\\text{if } X &gt; M. \\end{cases}\\end{aligned}\\] The amounts \\(Y\\) and \\(Z\\) can also be expressed as \\[Y = \\min(X,M), \\quad Z = \\max(0,X-M).\\] Example 3.1 Suppose a policy has a deductible of 1000 and the insurer arrange excess of loss reinsurance with retention level of 10000. A sample of loss amounts in one year consists of the following values, in unit of Thai baht: \\[3000, 800, 25000, 5000, 20000 .\\] Calculate the total amount paid by:* the policyholder; the insurer; and the reinsurer. Solution: The total amounts paid by the policyholders : \\[1000 + 800 + 1000 + 1000 + 1000 = 4800.\\] The insurer : \\[2000 + 0 + 10000 + 4000 + 10000 = 26000.\\] The reinsurer : \\[0 + 0 + 14000 + 0 + 9000 = 23000.\\] 3.5 Mixed distributions In the subsequent sections, we will derive the probability distribution of the random variables \\(Y\\) and \\(Z\\), which are the insurer’s and reinsurer’s payouts on claims. Their distributions are neither purely continuous, nor purely discrete. First we start with some important properties of such random variables. A random variable \\(U\\) which is partly discrete and partly continuous is said to be a mixed distribution. The distribution function of \\(U\\), denoted by \\(F_U(x)\\) is continuous and differentiable except for some values of \\(x\\) in a countable set \\(S\\). For a mixed distribution \\(U\\), there exists a function \\(f_U(x)\\) such that \\[F_U(x) = \\Pr(U \\le x) = \\int_{-\\infty}^x f_U(x) dx + \\sum_{x_i \\in S, x_i \\le x } \\Pr(U = x_i).\\] The expected value of \\(g(U)\\) for some function \\(g\\) is given by \\[\\begin{equation} \\tag{3.1} \\mathrm{E}[g(U)] = \\int_{-\\infty}^\\infty g(x) f_U(x) \\mathop{}\\!d{x} + \\sum_{x_i \\in S } g(x_i) \\Pr(U = x_i). \\end{equation}\\] It is the sum of the integral over the intervals at which \\(f_U(x)\\) is continuous and the summation over the points in \\(S\\). The function \\(f_U(x)\\) is not the probability density function of \\(U\\) because \\(\\int_{-\\infty}^\\infty f_U(x) dx \\neq 1\\). In particular, it is the derivative of \\(F_U(x)\\) at the points where \\(F_U(x)\\) is continuous and differentiable. Recall that \\(X\\) denotes the claim amount and \\(Y\\) and \\(Z\\) be the amounts of the claim paid by the insurer and reinsurer. The distribution function and the density function of the claim amount \\(X\\) are denoted by \\(F_{X}\\) and \\(f_X(x)\\), where we assume that \\(X\\) is continuous. In the following examples, we will derive the distribution, mean and variance of the random variables \\(Y\\) and \\(Z\\). Furthermore, both random variables \\(Y\\) and \\(Z\\) are examples of mixed distributions. Example 3.2 Let \\(F_Y\\) denote the distribution function of \\(Y = \\min(X,M)\\). It follows that \\[F_Y(x) = \\begin{cases} F_X(x) &amp;\\text{if } x &lt; M\\\\ 1 &amp;\\text{if } x \\ge M \\end{cases}.\\] Hence, the distribution function of \\(Y\\) is said to be a mixed distribution. Solution: From \\(Y = \\min(X,M)\\), if \\(y &lt; M\\), then \\[F_Y(y) = \\Pr(Y \\le y) = \\Pr(X \\le y) = F_X(y).\\] If \\(y \\ge M\\), then \\[F_Y(y) = \\Pr(Y \\le y) = 1,\\] which follows because \\(\\min(X,M) \\le M\\). Hence, \\(Y\\) is mixed with a density function \\(f_X(x)\\), for \\(0 \\le x &lt; M\\) and a mass of probability at \\(M\\), with \\(Pr(Y = M) = 1 - F_X(M)\\). The last equality follows from \\[\\begin{aligned} \\Pr(Y = M) &amp;= \\Pr(X &gt; M) \\\\ &amp;= 1 - \\Pr(X \\le M) = 1 - F_X(M). \\end{aligned}\\] Example 3.3 Show that \\[\\mathrm{E}[Y] = \\mathrm{E}[\\min(X,M)] = \\mathrm{E}[X] - \\int_0^\\infty y f_X(y+M) \\mathop{}\\!dy.\\] \\(\\mathrm{E}[Y]\\) is the expected payout by the insurer. \\[\\begin{aligned} \\mathrm{E}[Y] &amp;= \\mathrm{E}[\\min(X,M)] \\\\ &amp;= \\int_0^\\infty \\min(X,M) \\cdot f_X(x) \\, dx \\\\ &amp;= \\int_0^M x \\cdot f_X(x) \\, dx + \\int_M^\\infty M \\cdot f_X(x) \\, dx \\\\ &amp;= \\int_0^M x \\cdot f_X(x) \\, dx + \\int_M^\\infty x \\cdot f_X(x) \\, dx + \\int_M^\\infty (M - x) \\cdot f_X(x) \\, dx \\\\ &amp;= \\mathrm{E}[X] + \\int_M^\\infty (M - x) \\cdot f_X(x) \\, dx \\\\ &amp;= \\mathrm{E}[X] + \\int_0^\\infty (-y) \\cdot f_X(y+M) \\, dy \\\\ &amp;= \\mathrm{E}[X] - \\int_0^\\infty y \\cdot f_X(y+M) \\, dy \\end{aligned}\\] Note Under excess of loss reinsurance arrangement, the mean amount paid by the insurer is reduced by the amount equal to \\(\\int_0^\\infty y f_X(y+M) \\mathop{}\\!dy.\\) Example 3.4 Let \\(X\\) be an exponential distribution with parameter \\(\\lambda\\) and \\(Y = \\min(X,M)\\). Then \\[F_Y(x) = \\begin{cases} 1 - e^{-\\lambda x} &amp;\\text{if } x &lt; M\\\\ 1 &amp;\\text{if } x \\ge M \\end{cases}.\\] A plot of the distribution function \\(F_Y\\) is given in Figure 1. Hence, \\(Y\\) is a mixed distribution with a density function \\(f_Y(x) = f_X(x)\\) for \\(0 &lt; x &lt; M\\) and a probability mass at \\(M\\) is \\(\\Pr(Y = M) = 1 - F_X(M)\\). Using (3.1), the expected value of \\(Y\\), \\(\\mathrm{E}[Y]\\) is given by \\[\\begin{aligned} \\mathrm{E}[Y] &amp;= \\int_{0}^M x f_X(x) \\mathop{}\\!d{x} + M(1 - F_X(M)). \\end{aligned}\\] Example 3.5 Let \\(F_Z\\) denote the distribution function of \\(Z = \\max(0,X-M)\\). It follows that \\[F_Z(x) = \\begin{cases} F_{X}(M) &amp;\\text{if } x = 0\\\\ F_{X}(x + M) &amp;\\text{if } x &gt; 0 \\end{cases}.\\] Hence, the distribution function of \\(Z\\) is a mixed distribution with a mass of probability at \\(0\\). Solution: The random variable \\(Z\\) is the reinsurer’s payout which also include zero claims. Later we will consider only reinsurance claims, which involve the reinsurer, i.e. claims such that \\(X &gt; M\\). The distribution of \\(Z\\) can be derived as follows: For \\(x =0\\), \\[F_Z(0) = \\Pr(Z = 0) = \\Pr(X \\le M) = F_X(M).\\] For \\(x &gt; 0\\), \\[\\begin{aligned} F_Z(x) &amp;= \\Pr(Z \\le x) = \\Pr(\\max(0,X-M) \\le x) \\\\ &amp;= \\Pr(X- M \\le x) = \\Pr(X \\le x + M) = F_X(x + M).\\end{aligned}\\] Example 3.6 Let \\(X\\) be an exponential distribution with parameter \\(\\lambda\\) and \\(Z = \\max(0,X-M)\\). Derive and plot the probability distribution \\(F_Z\\) for \\(\\lambda = 1\\) and \\(M = 2\\). Example 3.7 Show that \\[\\mathrm{E}[Z] = \\mathrm{E}[\\max(0,X-M)] = \\int_M^\\infty (x- M) f_X(x) \\mathop{}\\!dx = \\int_0^\\infty y f_X(y+M) \\mathop{}\\!dy.\\] Comment on the result. Solution: The expected payout on the claim by the reinsurer, \\(\\mathrm{E}[Z]\\), and can also be found directly as follows: \\[\\begin{aligned} \\mathrm{E}[Z] &amp;= \\mathrm{E}[\\max(0,X-M)] \\\\ &amp;= \\int_0^M 0 \\cdot f_X(x) \\, dx + \\int_M^\\infty (X-M) \\cdot f_X(x) \\, dx \\\\ &amp;= 0 + \\int_0^\\infty y \\cdot f_X(y + M) \\, dy.\\end{aligned}\\] It follows from the previous results that \\[\\mathrm{E}[X] = \\mathrm{E}[Y + Z] = \\mathrm{E}[Y]+ \\mathrm{E}[Z].\\] Example 3.8 Let the claim amount \\(X\\) have exponential distribution with mean \\(\\mu = 1/\\lambda\\). Find the proportion of claims which involve the reinsurer. Find the insurer’s expected payout on a claim. Find the reinsurer’s expected payout on a claim. Solution: 1. The proportion of claims which involve the reinsurer is \\[\\Pr(X &gt; M) = 1 - F_X(M) = e^{-\\lambda M} = e^{-M/\\mu}.\\] The insurer’s expected payout on a claim can be calculated by \\[\\begin{aligned} \\mathrm{E}[Y] &amp;= \\mathrm{E}[X] - \\int_0^\\infty y \\cdot \\lambda e^{-\\lambda(y+M)} \\, dy \\\\ &amp;= \\mathrm{E}[X] - e^{-\\lambda M} \\int_0^\\infty y \\cdot \\lambda e^{-\\lambda \\cdot y} \\, dy \\\\ &amp;= \\mathrm{E}[X] - e^{-\\lambda M} \\mathrm{E}[X] \\\\ &amp;= (1 - e^{-\\lambda M}) \\mathrm{E}[X].\\end{aligned}\\] It follows from the above result that the reinsurer’s expected payout on a claim is \\(e^{-\\lambda M} \\mathrm{E}[X].\\) Example 3.9 An insurer covers an individual loss \\(X\\) with excess of loss reinsurance with retention level \\(M\\). Let \\(f_X(x)\\) and \\(F_X(x)\\) denote the pdf and cdf of \\(X\\), respectively. Show that the variance of the amount paid by the insurer on a single claim satisfies: \\[\\mathrm{Var}[\\min(X,M)] = \\int_0^M x^2 f_X(x) \\mathop{}\\!dx + M^2 (1 - F_X(M)) - (\\mathrm{E}[\\min(X,M)])^2.\\] Show that the variance of the amount paid by the reinsurer on a single claim satisfies: \\[\\mathrm{Var}[\\max(0,X-M)] = \\int_M^\\infty (x-M)^2 f_X(x) \\mathop{}\\!dx - (\\mathrm{E}[\\max(0,X-M)])^2.\\] 3.6 The distribution of reinsurance claims In practice, the reinsurer involves only claims which exceed the retention limit, i.e. \\(X &gt; M\\). Information of claims which are less or equal to \\(M\\) may not be available to the reinsurer. The claim amount \\(Z\\) paid by the reinsurer can be modified accordingly to take into account of non-zero claim sizes. Recall from Example 3.1, there are only three claims whose amounts exceed the retention level of . Such claims, consisting of , 9000 and 23000 which involves the reinsurer are known as reinsurance claims. Let \\(W = Z|Z&gt;0\\) be a random variable representing the amount of a non-zero payment by the reinsurer on a reinsurance claim. The distribution and density of \\(W\\) can be calculated as follows: for \\(x &gt; 0\\), \\[\\begin{aligned} \\Pr[W \\le x ] &amp;= \\Pr[Z \\le x | Z &gt;0] \\\\ &amp;= \\Pr[X - M \\le x | X &gt; M] \\\\ &amp;= \\frac{\\Pr[M &lt; X \\le x + M]}{\\Pr[X &gt; M]}\\\\ &amp;= \\frac{F_X(x+M) - F_X(M)}{1-F_X(M)}.\\end{aligned}\\] Differentiating with respect to \\(x\\), we obtain the density function of \\(W\\) as \\[f_W(x) = \\frac{f_X(x+M)}{1 - F_X(M)}.\\] Hence, the mean and variance can be directly obtained from the density function of \\(W\\). 3.7 Proportional reinsurance Under excess of loss reinsurance arrangement, the direct insurer pays a fixed proportion \\(\\alpha\\), called the proportion of the risk retained by the insurer, and the reinsurer pays the remainder of the claim. Let \\(X\\) be the claim amount, \\(Y\\) and \\(Z\\) the amounts of the claim paid by the policyholder, (direct) insurer and reinsurer, respectively, i.e. \\[X = Y + Z.\\] So the amount paid by the direct insurer and the reinsurer are given by \\[Y = \\alpha X, \\quad Z = (1 - \\alpha) X.\\] Both of the random variables are scaled by the factor of \\(\\alpha\\) and \\(1- \\alpha\\), respectively. Example 3.10 Derive the distribution function and density function of \\(Y\\). Solution: Let \\(X\\) has a distribution function \\(F\\) with density function \\(f\\). The distribution function of \\(Y\\) is given by \\[\\Pr(Y \\le x) = F(x/a).\\] Hence, the density function is \\[f_Y(x) = \\frac{1}{a}f(x/a).\\] You can get more examples from Tutorials. "],["collective-risk-model.html", "Chapter 4 Collective Risk Model 4.1 Conditional expectation and variance formulas 4.2 The moments of a compound distribution \\(S\\) 4.3 Special compound distributions 4.4 The effect of reinsurance 4.5 Approximation of the collective risk model 4.6 Recursive calculation of the collective risk model 4.7 Premium calculation", " Chapter 4 Collective Risk Model Mathematical models of the total amount of claims from a portfolio of policies over a short period of time will be presented in this chapter. The models are referred to as short term risk models. Two main sources of uncertainty including the claim numbers and claim sizes will be taken into consideration. We will begin with the model for aggregate (total) claims or collective risk models. We define the following random variables: \\(S\\) denotes total amount of claims from a portfolio of policies in a fixed time interval, for e.g. one year, \\(N\\) represents the number of claims, and \\(X_i\\) denotes the amount of the \\(i\\)th claim. Then the total claims \\(S\\) is given by \\[S = X_1 + \\ldots + X_N.\\] The following assumptions are made for deriving the collective risk model: \\(\\{X_i \\}_{i=1}^\\infty\\) are independent and identically distributed with distribution function \\(F_X\\). \\(N\\) is independent of \\(\\{X_i \\}_{i=1}^\\infty\\). The distribution of the total claim \\(S\\) is said to be a compound distribution. The properties of the compound distribution will be given in the Section 2. Note The distribution of \\(S\\) can be derived by using convolution technique. In general, the closed form expressions for the compound distribution do not exist so we will mainly concern with the moments of \\(S\\). For more details about convolution, see Gray and Pitts (2012). 4.1 Conditional expectation and variance formulas Some useful properties of conditional expectation and conditional variance are given. The conditional expectaion formula is \\[E[ E[X|Y ]] = E[X].\\] The conditional variance of \\(X\\) given \\(Y\\) is defined to be \\[\\begin{split} Var[X|Y] &amp;= Var[Z] \\text{ where } Z = X|Y \\\\ &amp;= E[(Z - E[Z])^2] = E[Z^2] - (E[Z])^2 \\\\ &amp;= E[(X - E[X|Y])^2 | Y] \\\\ &amp;= E[X^2| Y] - (E[X|Y])^2. \\\\ \\end{split}\\] The conditional variance formula is \\[\\begin{equation} \\tag{4.1} Var[X] = E[ Var[X|Y ]] + Var[E[X|Y ]]. \\end{equation}\\] Example 4.1 Show that \\[Var[X] = E[ Var[X|Y ]] + Var[E[X|Y ]].\\] Solution: Consider the terms on the right-hand side of (4.1). We have \\[\\begin{aligned} E[Var[X|Y]] &amp;= E\\left[ E[X^2|Y] - (E[X|Y])^2 \\right] \\\\ &amp;= E[X^2] - E\\left[(E[X|Y])^2 \\right], \\end{aligned}\\] and \\[\\begin{aligned} Var[E[X|Y ]] &amp;= Var[Z] \\text{ where } Z = E[X|Y ] \\\\ &amp;= E[(E[X|Y ])^2] - (E[E[X|Y ]])^2 \\\\ &amp;= E[(E[X|Y ])^2] - (E[X])^2 \\\\ \\end{aligned}\\] Adding both terms gives the required result. Example 4.2 In three coloured boxes - Red, Green and Blue, each box has two bags. The bags of Red box contain 1 and 2 (in units of THB) respectively, those of Green box contain 1 and 5, and those of Blue contain 1 and 10 . A box is chosen at random in such a way that \\(\\Pr(\\text{Red}) = \\Pr(\\text{Green}) = \\Pr(\\text{Blue}) = 1/3\\). A fair coin is tossed to determined which bag to be chosen from the chosen box. Let \\(X\\) be the value of the contents of the chosen bag. Find the distribution of \\(X\\). Find \\(E[X]\\) and \\(Var[X]\\). Use the conditional expectation and conditional variance formulas to verify your results. Solution: 1. The distribution of \\(X\\) can be obtained by using the law of total probability: for example \\[\\begin{aligned} P(X= 1) &amp;= P(X = 1 , R) + P(X = 1 , G) + P(X = 1 , B) \\\\ &amp;= P(X = 1 | R) \\cdot P(R) + P(X = 1 | G) \\cdot P(G) + P(X = 1 | B) \\cdot P(B) \\\\ &amp;= \\frac{1}{2} \\cdot \\frac{1}{3} + \\frac{1}{2} \\cdot \\frac{1}{3} + \\frac{1}{2} \\cdot \\frac{1}{3} = \\frac{1}{2}. \\end{aligned}\\] Similarly, we have \\[P(X = 1 ) = \\frac{1}{2}, \\quad P(X = 2 ) = P(X = 5 ) = P(X = 10 ) = \\frac{1}{6}.\\] It follows that \\[E[X] = \\frac{10}{3}, \\quad Var[X] = \\frac{98}{9}.\\] We first calculate \\[\\begin{aligned} E[X|R] &amp;= \\frac{1}{2}\\cdot(1 + 2) = \\frac{3}{2} \\\\ E[X|G] &amp;= \\frac{1}{2}\\cdot(1 + 5) = 3 \\\\ E[X|B] &amp;= \\frac{1}{2}\\cdot(1 + 10) = \\frac{11}{2}. \\\\ \\end{aligned}\\] We have \\[\\begin{aligned} E[X] &amp;= E[X | R] \\cdot P(R) + E[X | G] \\cdot P(G) + E[X | B] \\cdot P(B) \\\\ &amp;= \\frac{1}{3}\\cdot(\\frac{3}{2} + 3 + \\frac{11}{2}) = \\frac{10}{3}. \\end{aligned}\\] 4.2 The moments of a compound distribution \\(S\\) The moments and moment generating function of \\(S\\) can be easily derived from the conditional expectation formula. 4.2.1 The mean of \\(S\\) Let \\(m_k\\) be the \\(k\\)th moment of \\(X_1\\), i.e. \\(E[X_1^k] = m_k\\). Conditional on \\(N = n\\), we have \\[E[S | N = n] = E[ \\sum_{i=1}^n X_i] = \\sum_{i=1}^n E[ X_i] = n E[ X_i] = n \\cdot m_1.\\] Hence, \\(E[S | N] = N m_1\\) and \\[E[S] = E[E[S | N]] = E[N m_1] = E[N] m_1 = E[N] \\cdot E[X_1].\\] It is no surprise that the mean of the total claims is the product of the means of the number of claims and the mean of claim sizes. 4.2.2 The variance of \\(S\\) Using the fact that \\(\\{X_i \\}_{i=1}^\\infty\\) are independent, we have \\[Var[S | N = n] = Var[ \\sum_{i=1}^n X_i] = \\sum_{i=1}^n Var[ X_i] = n Var[ X_i] =n (m_2 - m_1^2),\\] and \\(Var[S | N] = N (m_2 - m_1^2).\\) It follows that \\[\\begin{aligned} Var[S] &amp;= E[ Var[S | N] ] + Var[ E[S | N] ] \\\\ &amp;= E[ N (m_2 - m_1^2) ] + Var[ N m_1 ] \\\\ &amp;= E[ N ] (m_2 - m_1^2) + Var[ N ] m_1 ^2. \\end{aligned}\\] Example 4.3 Show that \\(M_S(t) = M_N(\\log(M_X(t)))\\). Solution: First, consider the following conditional expectation: \\[\\begin{aligned} E\\left [e^{t S} | N = n \\right] &amp;= E\\left[e^{t (X_1 + X_2 + \\cdots X_n)}\\right] \\\\ &amp;= E\\left[e^{t X_1}\\right] \\cdot E\\left[e^{t X_2}\\right] \\cdots E\\left[e^{t X_n}\\right] \\text{, since } X_1, X_2 \\ldots, X_n \\text{ are independent} \\\\ &amp;= (M_X(t))^n.\\end{aligned}\\] Hence \\(E \\left [e^{t S} | N \\right] = (M_X(t))^N.\\) From the definition of the moment generating function, \\[\\begin{aligned} M_S(t) &amp;= E[e^{t S}] \\\\ &amp;= E \\left[ E[e^{t S} | N] \\right ] \\\\ &amp;= E \\left[ (M_X(t))^N \\right ]\\\\ &amp;= E \\left[ Exp( N \\cdot \\log (M_X(t) ) \\right] \\\\ &amp;= M_N(\\log(M_X(t))) (\\text{ since } M_X(t) = E[e^{tX}] ).\\end{aligned}\\] 4.3 Special compound distributions 4.3.1 Compound Poisson distributions Let \\(N\\) be a Poisson distribution with the parameter \\(\\lambda\\), i.e. \\(N \\sim Poisson(\\lambda)\\) and \\(\\{X_i \\}_{i=1}^\\infty\\) are independent and identically distributed with distribution function \\(F_X\\). Then \\(S = X_1 + \\ldots + X_N\\) is said to have a compound Poisson distribution and denote by \\(\\mathcal{CP}(\\lambda,F_X)\\). Note The same terminology can be defined similarly for other distributions, for e.g. if \\(N\\) has a negative binomial distribution, then \\(S\\) is said to have a compound negative binomial distribution. Example 4.4 Let \\(S \\sim \\mathcal{CP}(\\lambda,F_X)\\). Show that \\(E[S] = \\lambda m_1\\), \\(Var[S] = \\lambda m_2\\), \\(M_S(t) = Exp{(\\lambda(M_X(t) - 1))}.\\) The third central moment \\(E[(S- E[S])^3] = \\lambda m_3\\), and hence \\[Sk[S] = \\frac{\\lambda m_3}{(\\lambda m_2)^{3/2}},\\] where \\(m_k\\) be the \\(k\\)th moment of \\(X_1\\) Solution: 1. \\(E[S] = E[N] \\cdot E[X] = \\lambda m_1\\), \\(Var[S] = E[ N ] (m_2 - m_1^2) + Var[ N ] m_1 ^2 = \\lambda(m_2 - m_1^2) + \\lambda m_1^2 = \\lambda m_2\\), From \\[\\begin{aligned} M_S(t) &amp;= M_N(\\log(M_X(t))) \\\\ &amp;= Exp\\left( \\lambda \\left( e^{\\log(M_X(t))} - 1 \\right) \\right), \\text{ since } M_N(t) = Exp(\\lambda(e^t - 1)) \\\\ &amp;= Exp{(\\lambda(M_X(t) - 1))}. \\end{aligned}\\] The third central moment \\(E[(S- E[S])^3] = \\lambda m_3\\), and hence \\[Sk[S] = \\frac{\\lambda m_3}{(\\lambda m_2)^{3/2}}.\\] In particular, we have \\[\\begin{aligned} E[(N- E[N])^3] &amp;= E\\left [ N^3 - 3 N^2 \\cdot E[N] + 3 N \\cdot (E[N])^2 - (E[N])^3 \\right] \\\\ &amp;= E[N^3] - 3 E[N^2] \\cdot E[N] + 2 (E[N])^3 \\\\ &amp;= M_N&#39;&#39;&#39;(0) - 3 M_N&#39;&#39;(0) \\cdot M_N&#39;(0) + 2 (M_N&#39;(0))^3\\end{aligned}\\] For \\(N \\sim Poisson(\\lambda)\\), \\(M_N(t) = Exp(\\lambda(e^t - 1)).\\) By differentiating \\(M_N(t)\\) and evaluating at \\(t = 0\\), we can show that \\[M&#39;(0) = \\lambda, \\quad M&#39;&#39;(0) = \\lambda (1 + \\lambda), \\quad M&#39;&#39;&#39;(0) = \\lambda (1 + 3\\lambda + \\lambda^2).\\] Hence, \\(E[(N- E[N])^3] = \\lambda.\\) Similarly, \\[\\begin{aligned} E[(S- E[S])^3] &amp;= E[S^3] - 3 E[S^2] \\cdot E[S] + 2 (E[S])^3 \\\\ \\end{aligned}\\] In addition, \\(M_S(t) = Exp{(\\lambda(M_X(t) - 1))}.\\) By differentiating \\(M_S(t)\\) we can show that \\[\\begin{aligned} M&#39;&#39;&#39;_S(t) &amp;= \\lambda M&#39;&#39;&#39;_X(t) M_S(t) + 2 \\lambda M&#39;&#39;_X(t) M&#39;_S(t) + \\lambda M&#39;_X(t) M&#39;&#39;_S(t).\\\\ \\end{aligned}\\] Evaluating \\(M&#39;&#39;&#39;_S(t)\\) at \\(t = 0\\) results in \\[\\begin{aligned} M&#39;&#39;&#39;_S(0) &amp;= E[S^3] = \\lambda m_3 + 3 E[S] \\cdot E[S^2] - 2( E[S])^3,\\end{aligned}\\] which gives \\[\\begin{aligned} E[(S- E[S])^3] &amp;= E[S^3] - 3 E[S^2] \\cdot E[S] + 2 (E[S])^3 \\\\ &amp;= \\lambda m_3.\\end{aligned}\\] Example 4.5 Let \\(S\\) be the aggregate annual claims for a risk where \\(S \\sim \\mathcal{CP}(10,F_X)\\) and the individual claim amounts have a \\(Pa(4,1)\\) distribution. Calculate \\(E[S], Var[S]\\) and \\(Sk[S]\\). Solution: Since \\(X \\sim Pa(4,1)\\) with \\(\\alpha = 4\\) and \\(\\lambda = 1\\), we have \\[\\begin{aligned} E[X^r] &amp;= \\frac{\\Gamma(\\alpha - r) \\cdot \\Gamma(1 + r) \\cdot \\lambda^r }{\\Gamma(\\alpha)}\\\\ E[X] &amp;= \\frac{\\lambda}{\\alpha - 1} = \\frac{1}{4-1} = \\frac{1}{3}\\\\ E[X^2] &amp;= \\frac{\\Gamma(2) \\cdot \\Gamma(3) \\cdot \\lambda^2 }{\\Gamma(4)} = \\frac{1}{3}\\\\ E[X^3] &amp;= \\frac{\\Gamma(1) \\cdot \\Gamma(4) \\cdot \\lambda^3 }{\\Gamma(4)} = 1.\\\\ \\end{aligned}\\] We have \\[\\begin{aligned} E[S] &amp;= \\lambda E[X] = \\frac{10}{3} \\\\ Var[S] &amp;= \\lambda E[X^2] = \\frac{10}{3} \\\\ Sk[S] &amp;= \\frac{\\lambda E[X^3]}{\\left(\\lambda E[X^2]\\right)^{3/2}} = \\frac{10}{(10/3)^{3/2}} = 1.6432.\\\\ \\end{aligned}\\] In what follows, we will use R to simulate \\(n\\) observations from a compound Poisson distribution, where the Poisson parameter is \\(\\lambda\\) and where the claims are exponentially distributed with mean \\(\\mu\\), i.e.  \\(CP(\\lambda, Exp(1/\\mu))\\) # Simulation n observations from a CP(lambda,FX) distribution # Assumptions: # N ~ Poisson(lambad) # X ~ Pa(alpha,beta) library(actuar) n &lt;- 10000 lambda &lt;- 10 alpha &lt;- 4 beta &lt;- 1 totalClaims &lt;- rep(0,n) numclaims &lt;- rpois(n,lambda) for (i in 1:n) totalClaims[i] &lt;- sum(rpareto(numclaims[i], shape =alpha, scale = beta)) hist(totalClaims) mean(totalClaims) ## [1] 3.338976 var(totalClaims) ## [1] 3.29011 library(moments) skewness(totalClaims) ## [1] 1.345385 Note An important property of independent, but not necessarily identically distributed, compound Poisson random variables is that the sum of a fixed number of them is also a compound Poisson random variable. Example 4.6 Let \\(S_1, \\ldots, S_n\\) be independent compound Poisson random variables, with parameters \\(\\lambda_i\\) and \\(F_i\\). Then \\(S = \\sum_{i=1}^n S_i\\) has a compound distribution with parameter \\[\\lambda = \\sum_{i=1}^n \\lambda_i,\\] and \\[F = \\frac{1}{\\lambda}\\sum_{i=1}^n \\lambda_i F_i.\\] Solution: Exercise. Note The compound Poisson distribution is the most often used in practice. It possesses the additivity of independent compound Poisson distributions (as shown in Example 4.6, and the expressions of the first three moments are very simple. 4.3.2 Compound negative binomial distributions A useful discrete random variable that can be used for modelling the distributions of claim numbers is a negative binomial distribution. A random variable \\(N\\) has a negative distribution with parameters \\(k\\) and \\(p\\), denoted by \\(N \\sim NB(k,p)\\) if its probability mass function is given by \\[f_N(n) = \\Pr(N = n) = \\frac{\\Gamma(k+n)}{\\Gamma(n+1)\\Gamma(k)} p^k (1- p)^n \\quad n = 0,1,2,\\ldots.\\] It can be interpreted as the probability of getting \\(n\\) failures before the \\(k\\)th success occurs in a sequence of independent Bernoulli trials with probability of success \\(p\\). Example 4.7 Let \\(N \\sim NB(k,p)\\). Show that the mean, variance and moment generating function of the compound negative binomial distribution, denoted by \\(\\mathcal{CNB}(k,p,F_X)\\), are as follows: \\(E[S] = \\frac{k q}{p} m_1\\), \\(Var[S] = \\frac{k q}{p^2} (p m_2 + q m_1^2)\\), \\(M_S(t) = \\left( \\frac{ p }{ 1 - q M_X(t) } \\right)^k,\\) where \\(m_k\\) be the \\(k\\)th moment of \\(X_1\\) and \\(q = 1-p\\). Solution: The results follows from the properties of the negative binomial distribution \\(N \\sim NB(k,p)\\): \\[E[N] = \\frac{kq}{p}, \\quad Var[N] = \\frac{kq}{p^2},\\] and the moments of a compound distribution \\(S\\) derived in Section 4.2. Notes 1. The negative binomial distribution is an alternative to the Poisson distribution for \\(N\\), in the sense that it allows for any value of \\(N = 0, 1, 2, \\ldots\\), unlike the binomial distribution which has an upper limit. One advantage that the negative binomial distribution has over the Poisson distribution is that its variance exceeds its mean. These two quantities are equal for the Poisson distribution. Thus, the negative binomial distribution may give a better fit to a data set which has a sample variance in excess of the sample mean. The compound negative binomial distribution is an appropriate to model the heterogeneity of the numbers of claims occurring for different risks. In particular, suppose that for each policy, the number of claims in a year has a Poisson distribution \\(N | \\lambda \\sim Poisson(\\lambda)\\), and that the variation in \\(\\lambda\\) across the portfolio can be modelled using a Gamma distribution \\(\\mathcal{G}(\\alpha, \\lambda)\\). Then the number of claims in the year for a policy chosen at random from the portfolio has a negative binomial distribution. 4.3.2.1 Misture distributions Suppose we model a policyholder’s claim number \\(N\\) using a conditional distribution \\(N | \\lambda\\), where \\(\\lambda\\) can be thought of as a “risk parameter” for that policyholder. Policyholders represent a variety of risks and have different risk parameters, and we model the variation across policyholders by regarding the various \\(\\lambda\\)s as being independent realisations of a random variable with known probability distribution. This gives the joint density, which we can write as \\(f_{N,\\lambda}(k, \\lambda) = f_\\lambda(\\lambda) f_{N|\\lambda}(k | \\lambda)\\). This enables us to allow for variability in the risks across a portfolio; that is, to model the heterogeneity of the numbers of claims occurring for different risks. Example 4.8 A portfolio consists of a large number of individual policies. For each policy, the number of claims in a year has a poisson distribution \\(N | \\lambda \\sim Poisson(\\lambda)\\). Let us suppose that the variation in \\(\\lambda\\) across the portfolio of risks can be modelled using a gamma \\(\\mathcal{G}(\\alpha,\\beta)\\) distribution with known parameters, and let us use this to average across the risks. We are considering a mixture of Poissons where the mixing distribution if gamma. This is also known as a mixture distribution. Derive the probability mass function of the mixture distribution. Solution: For \\(k = 0,1,2,\\ldots\\), we have \\[ \\begin{aligned} \\Pr(N = k) &amp;= \\int f_\\lambda(\\lambda) \\Pr(N = k | \\lambda) \\, d\\lambda \\\\ &amp;= \\int_{0}^\\infty \\frac{\\beta^\\alpha}{\\Gamma(\\alpha)} \\lambda^{\\alpha -1} e^{\\beta \\lambda} e^{-\\lambda} \\frac{\\lambda^k}{k!} \\, d\\lambda \\\\ &amp;= \\frac{\\Gamma(\\alpha + k)}{\\Gamma(\\alpha) \\Gamma(1 + k)} \\frac{\\beta^\\alpha}{(\\beta+1)^{\\alpha+k}} \\times \\int_0^\\infty h(\\lambda) \\, d\\lambda \\end{aligned} \\] where \\(h(\\lambda)\\) is the probability density function of \\(\\lambda \\sim \\mathcal{G}(\\alpha + k, \\beta + 1)\\). Hence, \\[ \\Pr(N =k) = \\frac{\\Gamma(\\alpha + k)}{\\Gamma(\\alpha) \\Gamma(1 + k)} \\left(\\frac{\\beta}{\\beta+1}\\right)^\\alpha \\left(\\frac{1}{\\beta+1}\\right)^k, k = 0,1,2,\\ldots,\\] which is the probability mass function of a \\(\\mathcal{NB}(\\alpha, \\beta/(\\beta + 1))\\) distribution. This provides an illuminating view of the negative binomial distribution – it arises as a mixture of Poissons where the mixing distribution is gamma. 4.3.2.2 an Example in R This R Markdown introduces the concept of mixture distributions which applies to models for claim numbers. Suppose we model a policyholder’s claim numbers \\(N\\) using a conditional distribution \\(N | \\lambda\\), where \\(\\lambda\\) can be thought of as a risk parameter for that policyholder. Policyholders represent a variety of risks and have different risk parameters, and we model the variation across policyholders by regarding the various \\(\\lambda\\)s as being independent realisations of a random variable with known probability distribution. The following R code produces the required \\(n\\) simulated values from this mixture distribution, where \\(N | \\lambda \\sim Poisson(\\lambda)\\) with mixing distribution \\(\\mathcal{G}(\\alpha, \\beta)\\), i.e. \\(\\lambda \\sim \\mathcal{G}(\\alpha, \\beta)\\). eyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiJzZXQuc2VlZCg1MzUzKVxubiA8LSA1MDAwXG5hbHBoYSA8LSA0XG5iZXRhIDwtIDEvM1xubGFtYmRhIDwtIHJnYW1tYShuLCBzaGFwZSA9IGFscGhhLCByYXRlID0gYmV0YSlcbm51bWNsYWltcyA8LSBzYXBwbHkobGFtYmRhLHJwb2lzLG4gPTEpXG5oaXN0KG51bWNsYWltcylcbnByaW50KG1lYW4obnVtY2xhaW1zKSlcbnByaW50KHZhcihudW1jbGFpbXMpKVxuXG4jTWl4dHVyZSB+IG5iKGFscGhhLGJldGEvKGJldGErMSkpXG5hbHBoYU1peHR1cmUgPC0gYWxwaGFcbmJldGFNaXh0dXJlIDwtIGJldGEvKGJldGErMSlcbm1lYW5NaXh0dXJlIDwtIGFscGhhTWl4dHVyZSooMS1iZXRhTWl4dHVyZSkvYmV0YU1peHR1cmVcbnZhck1peHR1cmUgPC0gbWVhbk1peHR1cmUvYmV0YU1peHR1cmUifQ== 4.3.3 Compound binomial distributions A compound binomial distribution can be used to model a portfolio of policies, each of which can give rise to at most one claim. Example 4.9 Consider a portfolio of \\(n\\) independent and identical policies where there is at most one claim on each policy in a year (for e.g. life insurance). Let \\(p\\) be the probability that a claim occurs. Explain that the aggregate sum \\(S\\) in this portfolio has a compound binomial distribution, denoted by \\(\\mathcal{CB}(n,p,F_X)\\). Derive the mean, variance and moment generating function of \\(S\\). Solution: Since \\(n\\) policies (lives) are independent with the probability \\(p\\) that a claim occurs, the number \\(N\\) of claims on the portfolio in one year has a binomial distribution i.e. \\(N \\sim \\text{bi}(n,p)\\). If the sizes of the claims are i.i.d. random variables, independent of \\(N\\), then the total amount \\(S\\) claimed on this policy in one year has a compound binomial distribution. The mean, variance and the moment generating function of \\(S\\) are as follows: \\[\\begin{aligned} E[S] &amp;= n p m_1, \\\\ Var[S] &amp;= np m_2 - n p^2 m_1^2, \\\\ M_S(t) &amp;= \\left( q + p M_X(t) \\right)^n,\\end{aligned}\\] where \\(m_k\\) be the \\(k\\)th moment of \\(X_1\\) and \\(q = 1-p\\). 4.4 The effect of reinsurance The effect of reinsurance arrangements on an aggregate claims distribution will be presented. Let \\(S\\) denotes the total aggregate claims from a risk in a given time, \\(S_I\\) and \\(S_R\\) denote the insurance and reinsurance aggregate claims, respectively. It follows that \\[S = S_I + S_R.\\] 4.4.1 Proportional reinsurance Recall that under proportional reinsurance arrangement, a fixed proportion \\(\\alpha\\) is paid by the direct insurer and the remainder of the claim is paid by the reinsurer. It follows that \\[S_I = \\sum_{i= 1}^N \\alpha X_i = \\alpha S\\] and \\[S_R = \\sum_{i= 1}^N (1- \\alpha) X_i = (1- \\alpha) S,\\] where \\(X_i\\) is the amount of the \\(i\\)th claim. Notes Both direct insurer and the reinsurer are involved in paying each claim. Both have unlimited liability unless a cap on the claim amount is arranged. Example 4.10 Aggregate claims from a risk in a given time have a compound Poisson distribution with Poisson parameter \\(\\lambda = 10\\) and an individual claim amount distribution that is a Pareto distribution, \\(Pa(4,1)\\). The insurer has effected proportional reinsurance with proportion retained \\(\\alpha = 0.8\\). Find the distribution of \\(S_I\\) and \\(S_R\\) and their means and variances. Compare the variances \\(Var[S_I] +Var[S_R]\\) and \\(Var[S]\\). Comment on the results obtained. Solution: 1. We have \\[\\begin{aligned} S_I &amp;= \\sum_{i=1}^N \\left( \\alpha X_i \\right) = \\alpha \\sum_{i=1}^N X_i = \\alpha \\cdot S, \\\\ S_R &amp;= \\sum_{i=1}^N \\left( (1- \\alpha) X_i \\right) = (1- \\alpha) \\sum_{i=1}^N X_i = (1- \\alpha) \\cdot S,\\end{aligned}\\] since both insurer and reinsurer are involved in paying each claim, i.e. \\(Y_i = \\alpha X_i\\) and \\(Z_i = (1- \\alpha) X_i\\). It follows that \\(S_I \\sim \\mathcal{CP}(10,F_Y)\\) and \\(S_R \\sim \\mathcal{CP}(10,F_Z)\\). As we can show that if \\(X \\sim Pa(\\beta,\\lambda)\\), then \\(W = k X \\sim Pa(\\beta,k \\lambda)\\). For \\(X \\sim Pa(4,1)\\) with \\(\\beta = 4\\) and \\(\\lambda = 1\\), we have \\(Y_i \\sim Pa(\\beta, \\alpha \\cdot \\lambda) = Pa(4, 0.8)\\) and \\[\\begin{aligned} E[S_I] &amp;= 10 \\cdot E[Y_i] = 10 \\cdot \\frac{\\alpha \\cdot \\lambda}{\\beta - 1} \\\\ &amp; = \\frac{8}{3}, \\\\ Var[S_I] &amp;=10 \\cdot E[Y_i^2] = 10 \\cdot \\frac{\\Gamma(\\beta - 2) \\cdot \\Gamma(1 + 2) \\cdot (\\alpha \\cdot \\lambda)^2 }{\\Gamma(\\beta)} \\\\ &amp;= 10 \\cdot \\frac{\\Gamma(2) \\cdot \\Gamma(3) \\cdot (\\alpha \\cdot \\lambda)^2 }{\\Gamma(4)} = 10 \\cdot \\frac{2!}{3!} \\cdot (0.8)^2 \\\\ &amp;= \\frac{32}{15} \\end{aligned}\\] Alternatively, we can calculate by using the properties of the expectation and variance as follows: \\[\\begin{aligned} E[S_I] &amp;= E[\\alpha S] = \\alpha\\cdot E[S] = \\alpha\\cdot \\lambda \\cdot E[X] = 10 \\cdot 0.8 \\cdot \\frac{1}{3} = \\frac{8}{3}, \\\\ Var[S_I] &amp;= Var[\\alpha S] = \\alpha^2 \\cdot Var[S] \\\\ &amp;= \\alpha^2 \\cdot \\lambda \\cdot E[X^2] = \\frac{32}{15} .\\end{aligned}\\] Similarly, \\[\\begin{aligned} E[S_R] &amp;= E[(1 - \\alpha) S] = (1 - \\alpha)\\cdot E[S] = \\frac{2}{3}, \\\\ Var[S_R] &amp;= Var[(1 - \\alpha) S] = (1 - \\alpha)^2 \\cdot Var[S] = \\frac{2}{15} .\\end{aligned}\\] Note that \\(E[S_I] + E[S_R] = E[S]\\), while \\(Var[S_I] + Var[S_R] = \\frac{34}{15} &lt; Var[S] = \\frac{10}{3}.\\) 4.4.2 Excess of loss reinsurance Recall that under excess of loss reinsurance arrangement, the direct insurer has effected excess of loss reinsurance with retention level \\(M &gt;0\\). For a claim \\(X\\), the insurance company pays any claim in full if \\(X \\le M\\); and the reinsurer (or reinsurance company) pays the remaining amount of \\(X - M\\) if \\(X &gt; M\\). It follows that \\[\\begin{equation} \\tag{4.2} S_I = \\sum_{i= 1}^N Y_1 + Y_2 + \\ldots + Y_N = \\sum_{i= 1}^N \\min(X_i,M) \\end{equation}\\] and \\[\\begin{equation} \\tag{4.3} S_R = \\sum_{i= 1}^N Z_1 + Z_2 + \\ldots + Z_N = \\sum_{i= 1}^N \\max(0,X_i - M), \\end{equation}\\] where \\(X_i\\) is the amount of the \\(i\\)th claim. When \\(N = 0\\), we set \\(S_I = 0\\) and \\(S_R = 0\\). Note \\(S_R\\) can equal 0 even if \\(N &gt; 0\\). This occurs when all claims do not exceed \\(M\\) and hence the insurer pays the full amounts of claims. As discussed in the previous section, the reinsurer is involved only claims which exceed the retention limit (a claim such that \\(X &gt; M\\)). Such claims are called reinsurance claims. Taking in account of counting only non-zero claims, we can rewrite \\(S_R\\) as follows. Let \\(N_R\\) be the number of insurance (non-zero) claims for the reinsurer and \\(W_i\\) be the amount of the \\(i\\)th non-zero payment by the reinsurer. The aggregate claim amount paid by the reinsurer can be written as \\[S_R = \\sum_{i= 1}^{N_R} W_i.\\] Example 4.11 By using the probability generating function, show that if \\(N \\sim Poisson(\\lambda)\\), then the distribution \\(N_R \\sim Poisson(\\lambda \\pi_M)\\) where \\(\\pi_M = \\Pr(X_j &gt; M)\\). Solution: Define the indicator random variable \\(\\{I_j\\}_{j=1}^\\infty\\), where \\[\\begin{aligned} I_j = \\begin{cases} 1 &amp;\\text{if } X_j &gt; M\\\\ 0 &amp;\\text{if } X_j \\le M. \\end{cases}\\end{aligned}\\] Therefore, \\[N_R = \\sum_{j= 1}^{N} I_j.\\] The variable \\(N_R\\) has a compound distribution with its probability generating function \\[P_{N_R}(r) = P_N[P_I(r)],\\] where \\(P_I\\) is the probability generating function of the indicator random variable. It can be shown that \\[P_I(r) = 1 - \\pi_M + \\pi_M r,\\] where \\(\\pi_M = \\Pr(I_j = 1) = \\Pr(X_j &gt; M) = 1 - F(M)\\). Note In the above example, one can derive the distribution of \\(N_R\\) by using the moment generating function: \\[M_{N_R}(t) = M_N(\\log M_I(t)),\\] where \\(M_N\\) and \\(M_I\\) are the moment generating functions of \\(N\\) and \\(I\\). Note also that \\[M_I(t) = 1 - \\pi_M + \\pi_M Exp(t).\\] 4.4.3 Compound Poisson distributions under excess of loss reinsurance Assume that aggregate claim amount \\(S \\sim \\mathcal{CP}(\\lambda,F_X)\\) has a compound Poisson distribution. Under excess of loss reinsurance with retention level \\(M\\), it follows from (4.2) and (4.3) that \\(S_I \\sim \\mathcal{CP}(\\lambda,F_Y),\\) where \\(f_Y(x) = f_X(x)\\) for \\(0 &lt; x &lt; M\\) and \\(\\Pr(Y = M) = 1 - F_X(M)\\). \\(S_R \\sim \\mathcal{CP}(\\lambda,F_Z),\\) where \\(F_Z(0) = F_X(M)\\) and \\(f_Z(x) = f_X(x+M), x &gt; 0\\). Excluding zero claims, \\(S_R \\sim \\mathcal{CP}(\\lambda \\,( 1 - F_X(M)) , F_W),\\) where \\(f_W(x) = \\displaystyle{\\frac{f_X(x+M)}{1- F_X(M)}}, x &gt; 0\\). Example 4.12 Suppose that \\(S\\) has a compound Poisson distribution with Poisson parameters \\(\\lambda = 10\\) and the claim sizes have the following distribution \\(x\\) 1 2 5 10 \\(\\Pr(X = x)\\) 0.4 0.3 0.2 0.1 The insurer enters into an excess of loss reinsurance contract with retention level \\(M = 4\\). Show that \\(S_I \\sim\\mathcal{CP}(\\lambda,F_Y)\\). Show that \\(S_R \\sim\\mathcal{CP}(\\lambda,F_Z)\\). By excluding zero claims, show that the \\(S_R\\) can also be expressed as \\(S_R \\sim \\mathcal{CP}(\\lambda \\, p,F_W)\\) where \\(p = \\Pr(X &gt; M)\\). Find the mean and variance of the aggregate claim amount for both insurer and reinsurer. Solution: Recall that \\(S_I = \\sum_{i=1}^N \\min\\{X_i,4\\}.\\) The number of claim remains the same, and hence \\(N \\sim Poisson(10)\\). The distribution of claim amount paid by the insurer, \\(F_Y(x)\\) is given by \\(x\\) 1 2 4 \\(\\Pr(Y = x)\\) 0.4 0.3 0.3 Therefore, \\(S_I \\sim \\mathcal{CP}(10,F_Y)\\) and \\[\\begin{aligned} \\mathrm{E}[S_I] &amp;= 10 E[Y] = 10(1(0.4) + 2(0.3) + 4(0.3)) = 22, \\\\ \\mathrm{Var}[S_I] &amp;= 10 E[Y] = 10(1^2(0.4) + 2^2(0.3) + 4^2(0.3)) = 64. \\end{aligned}\\] We have \\(S_R = \\sum_{i=1}^N \\max\\{0, X_i - 4\\}.\\) When zero claims are included, \\(N_R = N \\sim Poisson(10)\\). The distribution of claim amount paid by the reinsurer, \\(F_Z(x)\\) is given by \\(x\\) 0 1 6 \\(\\Pr(Z = x)\\) 0.7 0.2 0.1 Therefore, \\(S_R \\sim \\mathcal{CP}(10,F_Z)\\) and \\[\\begin{aligned} \\mathrm{E}[S_R] &amp;= 10 E[Z] = 8, \\\\ \\mathrm{Var}[S_R] &amp;= 10 E[Z^2] = 38. \\end{aligned}\\] Notes \\(\\mathrm{E}[S] = 10 \\mathrm{E}[X] = 30\\) and \\(\\mathrm{Var}[S]= 10 \\mathrm{E}[X^2] = 166.\\) \\(\\mathrm{E}[S_I + S_R] = \\mathrm{E}[S]\\), and \\[\\mathrm{Var}[S_I + S_R] = 64 + 38 &lt; 166 = \\mathrm{Var}[S].\\] Consider the reinsurer’s position when zero claims are excluded. We define \\[ W = Z | Z &gt;0 = X - 4 | X &gt; 4.\\] We first compute \\(\\pi_M\\), the proportion of claims which involve the reinsurer, from \\[ \\pi_M = \\mathrm{Pr}(X&gt;4) = \\mathrm{Pr}(X = 5) + \\mathrm{Pr}(X = 10) = 0.3.\\] Recall that \\(S_R = \\sum_{i=1}^{N_R} W_i.\\) We have \\(S_R \\sim \\mathcal{CP}(0.3 \\times 10, F_W)\\) and the distribution of \\(W, F_W(x)\\) is given by \\[ \\begin{aligned} \\mathrm{Pr}(W = 1) &amp;= \\mathrm{Pr}(X = 5 | X &gt; 4) = \\frac{ \\mathrm{Pr}(X = 5 , X &gt; 4) }{\\mathrm{Pr}(X &gt; 4)} = \\frac{ \\mathrm{Pr}(X = 5) }{\\mathrm{Pr}(X &gt; 4)} = \\frac{2}{3} \\\\ \\mathrm{Pr}(W = 6) &amp;= 1- \\mathrm{Pr}(W = 1) = \\frac{1}{3}. \\end{aligned} \\] Hence, \\[ \\begin{aligned} \\mathrm{E}[S_R] &amp;= (10 \\times 0.3)(1(2/3) + 6(1/3)) = 8, \\\\ \\mathrm{Var}[S_R] &amp;= (10 \\times 0.3)(1^2(2/3) + 6^2(1/3)) = 38. \\end{aligned} \\] Example 4.13 Suppose that \\(S\\) has a compound Poisson distribution with Poisson parameters \\(\\lambda = 40\\) and the claim sizes have a Pareto distribution \\(Pa(3,4)\\). The insurer has an excess of loss reinsurance contract in place with retention level \\(M = 2\\). Find the mean and variance of the aggregate claim amount for both insurer and reinsurer. Solution: 1. Zero claims included. Recall that that for \\(X \\sim \\mathcal{Pa}(\\alpha,\\lambda)\\), its density function is \\[ f_X(x) = \\frac{\\alpha \\lambda^\\alpha}{ (x + \\lambda)^{\\alpha + 1}}.\\] We know that \\(S_R \\sim \\mathcal{CP}(40,F_Z)\\). Moreover, \\[ \\begin{aligned} \\mathrm{E}[Z] &amp;= 0 F_Z(0) + \\int_0^\\infty x f_Z(x)\\, dx \\\\ &amp;= \\int_0^\\infty x f_X(x + M)\\, dx \\\\ &amp;= \\int_0^\\infty \\frac{x \\cdot 3 \\cdot 4^3}{(x + 2 + 4)^{3+1}} \\, dx\\\\ &amp;= \\frac{4^3}{6^3} \\int_0^\\infty \\frac{x \\cdot 3 \\cdot 6^3}{(x + 6)^{3+1}} \\, dx \\\\ &amp;= \\frac{4^3}{6^3} \\frac{6}{3-1} = 0.88\\ldots .\\\\ \\end{aligned} \\] Note that the last integral above is the mean of \\(\\mathcal{Pa}(3,6)\\), which is equal to \\(6/(3-1)\\). For \\(\\mathrm{E}[Z^2]\\), we proceed as follows: \\[ \\begin{aligned} \\mathrm{E}[Z^2] &amp;= 0^2 F_Z(0) + \\int_0^\\infty x^2 f_Z(x)\\, dx \\\\ &amp;= \\int_0^\\infty x^2 f_X(x + M)\\, dx \\\\ &amp;= \\int_0^\\infty \\frac{x^2 \\cdot 3 \\cdot 4^3}{(x + 2 + 4)^{3+1}} \\, dx\\\\ &amp;= \\frac{4^3}{6^3} \\int_0^\\infty \\frac{x^2 \\cdot 3 \\cdot 6^3}{(x + 6)^{3+1}} \\, dx \\\\ &amp;= \\frac{4^3}{6^3} 6^2 = 10.66\\ldots .\\\\ \\end{aligned} \\] Note that the last integral above is the second moment about the origin of \\(\\mathcal{Pa}(3,6)\\), which is equal to \\([6^2 \\cdot\\Gamma(3-2)\\Gamma(1+2)] /\\Gamma(3) = 6^2\\). Therefore, \\[\\begin{aligned} \\mathrm{E}[S_R] &amp;= \\lambda E[Z] = 320/9, \\\\ \\mathrm{Var}[S_R] &amp;= \\lambda E[Z^2] = 1280/3. \\end{aligned}\\] Zero claims excluded We define \\[ W = Z | Z &gt;0 = X - M | X &gt; M.\\] \\[ \\begin{aligned} \\mathrm{E}[W] &amp;= \\int_0^\\infty x f_W(x)\\, dx \\\\ &amp;= \\int_0^\\infty \\frac{x f_X(x + 2)}{(1 - F_X(2))} \\, dx \\\\ &amp;= \\frac{1}{(1 - F_X(2))} \\int_0^\\infty x f_X(x + 2) \\, dx \\\\ &amp;= \\frac{1}{(1 - F_X(2))}\\cdot \\mathrm{E}[Z]. \\end{aligned} \\] It follows that \\[ \\mathrm{E}[S_R] = \\lambda\\cdot \\mathrm{Pr}(X &gt; M) \\cdot \\mathrm{E}[W] = 40 ( 1 - F_X(2)) \\mathrm{E}[W] = 40\\mathrm{E}[Z] = 320/9.\\] Similarly, one can show that \\[ \\begin{aligned} \\mathrm{E}[W^2] &amp;= \\int_0^\\infty x^2 f_W(x)\\, dx \\\\ &amp;= \\frac{1}{(1 - F_X(2))}\\cdot \\mathrm{E}[Z^2]. \\end{aligned} \\] This results in \\[\\mathrm{Var}[S_R] = \\lambda \\cdot \\mathrm{Pr}(X &gt; M) \\cdot \\mathrm{E}[W^2] = 40 ( 1 - F_X(2)) \\mathrm{E}[W^2] = 40\\mathrm{E}[Z^2] = 1280/3.\\] Note that \\(S = S_I + S_R\\) and \\[ \\mathrm{E}[S] = \\lambda \\mathrm{E}[X] = 40 \\frac{4}{3-1} = 80. \\] Therefore, \\[ \\mathrm{E}[S_I] = 80 - \\frac{320}{9} = \\frac{400}{9}. \\] 4.5 Approximation of the collective risk model 4.5.1 The normal approximation According to the Central Limit Theorem, if the mean number of claims is large, then the distribution of aggregate claims \\(S\\) can be approximated by a normal distribution, i.e. \\(S \\sim \\mathcal{N}(\\mathrm{E}[S], \\mathrm{Var}[S])\\). Notes The normal approximation may not provide a good approximation to the distribution of \\(S\\) because the true distribution of \\(S\\) is skew. However, the normal approximation is symmetric. The normal approximation is likely to underestimate tail probabilities which are the most interest quantities of insurers. Example 4.14 Aggregate claims from a risk in a given time have a compound Poisson distribution with Poisson parameter \\(\\lambda\\) and an individual claim amount distribution that is a lognormal distribution with mean 1 and variance 2.5. Approximate the distribution of \\(S\\) using the normal distribution when (a) \\(\\lambda = 10\\) and (b) \\(\\lambda = 100\\). Find \\(x\\) such that \\(\\Pr(S \\le x) = 0.95\\) in both cases. Comment on the obtained results. 4.5.2 The translated gamma approximation The translated gamma approximation makes use of the first three moments of \\(S\\) and provides an improvement of the approximation over the normal approximation. We assume that \\(S\\) can be approximated by \\(Y + k\\) where \\(Y \\sim \\mathcal{G}(\\alpha, \\lambda)\\) and \\(k\\) is a constant. This distribution \\(Y + k\\) is said to have a translated gamma distribution. By matching the moments of the two distribution, the parameters \\(\\alpha, \\lambda\\) and \\(k\\) can be found from \\[\\begin{aligned} Sk[S] &amp;= \\frac{2}{\\sqrt{\\alpha}}, \\\\ Var[S] &amp;= \\frac{\\alpha}{\\lambda^2},\\\\ E[S] &amp;= \\frac{\\alpha}{\\lambda} + k.\\end{aligned}\\] Example 4.15 Show that the parameters \\(\\alpha, \\lambda\\) and \\(k\\) satisfy \\[\\begin{aligned} \\alpha &amp;= \\frac{4}{Sk[S]^2}, \\\\ \\lambda &amp;= \\sqrt{\\frac{\\alpha}{Var[S]}} \\\\ k &amp;= E[S] - \\frac{\\alpha}{\\lambda}.\\end{aligned}\\] Example 4.16 The aggregate claims \\(S\\) have the compound Poisson distribution as given in Example 4.14. Use the translated gamma approximation to find \\(x\\) such that \\(\\Pr(S \\le x) = 0.95\\) when (a) \\(\\lambda = 10\\) and (b) \\(\\lambda = 100\\). Comment on the obtained results. 4.6 Recursive calculation of the collective risk model The Panjer recursion formula provides recursive calculation of the collective risk model. The algorithm can be numerically computed on a computer provided that distribution of claim numbers \\(N\\) satisfy Panjer’s recursion formula, \\[p_n = \\left( a + \\frac{b}{n} \\right) p_{n-1}, \\quad n = 1,2, \\ldots,\\] where \\(a\\) and \\(b\\) are constants. Example 4.17 Show that a Poisson distribution \\(N \\sim Poisson(\\lambda)\\) satisfies Panjer’s recursion formula, i.e. find the constants \\(a\\) and \\(b\\). Assume that the claim size variable \\(X\\) takes only positive integers and the distribution of claim numbers satisfies the Panjer’s recursion formula. We define \\(f_k = \\Pr(X = k), \\quad k = 1,2, \\ldots,\\) \\(g_r = \\Pr(S = r), \\quad r = 0,1,2, \\ldots.\\) Then the unknown \\(g_r\\) can be recursively calculated by \\(g_0 = p_0\\), \\(g_r = \\sum_{j=1}^r \\left( a + \\frac{bj}{r} \\right) f_j g_{r-j}, \\quad r = 1,2 \\ldots.\\) Note If \\(X\\) is not a discrete random variable, then we first approximate it by a discrete distribution and then apply the Panjer’s recursion algorithm. Example 4.18 Aggregate claims \\(S\\) have a compound Poisson distribution \\(\\mathcal{CP}(\\lambda,F_X)\\) where \\(\\lambda = 1\\) and an individual claim amount \\(X\\) is either 1 or 2 with probability 3/4 and 1/4, respectively. Calculate \\(g_r\\) for \\(r = 0,1,2,3,4,5\\). 4.7 Premium calculation In this section, rules for setting premium to be charged to cover a risk \\(S\\) (aggregate claims) are presented. The expected (mean) risk \\(E[S]\\) is referred to as the pure premium. In practice, the premium must be set to cover the expected risk, i.e. \\(P &gt; E[S]\\). Some premium calculation rules are as follows: The expected value principle (EVP) The premium is given by a simple formula: \\[P = E[S] + \\theta\\, E[S] = ( 1 + \\theta)E[S],\\] for some \\(\\theta &gt; 0\\), which is called the relative security loading on the pure premium \\(E[S]\\). The premium is increased by a percentage of the mean of the risk. The standard deviation principle (SVP) The premium is increased by a percentage of the standard deviation of the risk. \\[P = E[S] + \\theta\\, \\text{SD}[S].\\] The variance principle (VP) The premium is increased by a percentage of the variance of the risk. \\[P = E[S] + \\theta\\, Var[S].\\] Example 4.19 Suppose that \\(S\\) has a compound Poisson distribution with Poisson parameters \\(\\lambda = 10\\) and the claim sizes have a Pareto distribution \\(Pa(4,3)\\). Use the normal approximation and the translated gamma approximation to calculate the relative security loading such that the probability of a profit in the year is 0.95. Repeat the same question as above assumed that the SVP is applied. Solution: The loss distribution has Pareto distribution \\(X \\sim Pa(4,3)\\). Therefore, \\(\\mathrm{E}[X] = 1\\) and \\(\\mathrm{E}[X^2] = 3\\). The mean and variance of the aggregate claim amounts are \\(\\mathrm{E}[S] = \\lambda \\mathrm{E}[X] = 10\\) and \\(\\mathrm{Var}[S] = \\lambda \\mathrm{E}[X^2] = 30\\). Use the normal approximation \\(S \\sim \\mathcal{N}(10, 30)\\). Let \\(P\\) denote the premium charged. We need to find the security loading \\(\\theta\\) such that \\[\\Pr( P - S &gt; 0) = 0.95.\\] Assume that the premium charged to cover the risk follows the expected value principle (EVP). So we set \\[P = E[S] + \\theta\\, E[S] = ( 1 + \\theta)E[S] = ( 1 + \\theta)(10).\\] \\[\\begin{align} 0.95 &amp;= \\Pr( P - S &gt; 0) \\\\ &amp;= \\Pr( ( 1 + \\theta)(10) - S &gt; 0) \\\\ &amp;= \\Pr( S &lt; ( 1 + \\theta)(10) ) \\\\ &amp;= \\Pr( Z &lt; \\frac{( 1 + \\theta)(10) - 10 }{\\sqrt{30}} ) \\\\ &amp;= \\Pr( Z &lt; \\frac{( \\theta)(10) }{\\sqrt{30}} ). \\end{align}\\] This gives \\(\\frac{( \\theta)(10) }{\\sqrt{30}} = 1.6448536\\) and \\[\\theta = 0.9009234, \\quad P = 19.009.\\] Instead of using the normal approximation to aggregate claims \\(S\\), we now assume that \\(S\\) is approximated by \\(Y + k\\) where \\(Y \\sim \\mathcal{G}(1.4814815, 0.2222222)\\) and \\(k = 3.3333333\\) is a constant. It follows that \\[\\begin{align} 0.95 &amp;= \\Pr( P - S &gt; 0) \\\\ &amp;= \\Pr( ( 1 + \\theta)(10) - S &gt; 0) \\\\ &amp;= \\Pr( S &lt; ( 1 + \\theta)(10) ) \\\\ &amp;= \\Pr( Y &lt; ( 1 + \\theta)(10) - 3.3333333 ) \\\\ \\end{align}\\] Therefore, \\((1 + \\theta)\\)(10) - 3.3333333 = qgamma(0.95,shape = 1.481481, rate = 0.222222) = 17.43845, which results in \\[\\theta = 1.0771784, \\quad P = 20.772.\\] Using the standard deviation principle (SVP), we set \\[P = E[S] + \\theta\\, \\text{SD}[S] = 10 + \\theta \\cdot \\sqrt{30}\\] For the normal approximation of the aggregate claims, we obtain \\[\\begin{align} 0.95 &amp;= \\Pr( P - S &gt; 0) \\\\ &amp;= \\Pr( 10 + \\theta \\cdot \\sqrt{30} - S &gt; 0) \\\\ &amp;= \\Pr( S &lt; 10 + \\theta \\cdot \\sqrt{30} ) \\\\ &amp;= \\Pr( Z &lt; \\frac{10 + \\theta \\cdot \\sqrt{30} - 10 }{\\sqrt{30}} ) \\\\ &amp;= \\Pr( Z &lt; \\theta). \\end{align}\\] Hence, \\(\\theta = 1.644854\\) and \\(P = 19.009\\). Comment The loading factors (for normal approximation) in both two cases are different because they are applied to different quantities (i.e. \\(\\mathrm{E}[S]\\) and \\(\\mathrm{Var}[S]\\)). But they give the same premium. "],["ruin-theory.html", "Chapter 5 Ruin Theory 5.1 The classical risk process 5.2 Simulation of ruin probabilities", " Chapter 5 Ruin Theory 5.1 The classical risk process Short term risk models for a fixed time period have been studied in the previous sections. In this section, risk models that evolve over time will be presented. Suppose that an insurer begins with an initial capital \\(u\\), called an initial surplus, collects premiums at a constant rate \\(c\\) per unit time, and pays claims when losses occur. The insurer is in ruin if the insurer’s capital becomes negative at some point in time, i.e. the insurer’s surplus falls to zero or below. Note A surplus is an excess of income or assets over expenditure or liabilities in a given period, typically a financial year: Example 5.1 An insurer has initial surplus \\(u\\) of 1 (in suitable units) and receives premium payments at a rate of 1 per year. Suppose claims from a portfolio of insurance over the first two years are as follows: Time (years) 0.4 0.9 1.5 Amount 0.8 0.7 1.2 Plot a surplus process and determine whether ruin occurs within the first three years. Solution: The insurer’s surplus (or cash flow) at any future time \\(t\\) (&gt; 0) is a random variable, since its value depends on the claims experience up to time \\(t\\). The insurer’s surplus at time \\(t\\) is a random variable. The insurer’s surplus at time \\(t\\) is denoted \\(U(t)\\). The following formula for \\(U(t)\\) can be written as \\[\\begin{equation} U(t) = u + ct - S(t), \\end{equation}\\] where the aggregate claim amount up to time \\(t\\), \\(S(t)\\) is \\[\\begin{equation} S(t) = \\sum_{i = 1}^{N(t)} X_i . \\end{equation}\\] The following table summarises the values of the surplus function at the time when claims occurs. Time Surplus (before claim) Surplus (after claim) 0 1 1 0.4 1.4 0.6 0.9 1.1 0.4 1.5 1 -0.2 The surplus function increases at a constant rate \\(c\\) until there is a claim and the surplus drops by the amount of the claim. The surplus then increases again at the same rate \\(c\\) and drops are repeated when claims occur. In this example, ruin occurs at time 1.5. The plot of the surplus process is given in the following figure. Figure 5.1: The surplus process befor reinsurance arrangment. Example 5.2 As given in Example 5.1, suppose that the insurer has effected proportional reinsurance with retained proportion of 0.7. The reinsurance premium is 0.4 per year to be paid continuously. Plot a surplus process and determine whether ruin occurs within the first three years. Comment on the results. Solution: The insurer’s net premium income is 0.6 per year. The insurer’s cash flow or surplus process is now given by \\[\\begin{equation} U_I(t) = u + (c - c_r)t - \\alpha \\cdot S(t), \\end{equation}\\] where \\(c_r\\) is the reinsurance premium rate and \\(\\alpha\\) is the retained proportion. The following table summarises the values of the surplus function at the time when claims occurs. Time Surplus (before claim) Surplus (after claim) 0 1 1 0.4 1.24 0.68 0.9 0.98 0.49 1.5 0.85 0.01 Figure 5.2: The surplus process under a proportional reinsurance arrangement. It should be emphasised that under this proportional reinsurance arrangement, ruin does not occur within 2 years. 5.1.1 Classical risk process The following assumptions are assumed for the study of the evolution of insurer’s surplus over time. The insurer’s initial capital is \\(u\\). The premium rate per unit of time received continuously is \\(c\\), i.e. the total amount of premiums received by time \\(t\\) is \\(ct\\). The counting process \\(\\{N(t) \\}_{t \\ge 0}\\) for the number of claims occurred in the time interval \\([0,t]\\) is a Poisson process with parameter \\(\\lambda\\). The claim sizes (or individual claim amounts) \\(X_1, X_2, \\ldots\\) are independent and identically distributed random variables. The claim sizes \\(X_1, X_2, \\ldots\\) are independent of the counting process \\(N(t)\\). The surplus process \\(\\{U(t) \\}_{t \\ge 0}\\) is then given by \\[\\begin{equation} \\tag{5.1} U(t) = u + ct - S(t), \\end{equation}\\] where the aggregate claim amount up to time \\(t\\), \\(S(t)\\) is \\[\\begin{equation} \\tag{5.2} S(t) = \\sum_{i = 1}^{N(t)} X_i . \\end{equation}\\] The evolution of insurer’s surplus defined in (5.1) is also known as the classical risk process. The only random and uncertain quantity in (5.1) is the aggregate claims \\(S(t)\\). Notes The classical risk model contains many simplification. The claim-arrival rate \\(\\lambda\\) remains constant over time. No interest is pain on the surplus. There is no inflation. The premium income is received continuously in time. Claims are paid out immediately. there are assumptions of independence. 5.1.2 Poisson processes A Poisson process is a special type of counting process. It can be represented by a continuous time stochastic process \\(\\{N(t)\\}_{t \\ge 0}\\) which takes values in the non-negative integers. It can be used to model the occurrence or arrival of events over a continuous time interval. The state space is discrete but the time set is continuous. Here \\(N(t)\\) represents the number of events in the interval \\((0,t]\\). The following examples can also be modelled by a Poisson process: Claims arrivals at an insurance company, Accidents occurring on the highway, and Telephone calls to a call centre. Counting Process A counting process \\(\\{N_t \\}_{t \\ge 0}\\) is a collection of non-negative, integer-valued random variables such that if \\(0 \\le s \\le t\\), then \\(N(s) \\le N(t)\\). The following figure illustrates a trajectory of the Poisson process. The sample path of a Poisson process is a right-continuous step function. There are jumps occurring at time \\(t_1, t_2, t_3, \\ldots\\). lambda &lt;- 17 # the length of time horizon for the simulation T_length &lt;- 31 last_arrival &lt;- 0 arrival_time &lt;- c() inter_arrival &lt;- rexp(1, rate = lambda) T_length &lt;- 1 while (inter_arrival + last_arrival &lt; T_length) { last_arrival &lt;- inter_arrival + last_arrival arrival_time &lt;- c(arrival_time,last_arrival) inter_arrival &lt;- rexp(1, rate = lambda) } n &lt;- length(arrival_time) counts &lt;- 1:n plot(arrival_time, counts, pch=16, ylim=c(0, n)) points(arrival_time, c(0, counts[-n])) segments( x0 = c(0, arrival_time[-n]), y0 = c(0, counts[-n]), x1 = arrival_time, y1 = c(0, counts[-n]) ) Recall that a stochastic process \\(\\{N(t) \\}_{t \\ge 0}\\) is a Poisson process with parameter \\(\\lambda\\) if the process satisfies the three properties: \\(N(0) = 0\\). Independent increments For \\(0 &lt; s &lt; t \\le u &lt; v\\), the increment \\(N(t) - N(s)\\) is independent of the increment \\(N(v) - N(u)\\), i.e. the number of events in \\((s,t]\\) is independent of the number of events in \\((u,v]\\). Stationary increments For \\(0 &lt; s &lt;t\\), the distribution \\(N(t) - N(s)\\) depends only on \\(t -s\\) and not on the values \\(s\\) and \\(t\\), i.e. the increments of the process over time has a distribution that only depend on the time difference \\(t - s\\), the lenght of the time interval. Poisson distribution For \\(t \\ge 0\\), the random variable \\(N(t)\\) has a Poisson distribution with mean \\(\\lambda t\\). It follows from conditions the Stationary Increments and Poisson Distribution properties that \\[\\Pr(N(t) - N(s) = n) = \\Pr(N(t-s) - N(0) = n) = \\frac{ ( \\lambda(t-s))^n e^{-\\lambda(t-s)} }{n!}, \\quad \\quad s &lt; t, \\, n = 0,1,2, \\ldots\\] Notes The sample paths of \\(\\{N(t) \\}_{t \\ge 0}\\) are non-decreasing step functions, or the process is referred to be as a counting process. A process with stationary and independent increments can be thought of as starting over at any point in time in a probabilistic sense. The ‘starting over’ property follows from the fact that the exponential distribution has the memoryless property, and the times between successive events (or interarrival times) are independent and identically distributed exponential random variables with mean \\(1/\\lambda\\). For more details about Poisson processes, please refer to the contents of the course “SCMA 469 Actuarial Statistics” 5.1.3 Compound Poisson processes The aggregate claims process \\(S(t)\\) defined in (5.2) of the classical risk process is said to be a compound Poisson process with Poisson parameter \\(\\lambda\\). The compound Poisson process has the following important properties: For each \\(t\\), the random variable \\(S(t)\\) has a compound Poisson distribution with parameter \\(\\lambda t\\), i.e. \\[S(t) \\sim \\mathcal{CP}(\\lambda t, F_X(x)).\\] Thus, the mean and variance of the compound Poisson distribution are \\[\\mathrm{E}[S(t)] = \\lambda t \\mathrm{E}[X], \\quad \\mathrm{Var}[S(t)] =\\lambda t \\mathrm{E}[X^2].\\] The moment generating function of \\(S(t)\\) is \\[M_{S(t)}(r) = \\exp(\\lambda t(M_X(r) - 1)).\\] It has stationary and independent increments, i.e. for disjoint time intervals \\(0 &lt; s &lt; t \\le u &lt; v\\), the random variables \\(N(t) - N(s)\\) and \\(N(v) - N(u)\\) are independent and \\(N(t) - N(s)\\) depends only on \\(t -s\\) and not on the values \\(s\\) and \\(t\\). Hence, the random variables \\(S(t) - S(s)\\) and \\(S(v) - S(u)\\) are independent and have \\(\\mathcal{CP}(\\lambda (t -s), F_X(x))\\) and \\(\\mathcal{CP}(\\lambda (v - u), F_X(x))\\) distributions, respectively. Notes Various properties of the aggregate claims process \\(S(t)\\) can be summarised as follows: \\(S(1) \\sim \\mathcal{CP}(\\lambda, F_X(x))\\) is the aggregate claims in the first year. \\(S(n) - S(n-1) \\sim \\mathcal{CP}(\\lambda, F_X(x))\\) is the aggregate claims in the \\(n\\)th year, for \\(n = 1,2, \\ldots\\). The process \\(\\{ S(n) - S(n-1) \\}_{n=1}^\\infty\\) is a sequence of independent and identically distributed random variables representing the aggregate claims in successive years. 5.1.4 The relative safety loading According to the expected value principle, the premium rate \\(c\\) per unit time is defined by \\[c = (1 + \\theta) \\mathrm{E}[S(1)] = (1 + \\theta) \\lambda \\mu_X.\\] Hence the relative safety loading (or premium loading factor or relative security loading) \\(\\theta\\) is given by \\[\\theta = \\frac{c - \\lambda \\mu_X}{\\lambda \\mu_X}.\\] In addition, the insurer should load the premium for profit so that \\(c &gt; \\lambda \\mu_X\\). This finding follows from the following example. Let \\(\\mu_X\\) and \\(\\sigma^2_X\\) denote the mean and the variance of claim sizes \\(X_i\\) (in one period). Example 5.3 Consider the following questions. Calculate the expected surplus and the variance surplus at time \\(t\\). Calculate the expected profit per unit time in \\((0, t]\\). Solution: From \\(U(t) = u + ct - S(t),\\) the expected surplus at time \\(t\\) is \\[\\begin{align} \\mathrm{E}[U(t)] &amp;= u + ct - \\mathrm{E}[S(t)] \\\\ &amp;= u + ct - (\\lambda t)\\mathrm{E}[X] \\\\ &amp;= u + ct - (\\lambda t)\\mu_X \\\\ &amp;= u + (c - \\lambda \\mu_X)\\cdot t, \\end{align}\\] and \\[ \\mathrm{Var}[U(t)] = \\mathrm{Var}[S(t)] = (\\lambda t)\\mathrm{E}[X^2].\\] The expected profit per unit time in \\((0, t]\\) can be calculated from \\[\\frac{\\mathrm{E}[U(t) - U(0)]}{t} = c - \\lambda \\mu_X.\\] This motivates the net profit condition: \\[c &gt; \\lambda \\mu_X. \\] Given \\(\\lambda\\) and \\(\\mu_X\\), we aim to set the premium rate \\(c\\) that satisfies the net profit condition. Notes The insurer can make a profit provided that \\(c &gt; \\lambda \\mu_X\\) or the relative safety loading \\(\\theta\\) is positive. In this case, the surplus will drift to \\(\\infty\\), but ruin could still occur. The rate at which premium income comes in is greater than the rate at which claims are paid out. On the other hand, if \\(c &lt; \\lambda \\mu_X\\), then the surplus will drift to \\(-\\infty\\), but ruin is certain. If \\(c = \\lambda \\mu_X\\), the surplus will drift to \\(\\infty\\) and \\(-\\infty\\), but ruin is certain (eventually). 5.1.5 Ruin probabilities Various definitions of ruin probabilities are given. The probability of ruin in infinite time (or the ultimate ruin probability) is defined by \\[\\psi(u) = \\Pr(U(t) &lt; 0 \\quad \\text{ for some } t &gt; 0).\\] The finite-time ruin probability (or the probability of ruin by time \\(t\\)) is defined by \\[\\psi(u,t) = \\Pr(U(s) &lt; 0 \\quad \\text{ for some } s \\in (0,t]).\\] The discrete time ultimate ruin probability is defined by \\[\\psi_h(u) = \\Pr(U(t) &lt; 0 \\quad \\text{ for some } t \\in \\{h, 2h, 3h, \\ldots \\}).\\] The discrete time ruin probability in finite time is defined by \\[\\psi_h(u,t) = \\Pr(U(s) &lt; 0 \\quad \\text{ for some } s \\in \\{h, 2h, 3h, \\ldots, t\\}).\\] Notes For \\(0 \\le u_1 \\le u_2\\), \\[\\psi(u_1) \\ge \\psi(u_2),\\] and \\[\\psi(u_1,t) \\ge \\psi(u_2,t),\\] i.e. the ultimate ruin probability and finite-time ruin probability are non-increasing in \\(u\\). Intuitively, the larger the initial surplus, the less likely it is that ruin will occur either in a finite time period or an unlimited time period. If ruin occurs under the discrete time, it must occur under the continuous time, i.e. \\[\\psi_h(u) &lt; \\psi(u).\\] Similarly, \\[\\psi_h(u,t) &lt; \\psi(u,t).\\] For a given initial surplus \\(u\\) and \\(0 &lt; t_1 &lt; t_2\\), \\[\\psi(u,t_1) &lt; \\psi(u,t_2).\\] Intuitively, the longer the period considered when checking for ruin, the more likely it is that ruin will occur. The discrete time ultimate ruin probability \\(\\psi_h(u)\\) could be used as an approximation of \\(\\psi(u)\\) provided \\(h\\) is sufficiently small. The discrete time ruin probability in finite time \\(\\psi_h(u,t)\\) could be used as an approximation of \\(\\psi(u,t)\\) provided \\(h\\) is sufficiently small. Example 5.4 Suppose the annual aggregate claims for a portfolio of policies is approximately normal. The insurer’s initial surplus is 1000 (in suitable units) and the premium rate is 1500 per year. The number of claims per year has a Poisson distribution with parameter 50. The distribution of claim sizes is lognormal with parameters \\(\\mu = 3\\) and \\(\\sigma^2 = 0.9\\). Calculate the probability that the insurer’s surplus at time 2 will be negative. Solution: Using the normal approximation, the total claims \\(S\\) can be approximated by \\(S \\sim \\mathcal{N}(\\mathrm{E}[S], \\mathrm{Var}[S])\\). We have \\[\\begin{align} \\mathrm{E}[X] &amp;= e^{\\mu + \\sigma^2/2} = 31.500392 \\\\ \\mathrm{E}[X^2] &amp;= e^{2\\mu + 2\\sigma^2} = 2440.601978. \\end{align}\\] Therefore, \\[\\begin{align} \\mathrm{E}[S(2)] &amp;= 2(50)\\mathrm{E}[X] = 3150.039231 \\\\ \\mathrm{Var}[S(2)] &amp;= 2(50)\\mathrm{E}[X2] = 2.440602\\times 10^{5} . \\end{align}\\] Hence, ruin will occur if \\(S(2)\\) is greater than the initial surplus plus premiums received. Therefore, the probability of ruin is \\[\\begin{align} \\Pr(S(2) &gt; u + 2c) &amp;= \\Pr(S(2) &gt; 1000 + 2(1500)) \\\\ &amp;= \\Pr(Z &gt; \\frac{1000 + 2(1500) - 3150.0392309}{\\sqrt{2.440602\\times 10^{5}}}) \\\\ &amp;= \\Pr(Z &gt; 1.720483) = 0.04267. \\end{align}\\] the probability of ruin is approximately 4.267%. 5.2 Simulation of ruin probabilities In this section, we will use simulation to numerically estimate the probability of ruin. First, we introduce the inverse transform method, which is a method for generating random numbers from any probability distribution by using its inverse cumulative distribution. Example 5.5 Let \\(F(x)\\) be a continuous cumulative density function. Let \\(Y\\) be a random variable with a \\(U(0,1)\\) distribution. Define the random variable \\(X\\) by \\[X = F^{-1}(Y).\\] Show that the cumulative density function of \\(X\\), \\(F_X(x)\\) is \\(F(x)\\). Solution: We need to show that \\(Pr(X \\le x) = F(x)\\) for all \\(x\\), i.e. \\(F_X(x)= F(x)\\) as defined above. It follows from the monotonicity of \\(F\\) and the definition \\[\\begin{align} F_X(x) &amp;= \\Pr(X \\le x)\\\\ &amp;= \\Pr(F^{-1}(Y) \\le x)\\\\ &amp;= \\Pr(F(F^{-1}(Y)) \\le F(x)\\\\ &amp;= \\Pr(Y \\le F(x))\\\\ \\end{align}\\] Since \\(Y \\sim U(0,1)\\), we have \\(\\Pr(Y \\le t) = t\\) for any \\(t \\in [0,1]\\). Therefore, \\[ F_X(x) = \\Pr(Y \\le F(x)) = F(x).\\] Note We can use this result to generate values from the required probability distribution (which will be useful in Excel). In order to generate \\(X_1, X_2, X_3, \\ldots, X_n\\) from \\(\\mathcal{G}(\\alpha,\\lambda)\\) (or any other distributions) in Excel, we use GAMMAINV(RAND(), alpha, 1/lambda). However, in R, we can simply use rgamma(n, alpha, lambda) to generate \\(n\\) random numbers from the \\(\\mathcal{G}(\\alpha,\\lambda)\\) distribution. Example 5.6 The aggregate claims process for a risk is compound Poisson with Poisson parameter \\(\\lambda = 100\\) per year. Individual claim amounts have \\(\\text{Pa}(4,3)\\). The premium income per year is \\(c = 110\\) (in suitable units), received continuously. Using either Excel or R to simulate 1000 values of aggregate claims \\(S\\), assuming that \\(S\\) is approximated by a translated gamma approximation, Estimate \\(\\hat{\\psi}_1(50, 5)\\), an estimate of \\(\\psi_1(50,5)\\). Estimate the standard error of \\(\\hat{\\psi}_1(50, 5)\\). Calculate a 95% confidence interval for your estimate in 1. Estimate \\(\\psi_{0.5}(50, 5)\\). Solution: An estimate of \\(\\psi_1(u,5)\\) with \\(u = 50\\) and \\(c =110\\) can be obtained as follows: From the properties of \\(S(t)\\), The aggregate claims in the first year have \\(S(1) \\sim \\mathcal{CP}(\\lambda, F_X(x))\\) distribution with \\(\\lambda = 100\\) and \\(X \\sim \\text{Pa}(4,3)\\) The aggregate claims in the \\(j\\)th year, for \\(j = 1,2, \\ldots, 5\\) have \\(S(j) - S(j-1) \\sim \\mathcal{CP}(\\lambda, F_X(x))\\) distribution. It follows that \\[\\begin{align} \\psi_1(u,5) &amp;= \\Pr(U(j) &lt; 0 \\quad \\text{ for at least one of } j \\in \\{1,2, \\ldots, 5\\}) \\\\ &amp;= \\Pr(u + cj - S(j) &lt; 0 ), \\text{ for at least one of } j = 1,2, \\ldots, 5. \\end{align}\\] When \\(j = 1, U(1) = 50 + 110 - S(1)\\) \\(j = 2, U(2) = 50 + (2)110 - S(2) = U(1) + c - (S(2) - S(1))\\) \\(j = 3, U(3) = 50 + (3)110 - S(3) = U(2) + c - (S(3) - S(2))\\) \\(j = 4, U(4) = 50 + (4)110 - S(4) = U(3) + c - (S(4) - S(3))\\) \\(j = 5, U(5) = 50 + (5)110 - S(5) = U(4) + c - (S(5) - S(4))\\) The algorithm to estimate the finite time ruin in discrete time can be described as follows: Step 1. Simulate values of \\(S(1), S(2) - S(1), \\ldots, , S(5) - S(4)\\) from \\(\\mathcal{CP}(\\lambda, F_X(x))\\) distribution. Then compute \\(U(1), U(2), \\ldots U(5)\\). Step 2. Check if one of \\(U(1), U(2), \\ldots U(5)\\) are negative. Step 3. Repeat the simulations (1 and 2) 1000 times. Step 4. Let \\(M\\) be the number of simulations out of 1000 where ruin occurs. Then \\(\\hat{\\psi}_1(50, 5) = \\frac{M}{1000}.\\) From the results, there are \\(M = 21\\) simulations that ruin occurs, and hence \\[\\hat{\\psi}_1(50, 5) = \\frac{M}{1000} = \\frac{21}{1000}.\\] The estimation of the standard error of \\(\\hat{\\psi}_1(50, 5)\\) can be obtained as follows. We know that \\(M \\sim \\mathcal{B}(1000,p)\\) where \\(p = \\hat{\\psi}_1(50, 5)\\). Then, \\[\\textrm{Var}\\left[\\frac{M}{1000}\\right] = \\frac{1}{1000^2}\\textrm{Var}[M] = \\frac{1000 (p) (1-p)}{1000^2}\\] and \\[ \\textrm{SD}[\\hat{\\psi}_1(50, 5)] = \\frac{1000 (0.021) (1-0.021)}{1000^2} = 0.004534 \\] The 95% confidence interval of the estimate is \\[ (\\hat{\\psi}_1(50, 5) - z_{\\alpha/2}\\textrm{SD}[\\hat{\\psi}_1(50, 5)], \\hat{\\psi}_1(50, 5) + z_{\\alpha/2} \\textrm{SD}[\\hat{\\psi}_1(50, 5)]) = (0.012113,0.029887).\\] For the estimation of discrete time probability of ruin where the surplus process is checked at time intervals of length 0.5, we proceed as follows. First we note that \\(S(1/2), S(1) - S(1/2), S(3/2) - S(1), \\ldots, S(5) - S(9/2) \\sim \\mathcal{CP}((1/2)\\lambda, F_X(x))\\) distribution. In addition, U(1/2) = U(0) + c (1/2) - S(1/2)$ U(1) = U(1/2) + c (1/2) - ( S(1) - S(1/2) )$ U(3/2) = U(1) + c (1/2) - (S(3/2) - S(1))$ , \\(\\ldots\\), U(5) = U(9/2) + `c (1/2) - ( S(5) - S(9/2) )$. It follows that \\[\\begin{align} \\mathrm{E}[S(1/2)] &amp;= (1/2)(100)\\mathrm{E}[X] = (1/2)\\mathrm{E}[S(1)] = 50 \\\\ \\mathrm{Var}[S(1/2)] &amp;= (1/2)(100)\\mathrm{E}[X^2] = (1/2)\\mathrm{Var}[S(1)] = 150 \\\\ \\mathrm{Sk}[S(1/2)] &amp;= \\sqrt{2} \\mathrm{Sk}[S(1)] = 0.734847 . \\end{align}\\] Now we assume that \\(S(j) - S(j-1)\\) for \\(j = 1/2, 1, 3/2, \\ldots, 5\\) can be approximated by \\(Y + k\\) where \\(Y \\sim \\mathcal{G}(\\alpha, \\lambda)\\) and \\(k\\) is a constant. It follows that \\[ \\hat{\\alpha} = 7.407407, \\quad \\hat{\\beta} = 0.222222, \\quad \\hat{k} = 16.666667. \\] The simulations can be obtained in the same way. Figure 5.3: The sample paths of surplus process. eyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiJsaWJyYXJ5KGRwbHlyKVxubGlicmFyeSh0aWR5cilcbmxpYnJhcnkoZ2dwbG90MilcblxubGFtYmRhTiA8LSAxMDBcbmMgPC0gMTEwXG51IDwtIDUwXG5hbHBoYSA8LSA0XG5iZXRhICA8LSAzXG5cbiMgbiA9IG51bWJlciBvZiBzaW11bGF0aW9uc1xubiA8LSAxMDAwXG4jIFdlIHRoZW4gaGF2ZSBTKDEpIH4gQ1AobGFtYmRhTiwgUGEoYWxwaGEsYmV0YSkpXG4jIFMoMikgLSBTKDEpIH4gQ1AobGFtYmRhTiwgUGEoYWxwaGEsYmV0YSkpXG4jIFMoMykgLSBTKDIpIH4gQ1AobGFtYmRhTiwgUGEoYWxwaGEsYmV0YSkpXG5cbiMgV2UgdGhlbiBhcHByb3hpbWF0ZSB0aGUgY29tcG91bmQgUG9pc3NvbiB3aXRoIHRyYW5zbGF0ZWQgR2FtbWEgZGlzdHJpYnV0aW9uXG4jIFRoZXJlZm9yZSwgd2UgbmVlZCB0byBhcHByb3hpbWF0ZSBDUChsYW1iZGFOLCBQYShhbHBoYSxiZXRhKSkgfiBZICsga1xuIyB3aGVyZSBZIH4gR2EoYSxiKVxuXG5tMSA8LSBiZXRhLyhhbHBoYS0xKVxubTIgPC0gKDIqYmV0YV4yKS8gKChhbHBoYSAtIDEpICogKGFscGhhIC0yKSkgICAgXG5tMyA8LSAoNipiZXRhXjMpLyAoKGFscGhhIC0gMSkgKiAoYWxwaGEgLTIpICogKGFscGhhIC0zKSkgXG5cbkVTIDwtIGxhbWJkYU4qbTFcblZTIDwtIGxhbWJkYU4qbTJcblNrUyA8LSAobGFtYmRhTiAqIG0zKS8obGFtYmRhTiAqIG0yKV4oMy8yKVxuXG5cbmsgPC0gRVMgLSAyKnNxcnQoVlMpL1NrUyAgXG5hIDwtIDQvU2tTXjJcbmIgPC0gMi8oU2tTKnNxcnQoVlMpKVxuXG5cbiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyNcbiMgVVNFIHJhbmRvbSBudW1iZXIgZ2VuZXJhdG9ycyBmcm9tIHN0YW5kYXJkIG5vcm1hbCBkaXN0cmlidXRpb24uXG4jbGlicmFyeShyZWFkeGwpXG4jWiA8LSByZWFkX2V4Y2VsKFwiL1VzZXJzL0thZW15dWlqYW5nL0RvY3VtZW50cy9SIERpcmVjdG9yeS9SaXNrIFRoZW9yeS9SdWluVGhlb3J5L1R1dG9yaWFsNkhXX1J1aW5UaGVvcnkueGxzeFwiLCBza2lwID0gMilcbiNaIDwtIHJlYWRfZXhjZWwoXCJUdXRvcmlhbDZIV19SdWluVGhlb3J5Lnhsc3hcIiwgc2tpcCA9IDIpXG5cbiNsb2FkKFwic2ltWi5SZGF0YVwiKVxuXG4jIFNpbXVsYXRlIG51bWJlcnMgZnJvbSBVKDAsMSlcbnNldC5zZWVkKDEpXG5aMSA8LSBydW5pZigxMDAwLCBtaW4gPSAwLCBtYXggPSAxKVxuWjIgPC0gcnVuaWYoMTAwMCwgbWluID0gMCwgbWF4ID0gMSlcblozIDwtIHJ1bmlmKDEwMDAsIG1pbiA9IDAsIG1heCA9IDEpXG5aNCA8LSBydW5pZigxMDAwLCBtaW4gPSAwLCBtYXggPSAxKVxuWjUgPC0gcnVuaWYoMTAwMCwgbWluID0gMCwgbWF4ID0gMSlcblxuWiA8LSBjYmluZChaMSxaMixaMyxaNCxaNSlcblxuXG5cblogPC0gYXMuZGF0YS5mcmFtZShaKVxuXG4jZGF0IDwtIGFzX3RpYmJsZShaKVxuZGF0IDwtIFpcblxuIyMjICAjIyNcbiMgU2ltdWxhdGUgbnVtYmVycyBmcm9tIENQKGxhbWJkYU4sIFBhKGFscGhhLGJldGEpKSB+IFkgKyBrLCAgd2hlcmUgWSB+IEdhKGEsYilcbiN0cmFuc2xhdGVkR2FtbWEgPC0gZnVuY3Rpb24oeCwgYSwgYiwgayl7XG4jICBxZ2FtbWEoYXMubnVtZXJpYyh4KSxzaGFwZSA9IGEsIHJhdGUgPSBiKSArIGtcbiN9XG4jdHJhbnNsYXRlZEdhbW1hKFpbMToyXSwgYSwgYiwgaylcblxuIyBTaW11bGF0ZSBudW1iZXJzIGZyb20gQ1AobGFtYmRhTiwgUGEoYWxwaGEsYmV0YSkpIH4gWSArIGssICB3aGVyZSBZIH4gR2EoYSxiKVxudHJhbnNsYXRlZEdhbW1hIDwtIGZ1bmN0aW9uKHgsIGEsIGIsIGspe1xuICBxZ2FtbWEoYXMubnVtZXJpYyh1bmxpc3QoeCkpLHNoYXBlID0gYSwgcmF0ZSA9IGIpICsga1xufVxuI3RyYW5zbGF0ZWRHYW1tYShaWzE6Ml0sIGEsIGIsIGspXG5cblxuXG4jIEFkZCBVMCBjb2x1bW5cbmRhdCA8LSBkYXQgJT4lIG11dGF0ZShVMCA9IHUpXG5cbiMgQ3JlYXRlIFUxLCBVMiwgVTMsIFU0LCBVNVxuVSA8LSBzZXROYW1lcyhkYXRhLmZyYW1lKG1hdHJpeChuY29sID0gNSwgbnJvdyA9IG4pKSwgIHBhc3RlMChcIlVcIiwxOjUsc2VwPVwiXCIpKVxuVVsxXSA8LSB1ICsgYyAtICB0cmFuc2xhdGVkR2FtbWEoWlsxXSxhLCBiLCBrKVxuZm9yIChpIGluIDI6NSl7XG4gIFVbaV0gPC0gIFVbaS0xXSArIGMgLSB0cmFuc2xhdGVkR2FtbWEoWltpXSxhLCBiLCBrKVxufVxuXG5kYXQgPC0gY2JpbmQoZGF0LFUpXG5cbiMgQ2hlY2sgd2hldGhlciBydWluIG9jY3VycyBvciBub3RcbiMgV2l0aCBkcGx5ciwgdXNpbmcgdGhlIGZ1bmN0aW9uIHJvd3dpc2U6IHJlZmVyZW5jZTogaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMzU5MDI4NDIvbWluLWFuZC1tZWRpYW4tb2YtbXVsdGlwbGUtY29sdW1ucy1vZi1hLWRmLWJ5LXJvdy1pbi1yXG5kYXQgPC0gbXV0YXRlKHJvd3dpc2UoZGF0KSwgUnVpbiA9IG1pbihVMSxVMixVMyxVNCxVNSk8MCkgIFxuIyBvclxuZGF0IDwtIGRhdCAlPiUgcm93d2lzZSgpICU+JSBtdXRhdGUoUnVpbiA9IG1pbihVMSxVMixVMyxVNCxVNSk8MCkgIFxuXG4jIExldCBNIGJlIHRoZSBudW1iZXIgb2Ygc2ltdWxhdGlvbnMgb3V0IG9mIDEwMDAgd2hlcmUgcnVpbiBvY2N1cnMuIFxuTSA8LSBkYXQkUnVpbiAlPiUgc3VtKClcblxuXG5cblxuIyBVc2luZyBnZ3Bsb3QyIHRvIHBsb3Qgc2FtcGxlIHBhdGhzXG4jIFdlIG5lZWQgdG8gc2VsZWN0IG9ubHkgY29sdW1ucyBVMCwuLi4sVTUgYW5kIHRoZW4gdHJhbnNwb3NlIHRoZSBzZWxlY3RlZCByYW5nZS5cbiMgQnkgdHJhbnNwb3NpbmcgdGhlIHNlbGVjdGVkIHJhbmdlLCB3ZSBuZWVkIHRvIGZvcm1hdCBvdXIgZGF0YSB0YWJsZSBhcyBmb2xsb3dzOlxuI1xuIyB0aW1lIHwgIFAxKG9yIFBhdGgxKXwgIFAyICAgICAgICB8ICAuLi5cbiMgMCAgICB8IFUoMCkgb2YgUDEgICB8IFUoMCkgb2YgUDIgfCAgLi4uXG4jIDEgICAgfCBVKDEpIG9mIFAxICAgfCBVKDEpIG9mIFAyIHwgIC4uLlxuIyAyICAgIHwgVSgyKSBvZiBQMSAgIHwgVSgyKSBvZiBQMiB8ICAuLi5cbiMgMyAgICB8IFUoMykgb2YgUDEgICB8IFUoMykgb2YgUDIgfCAgLi4uXG4jIDQgICAgfCBVKDQpIG9mIFAxICAgfCBVKDQpIG9mIFAyIHwgIC4uLlxuIyA1ICAgIHwgVSg1KSBvZiBQMSAgIHwgVSg1KSBvZiBQMiB8ICAuLi5cblxuXG5kYXRTYW1wbGUgPC0gZHBseXI6OnNlbGVjdChkYXQsbnVtX3JhbmdlKFwiVVwiLCAwOjUpKSAlPiUgaGVhZCgxMClcbiNkYXRTYW1wbGUgPC0gYXNfdGliYmxlKHQoZGF0U2FtcGxlKSlcbmRhdFNhbXBsZSA8LSBhcy5kYXRhLmZyYW1lKHQoZGF0U2FtcGxlKSlcbmNvbG5hbWVzKGRhdFNhbXBsZSkgPC0gcGFzdGUoXCJQXCIsMToxMCxzZXA9XCJcIilcblxuXG5kYXRTYW1wbGUgPC0gZGF0U2FtcGxlICU+JSBtdXRhdGUodGltZT0wOjUpXG5cbiMgUmVmb3JtYXQgZGF0U2FtcGxlIGZvciBnZ3Bsb3QyXG5kYXRQYXRoc0dhdGhlciA8LSBkYXRTYW1wbGUgJT4lIGdhdGhlcihcInBhdGhcIixcInlcIiwtdGltZSlcbiNkYXRQYXRoc0dhdGhlciA8LSBkYXRTYW1wbGUgJT4lIHBpdm90X2xvbmdlcigxOjEwLCBuYW1lc190byA9IFwicGF0aFwiLCB2YWx1ZXNfdG8gPSBcInlcIilcblxuZGF0UGF0aHNHYXRoZXIgJT4lIGdncGxvdChhZXModGltZSx5LGNvbCA9IHBhdGgpKSArIGdlb21fbGluZSgpICsgIHNjYWxlX3hfY29udGludW91cyhicmVha3M9MDo1KSJ9 "],["tutorials.html", "Chapter 6 Tutorials 6.1 Tutorial 1 6.2 Tutorial 2 6.3 Solutions to Tutorial 2 6.4 Tutorial 3 6.5 Solutions to Tutorial 3 6.6 Tutorial 4 6.7 Solutions to Tutorial 4 6.8 Tutorial 5 6.9 Solutions to Tutorial 5 6.10 Tutorial 6 6.11 Solutions to Tutorial 6 6.12 Tutorial 7 6.13 Solutions to Tutorial 7 6.14 Tutorial 8 6.15 Solutions to Tutorial 8 6.16 Tutorial 9 6.17 Solutions to Tutorial 9", " Chapter 6 Tutorials 6.1 Tutorial 1 Using the method of moments, calculate the parameter values for the gamma, lognormal and Pareto distributions for which \\[\\mathrm{E}[X] = 500 \\quad \\text{and} \\quad \\mathrm{Var}[X] = 100^2.\\] Answer: gamma: \\(\\tilde{\\alpha} = 25\\), \\(\\tilde{\\lambda} = 0.05.\\) lognormal: \\(\\tilde{\\mu} = 6.194998\\), \\(\\tilde{\\sigma} = 0.1980422.\\) the MME cannot apply for the Pareto distribution. For the given values of \\[\\mathrm{E}[X] = 500 \\quad \\text{and} \\quad \\mathrm{Var}[X] = 100^2\\], the obtained values of \\(\\tilde{\\alpha}\\) and \\(\\tilde{\\lambda}\\) from the method of moments are negative. Note that if we fix \\(s = 100^2\\) and vary \\(\\bar{x}\\) within the interval \\([90,110]\\), the plot of \\(\\bar{x}\\) against \\(\\tilde{\\alpha}\\) is shown below. Notice that when \\(\\bar{x} = 100\\), \\(\\tilde{\\alpha}\\) tends to infinity. xbar &lt;-90:110 s &lt;- 100 # MME alpha_tilde &lt;- 2*s^2/xbar^2 * 1/(s^2/xbar^2 - 1) lambda_tilde &lt;- xbar*(alpha_tilde -1) plot(xbar,alpha_tilde, xlab = expression(bar(x)), ylab = expression(alpha)) Show that if \\(X \\sim \\text{Exp}(\\lambda)\\), then the random variable \\(X-w\\) conditional on \\(X &gt; w\\) has the same distribution as \\(X\\), i.e. \\[X \\sim \\text{Exp}(\\lambda)\\Rightarrow X - w | X &gt; w \\sim \\text{Exp}(\\lambda).\\] Solution: Let \\(W = Z|Z&gt;0\\) be a random variable representing the amount of a non-zero payment by the reinsurer on a reinsurance claim. The distribution and density of \\(W\\) can be calculated as follows: for \\(x &gt; 0\\), \\[ \\begin{aligned} \\Pr[W \\le x ] &amp;= \\Pr[Z \\le x | Z &gt;0] \\\\ &amp;= \\Pr[X - M \\le x | X &gt; M] \\\\ &amp;= \\frac{\\Pr[M &lt; X \\le x + M]}{\\Pr[X &gt; M]}\\\\ &amp;= \\frac{F_X(x+M) - F_X(M)}{1-F_X(M)}. \\end{aligned} \\] Given \\(X \\sim \\textrm{Exp}(\\lambda)\\), \\(F_X(x) = 1 - e^{-\\lambda x}.\\) Moreover, \\[ \\begin{aligned} \\Pr[W \\le x ] &amp;= \\frac{F_X(x+M) - F_X(M)}{1-F_X(M)} \\\\ &amp;= \\frac{ e^{-\\lambda (M)} - e^{-\\lambda (x+M)}}{e^{-\\lambda (M)}} \\\\ &amp;= 1 - e^{-\\lambda x}. \\end{aligned} \\] Hence, \\(W \\sim \\textrm{Exp}(\\lambda)\\). Derive an expression for the variance of the \\(\\text{Pa}(\\alpha, \\lambda)\\) distribution. (Hint: using the pdf) Solution: Recall that that for \\(X \\sim \\mathcal{Pa}(\\alpha,\\lambda)\\), its density function is \\[ f_X(x) = \\frac{\\alpha \\lambda^\\alpha}{ (x + \\lambda)^{\\alpha + 1}}.\\] \\[ \\begin{aligned} \\mathrm{E}[X] &amp;= \\int_0^\\infty x \\frac{\\alpha \\lambda^\\alpha}{ (x + \\lambda)^{\\alpha + 1}}\\, dx \\quad \\text{(using integration by part:} \\quad u = x \\text{ and } (\\lambda + x)^{-(\\alpha + 1)}dx = dv) \\\\ &amp;= -\\alpha \\lambda^\\alpha \\left( \\frac{x}{\\alpha} (\\lambda + x)^{-\\alpha} \\right)\\bigg|_0^\\infty + (\\alpha \\lambda^\\alpha)(\\frac{1}{\\alpha})\\int_0^\\infty \\frac{1}{(\\lambda + x)^\\alpha} \\, dx \\end{aligned} \\] Using the fact that for \\(X \\sim \\mathcal{Pa}(\\alpha,\\lambda)\\), \\(\\textrm{E}[X]\\) exists when \\(\\alpha &gt; 1\\), which will be assumed on the first term above. This assumption simplifies the above results as follows: \\[ \\begin{aligned} \\mathrm{E}[X] &amp;= 0 + \\int_0^\\infty \\frac{\\lambda^\\alpha}{(\\lambda + x)^\\alpha} \\, dx \\\\ &amp;= \\frac{\\lambda}{\\alpha - 1} \\int_0^\\infty \\frac{(\\alpha - 1)\\lambda^{\\alpha - 1}}{(\\lambda + x)^\\alpha} \\, dx \\\\ &amp;= \\frac{\\lambda}{\\alpha - 1} \\cdot 1. \\end{aligned} \\] Note that the last integral integrate to 1 because the integrand is the density function of a Pareto distribution. One can also show that \\[ \\mathrm{E}[X^2] = \\frac{2 \\lambda^2}{(\\alpha - 1)(\\alpha - 2)}.\\] Therefore, \\[ \\mathrm{Var}[X] = \\mathrm{E}[X^2] - (\\mathrm{E}[X])^2 = \\frac{\\alpha \\lambda^2}{(\\alpha - 1)^2(\\alpha - 2)}.\\] Show that the MLE (the maximum likelihood estimation) of \\(\\lambda\\) for an \\(\\text{Exp}(\\lambda)\\) distribution is the reciprocal of the sample mean, i.e. \\(\\hat\\lambda = 1/ \\bar x\\). Solution: Suppose we have a random sample \\(x = (x_1, x_2, \\ldots, x_n)\\) of \\(X \\sim \\text{Exp}(\\lambda).\\) We have \\[ \\begin{aligned} L(\\lambda) &amp;= \\Pi_{i=1}^n f(x_i, \\lambda) = \\Pi_{i=1}^n \\lambda e^{-\\lambda x_i} = \\lambda^n e^{-\\lambda \\sum x_i}. \\\\ l(\\lambda) &amp;= \\log( L(\\lambda)) = n \\log(\\lambda) - \\lambda \\sum x_i \\end{aligned} \\] The MLE can be obtained by maximise \\(l(\\lambda)\\) with respect to \\(\\lambda\\). \\[ \\frac{d\\, l(\\lambda)}{d \\lambda } = \\frac{n}{\\lambda} - \\sum x_i = 0. \\] Therefore, the MLE of \\(\\lambda\\) is \\(\\hat{\\lambda} = 1/\\bar{x}.\\) Claims last year on a portfolio of policies of a risk had a lognormal distribution with parameter \\(\\mu = 5\\) and \\(\\sigma^2 = 0.4\\). It is estimated that all claims will increase by 15% next year. Find the probability that a claim next year will exceed 1000. Solution: From \\(X \\sim \\mathcal{LN}(5,0.4)\\), \\(\\log X \\sim \\mathcal{N}(5,0.4)\\). Claims in next year will increase by 15%. We define \\(Y = (1+15\\%) X = 1.15 X\\). We also have \\[ \\begin{aligned} \\Pr(Y &gt; 1000) &amp;=\\Pr(1.15 X &gt; 1000) \\\\ &amp;=\\Pr(\\log X &gt; \\log (1000/1.15)) \\\\ &amp;=\\Pr\\left(Z &gt; \\frac{\\log (1000/1.15)) - 5 }{\\sqrt{0.4}}\\right) \\\\ &amp;=\\Pr\\left(Z &gt; 2.7954\\right) \\\\ &amp;=1 - \\Pr\\left(Z \\le 2.7954\\right) \\\\ &amp;= 1 - 0.9974082 = 0.002591777. \\\\ \\end{aligned} \\] I used R to obtain the required probability. 6.2 Tutorial 2 Claims occur on a general insurance portfolio independently and at random. Each claim is classified as being of “Type A” or “Type B”. Type A claim amounts are distributed \\(\\text{Pa}(3,400)\\) and Type B claim amounts are distributed \\(\\text{Pa}(4,1000)\\). It is known that 90% of all claims are of Type A. Let \\(X\\) denote a claim chosen at random from the portfolio. Calculate \\(\\Pr(X &gt; 1000).\\) Calculate \\(\\mathrm{E}[X]\\) and \\(\\mathrm{Var}[X]\\). Let \\(Y\\) have a Pareto distribution with the same mean and variance as \\(X\\). Calculate \\(\\Pr(Y &gt; 1000).\\) Comment on the difference in the answers found in 1.1 and 1.2. An insurer covers an individual loss \\(X\\) with excess of loss reinsurance with retention level \\(M\\). Let \\(Y\\) and \\(Z\\) be random variables representing the amounts paid by the insurer and reinsurer, respectively, i.e. \\(X = Y + Z\\). Show that \\(\\mathrm{Cov}[Y,Z] \\ge 0\\) and deduce that \\[\\mathrm{Var}[X] \\ge \\mathrm{Var}[Y] + \\mathrm{Var}[Z].\\] Comment on the results obtained. Claim amounts from a general insurance portfolio are lognormally distributed with mean 200 and variance 2916. Excess of loss reinsurance with retenton level 250 is arranged. Calculate the probability that the reinsurer is involved in a claim. Show that if \\(X \\sim \\text{Pa}(\\alpha, \\lambda)\\), then the random variable \\(X-d\\) conditional on \\(X &gt; d\\) has a pareto distribution with parameters \\(\\alpha\\) and \\(\\lambda + d\\), i.e. \\[X \\sim \\text{Pa}(\\alpha, \\lambda)\\Rightarrow X - d | X &gt; d \\sim \\text{Pa}(\\alpha,\\lambda + d).\\] Consider a portfolio of motor insurance policies. In the event of an accident, the cost of the repairs to a car has a Pareto distribution with parameters \\(\\alpha\\) and \\(\\lambda\\). A deductible of 100 is applied to all claims and a claim is always made if the cost of the repairs exceeds this amount. A sample of 100 claims has mean 200 and standard deviation 250. Using the method of moments, estimate \\(\\alpha\\) and \\(\\lambda\\). Estimate the proportion of accidents that do not result in a claim being made. The insurance company arranges excess of loss reinsurance with another insurance company to reduce the mean amount it pays on a claim to 160. Calculate the retention limit needed to achieve this. 6.3 Solutions to Tutorial 2 Solution: \\[\\begin{aligned} \\Pr(X &gt; 1000) &amp;= \\Pr(X &gt; 1000 | A) \\Pr(A) + \\Pr(X &gt; 1000 | B) \\Pr(B) \\\\ &amp;= \\left( \\frac{ 400 }{ 1000 + 400} \\right)^{3} (0.9) + \\left( \\frac{ 1000 }{ 1000 + 1000} \\right)^{4} (0.1) \\\\ &amp;= 0.0272413. \\end{aligned}\\] Using the conditional expectation and conditional variance formulas, we have \\[\\begin{aligned} \\mathrm{E}[X|A] &amp;= \\frac{400 }{3 - 1} = 200, \\\\ \\mathrm{E}[X|B] &amp;= \\frac{1000 }{4 - 1} = 333.3333333. \\end{aligned} \\] Hence, \\[\\begin{aligned} \\mathrm{E}[X] &amp;= \\mathrm{E}[\\mathrm{E}[X|\\text{type}]] \\\\ &amp;= \\Pr(A) \\, \\mathrm{E}[X|A] + \\Pr(B) \\, \\mathrm{E}[X|B] \\\\ &amp;= (0.9)(200) + (0.1)(333.3333333) \\\\ &amp;= 213.3333333. \\end{aligned} \\] We also have \\[\\begin{aligned} \\mathrm{E}[X^2|A] &amp;= \\mathrm{Var}[X|A] + (\\mathrm{E}[X|A])^2 = \\frac{(3) (400)^2}{(3 - 1)^2 (3 - 2)} + (200)^2 = 1.6\\times 10^{5},\\\\ \\mathrm{E}[X^2|B] &amp;= \\mathrm{Var}[X|B] + (\\mathrm{E}[X|B])^2 = \\frac{(4) (1000)^2}{(4 - 1)^2 (4 - 2)} + (333.3333333)^2 = 3.3333333\\times 10^{5}. \\end{aligned} \\] Therefore, \\(\\mathrm{E}[X^2] = (0.9)(1.6\\times 10^{5}) + (0.1)(3.3333333\\times 10^{5}) = 1.7733333\\times 10^{5}\\), and \\(\\mathrm{Var}[X] = 1.3182222\\times 10^{5}\\), \\(\\mathrm{SD}[X] = 363.0733014\\). 3. Using moment matching estimation, we have \\(\\tilde{\\alpha} = 3.0545829\\) and \\(\\tilde{\\beta} = 438.3110196\\). Therefore, \\(\\Pr[Y &gt; 1000] = 0.0265228 &lt; 0.0272413\\). 4. Failure to separate two types of claims leads to an underestimation of tail probability. This affects the determination of premiums, reinsurance, and security. From \\(X = Y + Z\\), where \\(Y = \\min(X,M)\\) and \\(Z = \\max(0,X -M)\\). \\[\\begin{aligned} \\mathrm{Cov}(Y,Z) &amp;= \\mathrm{E}[YZ] - \\mathrm{E}[Y]\\mathrm{E}[Z] \\\\ &amp;= \\int_0^\\infty \\min(X,M) \\max(0,X -M) f_X(x) \\, dx - \\mathrm{E}[Y]\\mathrm{E}[Z] \\\\ &amp;= M \\int_M^\\infty \\max(0,X -M) f_X(x) \\, dx - \\mathrm{E}[Y]\\mathrm{E}[Z] \\\\ &amp;= M \\mathrm{E}[Z] - \\mathrm{E}[Y]\\mathrm{E}[Z] \\\\ &amp;= \\mathrm{E}[Z](M - \\mathrm{E}[Y]) \\ge 0. \\\\ \\end{aligned}\\] Therefore, \\[\\mathrm{Var}[X] = \\mathrm{Var}[Y + Z] = \\mathrm{Var}[Y] + \\mathrm{Var}[Z] + 2Cov(X,Y) \\ge \\mathrm{Var}[Y] + \\mathrm{Var}[Z].\\] Consequently, there is a reduction in the variability of the amount paid out by the direct insurer on claims. By the method of moments, the MMEs of the parameter \\(\\mu\\) and \\(\\sigma\\) can be found by matching \\(\\mathrm{E}[X]\\) to the sample mean and \\(\\mathrm{Var}[X]\\) to the sample variance: \\[\\mathrm{E}[X] = \\exp\\left(\\mu + \\frac{1}{2} \\sigma^2 \\right) = 200 \\text{ and } \\mathrm{Var}[X] =\\exp\\left(2\\mu + \\sigma^2 \\right) (\\exp(\\sigma^2) - 1) = 2916.\\] We find that \\(\\tilde{\\mu} = 5.2631347\\) and \\(\\tilde{\\sigma} = 0.2652645\\). Moreover, \\[ \\Pr(X &gt; 250) = P( Z &gt; \\frac{\\ln(250) - \\tilde{\\mu}}{\\tilde{\\sigma}}) = 0.1650671,\\] where \\(Z \\sim \\mathcal{N}(0,1)\\). We find that the reinsurer is involved in about 16.51% of claims. Given \\(X \\sim \\mathcal{Pa}(\\alpha,\\lambda)\\), define \\(W = X- d | X &gt; d\\). \\[\\begin{aligned} \\Pr[W \\le x ] &amp;= \\Pr[Z \\le x | Z &gt;0] \\\\ &amp;= \\Pr[X - d \\le x | X &gt; d] \\\\ &amp;= \\frac{\\Pr[d &lt; X \\le x + d]}{\\Pr[X &gt; d]}\\\\ &amp;= \\frac{F_X(x+d) - F_X(d)}{1-F_X(d)} \\\\ &amp;= 1 - \\left( \\frac{\\lambda + d}{\\lambda + x + d} \\right)^\\alpha. \\end{aligned}\\] Hence, \\(W \\sim \\mathcal{Pa}(\\alpha, \\lambda + d).\\) Let \\(X\\) be the cost of repair and \\(Y\\) be the cost of claims. Suppose that \\(X \\sim \\mathcal{Pa}(\\alpha, \\lambda)\\). It follows that \\[ Y = X - d | X &gt; d, \\] where \\(d = 100\\). Moreover, \\(Y \\sim \\mathcal{Pa}(\\alpha, \\lambda + d).\\) It should be emphasised that the given information implies that \\[ \\mathrm{E}[Y] = 200, \\quad \\mathrm{Var}[Y] = 250^2.\\] Letting \\(\\lambda + d = \\phi\\) results in \\(Y \\sim \\mathcal{Pa}(\\alpha, \\phi).\\) By the mothod of moments, the MMEs of \\(\\alpha\\) and \\(\\phi\\) (and hence \\(\\lambda\\)) are \\(\\tilde{\\alpha} = 5.5555556\\), \\(\\tilde{\\phi} = 911.1111111\\) and \\(\\tilde{\\lambda} = \\tilde{\\phi} - d = 811.1111111\\). The proportion of accidents that do not result in a claim being made is \\[\\Pr(X &lt; d) = 1 - \\left(\\frac{\\tilde{\\lambda}}{\\tilde{\\lambda} + d}\\right)^\\alpha = 0.4392931.\\] We know that claims before excess of loss reinsurance is \\(Y \\sim \\mathcal{Pa}(\\alpha, \\phi).\\) With excess of loss reinsurance contract, the expected value of the amount paid out by the insurer is \\(\\mathrm{E}[\\min(Y,M)],\\) which can be calculated as follows: \\[\\begin{aligned} \\mathrm{E}[Y_I] &amp;= \\mathrm{E}[\\min(Y,M)] \\\\ &amp;= \\mathrm{E}[Y] - \\int_0^\\infty y \\cdot f_Y(y+M) \\, dy \\\\ &amp;= \\mathrm{E}[Y] - \\int_0^\\infty y \\cdot \\frac{\\alpha \\phi^\\alpha}{(\\phi + y + M)^{\\alpha + 1}} \\, dy \\\\ &amp;= \\mathrm{E}[Y] - \\left(\\frac{\\phi}{\\phi+M} \\right)^\\alpha\\int_0^\\infty y \\cdot \\frac{\\alpha (\\phi + M)^\\alpha}{(\\phi + y + M)^{\\alpha + 1}} \\, dy. \\end{aligned}\\] The last integral defines the mean of the Pareto random variable with parameters \\(\\alpha\\) and \\(\\phi + M\\) and so equals to \\(\\frac{\\phi + M}{\\alpha - 1}\\). After simplifying, we have \\[\\begin{aligned} \\mathrm{E}[Y_I] &amp;= \\mathrm{E}[Y] - \\left(\\frac{\\phi}{\\phi+M} \\right)^\\alpha \\left(\\frac{\\phi + M}{\\alpha - 1}\\right) = \\left(\\frac{\\lambda + d}{\\alpha - 1} \\right)\\left(1 - \\left( \\frac{\\lambda + d}{\\lambda + d + M} \\right)^{\\alpha - 1} \\right). \\end{aligned}\\] Substituting all the parameter values and \\(\\mathrm{E}[Y_I] = 160\\), we solve for \\(M\\) which results in \\[M = \\frac{\\tilde{\\lambda} + d}{\\left(1- \\frac{(\\tilde{\\alpha} -1)\\mathrm{E}[Y_I]}{(\\tilde{\\lambda} + d)} \\right)^{ \\frac{1}{\\tilde{\\alpha} - 1} }} - (\\tilde{\\lambda} + d ) = 386.0795.\\] 6.4 Tutorial 3 The aggregate claims \\(S\\) have a compound Poisson random variable with Poisson parameter \\(\\lambda = 20\\) and claim amounts have a \\(\\mathcal{G}(2,1)\\) distribution. Find the coefficient of skewness of the aggregate claim amount \\(Sk[S]\\). Suppose that \\(S_1\\) and \\(S_2\\) are independent compound Poisson random variables with Poisson parameters \\(\\lambda_1 = 10\\) and \\(\\lambda_2 = 30\\) and the claim sizes for \\(S_i\\) are exponentially distributed with mean \\(\\mu_i\\) where \\(\\mu_1 = 1\\) and \\(\\mu_2 = 2\\), respectively. Find the distribution of the random sum \\(S = S_1 + S_2\\). The number of claims in one time period has a negative binomial distribution \\(\\mathcal{NB}(k, p)\\) with \\(k = 1\\) and claim sizes have an exponential distribution with mean \\(\\mu\\). Use the moment generating formula to obtain the distribution of the aggregate claim amount \\(S\\). Find the mean and variance of the aggregate claims for this time period. A portfolio consists of 100 car insurance policies. 60% of the policies have a deductible of 10 and the remaining have a deductible of 0. The insurance policy pays the amount of damage in excess of the deductible subject to a maximum of 125 per accident. Assume that The number of accident per year per policy has a Poisson distribution with mean 0.02; and The amount of damage has the distribution: \\[Pr(X = 50) = 1/3, Pr(X = 150) = 1/3, Pr(X = 200) = 1/3.\\] Find the expected insurer’s payout. The number of claims \\(N\\) per a fixed time period has the following distribution: \\[Pr(N = 0) = 0.5, Pr(N = 1) = 0.3, Pr(N = 2) = 0.1, \\text{ and } Pr(N = 3) = 0.1.\\] The loss distribution is uniformly distributed on the interval \\((0,100)\\). Assume that the number of claims and the amount of losses are mutually independent. Find the mean and variance of the aggregate claims for this fixed time period. Suppose that a policy deductible of 20 is in place. Find the expected insurer’s payout. 6.5 Solutions to Tutorial 3 The aggregate claims \\(S\\) have a compound Poisson random variable, \\(S \\sim \\mathcal{CP}(\\lambda, F_X)\\) with \\(\\lambda = 20\\) and \\(X \\sim \\mathcal{G}(\\alpha,\\beta) = \\mathcal{G}(2,1)\\) distribution. From \\(\\mathrm{Sk}[S] = \\frac{\\lambda m_3}{(\\lambda m_2)^{3/2}}\\) with \\(m_r = \\mathrm{E}[X^r]\\), we also have \\[\\mathrm{E}[X^r] = \\frac{1}{\\beta^r} \\frac{\\Gamma(\\alpha + r)}{\\Gamma(\\alpha )}, \\quad r &gt; 0.\\] Note that if \\(\\alpha\\) is an integer, then \\(\\Gamma(\\alpha) = (\\alpha-1)!\\). Substituting all the parameter values, we have \\(\\mathrm{E}[X^2] = 6\\), \\(\\mathrm{E}[X^3] = 24\\) and \\(\\mathrm{Sk}[S] = 0.3651484\\). \\(S_1 \\sim \\mathcal{CP}(\\lambda, F_1)\\) and \\(S_2 \\sim \\mathcal{CP}(\\lambda, F_2)\\) are independent compound Poisson random variables with claim sizes exponential distributions for \\(S_i\\), \\(\\text{Exp}(1/\\mu_i)\\) where \\(\\mu_1 = 1\\) and \\(\\mu_2 = 2\\). By the additivity of independent compound Poisson distributions, the distribution of \\(S = S_1 + S_2\\) is \\(\\mathcal{CP}(\\lambda, F_X)\\), where \\[ F_X(x) = \\frac{10}{40} F_1(x) + \\frac{30}{40} F_2(x) = \\frac{1}{4}(1 - e^{-x}) + \\frac{3}{4} (1 - e^{-x/2}).\\] It is the mixture of exponential distribution with mean 1 and 2. From \\(N \\sim \\mathcal{NB}(1, p)\\) and \\(X \\sim \\text{Exp}(\\mu)\\), the moment generating functions of \\(N\\) and \\(X\\) are \\[ M_N(t) = \\frac{p}{1-q e^t}, \\quad M_X(t) = \\frac{1}{1 - \\mu t},\\] where \\(q = 1- p\\). Therefore, \\[\\begin{aligned} M_S(t) &amp;= M_N(\\log(M_X(t))) \\\\ &amp;= \\frac{p}{1-q M_X(t)} \\\\ &amp;= p + q\\frac{1}{1- \\frac{\\mu}{p}t} \\end{aligned}.\\] This distribution can be regarded as a mixture of a distribution with moment generating function 1 and a mixture of a distribution with moment generating function \\((1- \\frac{\\mu}{p}t)^{-1}\\), i.e. the moment generating function of an exponential random variable with mean \\(\\mu/p\\). Applying the properties of the moment generating function, \\(M_S^{(k)}(0) = \\mathrm{E}[X^k]\\). It follows that \\[ \\frac{d}{dt} M_S(t) = \\frac{p q \\mu}{(p - \\mu t)^2}, \\quad \\mathrm{E}[S] = \\frac{q \\mu}{p}\\] and \\[ \\frac{d^2}{dt^2} M_S(t) = \\frac{2 p q \\mu^2}{(p - \\mu t)^3}, \\quad \\mathrm{E}[S^2] = \\frac{2 q \\mu^2}{p^2}.\\] Therefore, \\[\\mathrm{Var}[S] = \\mathrm{E}[S^2] - (\\mathrm{E}[S])^2 = \\frac{2 q \\mu^2}{p^2} - \\left(\\frac{q \\mu}{p}\\right)^2 = \\frac{q(2-q)\\mu^2}{p^2}.\\] Alternatively, the mean and variance of the aggregate claims for this time period can be calculated from the properties of a compound negative distribution (with k = 1), \\[\\mathrm{E}[S] = \\frac{q}{p} \\mathrm{E}[X] = \\frac{q \\mu}{p},\\] and \\[\\mathrm{Var}[S] = \\frac{q}{p^2}(p \\mathrm{E}[X^2] + q (\\mathrm{E}[X])^2) = \\frac{q}{p^2} (p (2\\mu^2) + q \\mu^2) = \\frac{q(2-q)\\mu^2}{p^2}.\\] Let \\(Y\\) be the aggregate claims paid by the insurer of 60 policies with a deductible of 10 and policy limit of 125. Then, \\(Y \\sim \\mathcal{CP}(60 \\times 0.02, F_X)\\), where \\(X\\) is the individual claim amount paid by the insurer. The distribution of \\(X\\) is x 40 125 \\(\\Pr(X = x)\\) 1/3 2/3 Hence, \\(\\mathrm{E}[X] = 290/3\\) and \\(\\mathrm{E}[Y] = 116\\). Let \\(U\\) be the aggregate claims paid by the insurer of 40 policies with a deductible of 0 and policy limit of 125. Then, \\(U \\sim \\mathcal{CP}(40 \\times 0.02, F_{X&#39;})\\), where \\(X&#39;\\) is the individual claim amount paid by the insurer. The distribution of \\(X&#39;\\) is x 50 125 \\(\\Pr(X&#39; = x)\\) 1/3 2/3 Hence, \\(\\mathrm{E}[X] = 100\\) and \\(\\mathrm{E}[U] = 80\\). The total expected total claim payout of the insurer is \\(116 + 80 = 196\\). The number of claims \\(N\\) per a fixed time period has the following distribution: \\[\\Pr(N = 0) = 0.5, \\Pr(N = 1) = 0.3, \\Pr(N = 2) = 0.1, \\text{ and } \\Pr(N = 3) = 0.1.\\] Then, \\(\\mathrm{E}[N] = 0.8\\) and \\(\\mathrm{Var}[N] = 0.96\\). The loss distribution is uniformly distributed \\(X \\sim \\mathcal{U}(0,100)\\). Then, Then, \\(\\mathrm{E}[X] = 50\\) and \\(\\mathrm{E}[X^2] = 3333.3333333\\). The mean and variance of the aggregate claims for this fixed time period. \\[ \\mathrm{E}[S] = \\mathrm{E}[N] \\mathrm{E}[X] = 40 \\] and \\[ \\mathrm{Var}[S] = \\mathrm{E}[N] (\\mathrm{E}[X^2] - (\\mathrm{E}[X])^2 ) + \\mathrm{Var}[N] (\\mathrm{E}[X])^2 = 3066.6666667 .\\] 2. Suppose that a policy deductible of 20 is in place. Then \\[\\begin{aligned} \\mathrm{E}[\\max(0, X - 20)] &amp;= \\int_{20}^{100} (x - 20) \\frac{1}{100} \\, dx\\\\ &amp;= 32. \\end{aligned}\\] Therefore, the expected insurer’s payout is \\[ \\mathrm{E}[N]\\mathrm{E}[\\max(0, X - 20)] = (0.8)(32) = 25.6. \\] 6.6 Tutorial 4 Given \\(X \\sim \\mathcal{G}(\\alpha, \\lambda)\\), find the distribution of \\(Y = kX\\) for some positive \\(k\\). Repeat the same question if \\(X \\sim \\mathcal{G}(\\alpha, \\lambda)\\), and \\(X \\sim \\mathcal{LN}(\\mu, \\sigma^2)\\). \\(X \\sim \\mathcal{Pa}(\\alpha, \\lambda)\\). Aggregate claims from a risk in a given time have a compound Poisson distribution with Poisson parameter \\(\\lambda = 200\\) and an individual claim amount distribution that is an exponential distribution with mean 500. The insurer has effected proportional reinsurance with proportion retained \\(\\alpha = 0.8\\). Find the distribution of \\(S_I\\) and \\(S_R\\) and their means and variances. Compare the variances \\(Var[S_I] +Var[S_R]\\) and \\(Var[S]\\). Comment on the results obtained. Show that if \\(N \\sim \\mathcal{NB}(k,p)\\) represents the distribution of claim numbers, then the number of non-zero claims for the reinsurer is \\[N_R \\sim \\mathcal{NB}(k,p^*),\\] where \\(p^* = p/(p + (1-p)\\pi_M\\)) and \\(\\pi_M = Pr(X &gt; M)\\) for the claim size random variable \\(X\\). The number of claims \\(N\\) per a fixed time period has the following distribution: \\[Pr(N = 0) = 0.5, Pr(N = 1) = 0.3, Pr(N = 2) = 0.1, \\text{ and } Pr(N = 3) = 0.1.\\] The loss distribution has Pareto distribution \\(Pa(4,1)\\). Assume that the number of claims and the amount of losses are mutually independent. Find the mean and variance of the aggregate claims for this fixed time period. 6.7 Solutions to Tutorial 4 Given \\(X \\sim \\mathcal{G}(\\alpha, \\lambda)\\), the distribution of \\(Y = kX\\) can be founded by using the moment generating function. \\[\\begin{aligned} M_Y(t) &amp;= M_{kX}(t) = \\mathrm{E}[e^{(tk)X}] = M_X(kt) \\\\ &amp;= \\left(\\frac{\\lambda}{\\lambda - kt}\\right)^\\alpha \\\\ &amp;= \\left(\\frac{\\lambda/k}{\\lambda/k - t}\\right)^\\alpha \\end{aligned}. \\] Therefore, \\(Y \\sim \\mathcal{G}(\\alpha, \\lambda/k)\\). Note that for \\(X \\sim \\mathcal{LN}(\\mu, \\sigma^2)\\), \\[F_X(x) = \\Pr(X \\le x) = \\Pr(\\ln(X) \\le \\ln(x)) = \\Pr(Z \\le \\frac{\\ln(X) - \\mu}{\\sigma}),\\] where \\(Z \\sim N(0,1)\\). Consider \\[\\begin{aligned} F_Y(x) &amp;= \\Pr(Y \\le x) = \\Pr(kX \\le x) \\\\ &amp;= \\Pr(\\ln(X) \\le \\ln(x/k)) \\\\ &amp;= \\Pr(\\frac{\\ln(X) - \\mu}{\\sigma} \\le \\frac{\\ln(x) - \\ln(k) - \\mu}{\\sigma} ) \\\\ &amp;= \\Pr(Z \\le \\frac{\\ln(x) - \\ln(k) - \\mu}{\\sigma} ). \\end{aligned} \\] It follows that \\(Y = kX \\sim \\mathcal{LN}(\\mu + \\ln(k), \\sigma^2)\\). Given \\(X \\sim \\mathcal{Pa}(\\alpha, \\lambda)\\), \\(F_X(x) = 1 - \\left(\\frac{\\lambda}{\\lambda + x}\\right)^\\alpha\\). Therefore, \\[\\begin{aligned} F_Y(x) &amp;= \\Pr(Y \\le x) = \\Pr(kX \\le x) = \\Pr(X \\le x/k) \\\\ &amp;= 1 - \\left(\\frac{\\lambda}{\\lambda + (x/k)}\\right)^\\alpha \\\\ &amp;= 1 - \\left(\\frac{\\lambda k}{\\lambda k + x}\\right)^\\alpha. \\end{aligned}\\] Therefore, \\(Y = kX \\sim \\mathcal{Pa}(\\alpha, k\\lambda)\\). Given \\(X \\sim \\text{Exp}(\\beta)\\), \\(kX \\sim \\text{Exp}(\\beta/k)\\), for \\(k &gt; 0\\). From \\(X \\sim \\text{Exp}(1/500)\\), the aggregate claim amount paid by the direct insurer \\(S_I\\) is \\[S_I \\sim \\mathcal{CP}(200,F_Y), \\quad Y= \\alpha X \\sim \\text{Exp}(\\frac{1}{ (0.8) (500) })\\] and the aggregate claim amount paid by the direct insurer \\(S_R\\) is \\[S_R \\sim \\mathcal{CP}(200,F_Z), \\quad Z= (1-\\alpha) X \\sim \\text{Exp}(\\frac{1}{ (0.2) (500) })\\] Moreover, \\[ \\mathrm{E}[Y] = 400, \\quad \\mathrm{E}[Y^2] = 3.2\\times 10^{5}, \\] \\[ \\mathrm{E}[Z] = 100, \\quad \\mathrm{E}[Z^2] = 2\\times 10^{4}. \\] The total expected total claim payout of the insurer and its variance are \\[ \\mathrm{E}[S_I] = 8\\times 10^{4}, \\quad \\mathrm{Var}[S_I] = 6.4\\times 10^{7}.\\] The total expected total claim payout of the reinsurer and its variance are \\[ \\mathrm{E}[S_R] = 2\\times 10^{4}, \\quad \\mathrm{Var}[S_R] = 4\\times 10^{6}.\\] Alternatively, we know that \\[ \\mathrm{E}[S] = (200)\\mathrm{E}[X] = 10^{5}, \\quad \\mathrm{Var}[S] = (200)\\mathrm{E}[X^2] = 10^{8}.\\] Hence, \\[ \\mathrm{E}[S_I] = \\mathrm{E}[\\alpha S] = (0.8)\\mathrm{E}[S] = 8\\times 10^{4}, \\quad \\mathrm{Var}[S_I] = \\mathrm{Var}[\\alpha S] = (0.8)^2\\mathrm{Var}[S] = 6.4\\times 10^{7}.\\] \\[ \\mathrm{E}[S_R] = \\mathrm{E}[(1-\\alpha) S] = (0.2)\\mathrm{E}[S] = 2\\times 10^{4}, \\quad \\mathrm{Var}[S_R] = \\mathrm{Var}[(1-\\alpha) S] = (0.2)^2\\mathrm{Var}[S] = 4\\times 10^{6}.\\] 2. It follows that \\(\\mathrm{Var}[S_I] + \\mathrm{Var}[S_R] = 6.8\\times 10^{7} &lt; 10^{8} = \\mathrm{Var}[S]\\). After effecting proportional reinsurance proportion, there is a reduction in the variability of the amount paid out by the insurer on claims. Given \\(N \\sim \\mathcal{NB}(k,p)\\), the probability generating function of \\(N\\) is \\[P_N(r) = \\left(\\frac{p}{1- qr}\\right)^k,\\] where \\(q = 1 - p\\). Define the indicator random variable \\(\\{I_j\\}_{j=1}^\\infty\\), where \\[\\begin{aligned} I_j = \\begin{cases} 1 &amp;\\text{if } X_j &gt; M\\\\ 0 &amp;\\text{if } X_j \\le M. \\end{cases}\\end{aligned}\\] Therefore, the number of non-zero claims for the reinsurer is \\[N_R = \\sum_{j= 1}^{N} I_j.\\] The variable \\(N_R\\) has a compound distribution with its probability generating function \\[P_{N_R}(r) = P_N[P_I(r)],\\] where \\(P_I\\) is the probability generating function of the indicator random variable. It can be shown that \\[P_I(r) = 1 - \\pi_M + \\pi_M r,\\] where \\(\\pi_M = \\Pr(I_j = 1) = \\Pr(X_j &gt; M) = 1 - F(M)\\). Therefore, \\[P_{N_R}(r) = P_N[P_I(r)] = \\left(\\frac{p}{1- q(1 - \\pi_M + \\pi_M r)}\\right)^k.\\] Let \\(p* = \\frac{p}{p + q \\pi_M}\\). By dividing both the numerator and the denominator above by \\(p + q \\pi_M\\), we have \\[P_{N_R}(r) = \\left(\\frac{p^*}{1 - q^* r}\\right)^k,\\] and \\(N_R \\sim \\mathcal{NB}(k,p^*).\\) The number of claims \\(N\\) per a fixed time period has the following distribution: \\[\\Pr(N = 0) = 0.5, \\Pr(N = 1) = 0.3, \\Pr(N = 2) = 0.1, \\text{ and } \\Pr(N = 3) = 0.1.\\] Then, \\(\\mathrm{E}[N] = 0.8\\) and \\(\\mathrm{Var}[N] = 0.96\\). The loss distribution has Pareto distribution \\(X \\sim Pa(4,1)\\). Therefore, \\(\\mathrm{E}[X] = 0.3333333\\) and \\(\\mathrm{E}[X^2] = 0.3333333\\). Therefore, the mean and variance of the aggregate claim amount for this fixed time period. \\[ \\mathrm{E}[S] = \\mathrm{E}[N] \\mathrm{E}[X] = 0.2666667 \\] and \\[ \\mathrm{Var}[S] = \\mathrm{E}[N] (\\mathrm{E}[X^2] - (\\mathrm{E}[X])^2 ) + \\mathrm{Var}[N] (\\mathrm{E}[X])^2 = 0.2844444 .\\] 6.8 Tutorial 5 Aggregate claims from a risk in a given time have a compound Poisson distribution with Poisson parameter \\(10\\) and an individual claim amount distribution that is a Pareto distribution \\(Pa(3,2000)\\). The insurer sets a premium using the expected value principle with relative security loading of 0.15. The insurer is considering effecting excess of loss reinsurance with retention limit \\(1200\\). The reinsurance premium would be calculated using the same principle with relative security loading of 0.2. Calculate the insurer’s expected profit before reinsurance. Under excess of loss reinsurance, the insurer’s profit is defined to be the premium charged by the insurer, less the reinsurance premium and less the claim paid by the insurer (also called net of reinsurance). Calculate the insurer’s expected profit after effecting excess of loss reinsurance. Comments on these results. Aggregate claims from a risk in a given time have a compound Poisson distribution with Poisson parameter \\(80\\) and an individual claim amount distribution that is an exponential distribution with mean 10. The insurer has effected excess of loss reinsurance with retention level \\(M = 20\\). Find the distribution of \\(S_I\\) and \\(S_R\\) and their means and variances. Compare the variances \\(Var[S_I] +Var[S_R]\\) and \\(Var[S]\\). Comment on the results obtained. Aggregate claims \\(S\\) have a compound Poisson distribution \\(\\mathcal{CP}(\\lambda,F_X)\\) where \\(\\lambda = 0.5\\) and an individual claim amounts \\(X\\) are either 1, 2 or 3 with probability 1/2, 1/4 and 1/4 respectively. Calculate \\(g_r\\) for \\(r = 0,1,\\ldots, 10\\). (Required the use of Excel or R) Suppose \\(\\{ S(t) \\}_{t \\ge 0}\\) is a compound Poisson process with Poisson parameter 1 and individual claim distribution that is an exponential distribution \\(Exp(1)\\) so that for each fixed \\(t\\), \\(S(t) \\sim \\mathcal{CP}(t, F_X)\\) where \\(F_X(x) = 1 - e^{-x}\\), for \\(x &gt; 0\\). Calculate the mean, variance and coefficient of skewness of \\(S(1)\\). Use (a) the normal approximation and (b) the translated Gamma approximation to approximate the values of \\(Pr(S(10) &gt; 20)\\). Use (a) the normal approximation and (b) the translated Gamma approximation to approximate the values of \\(Pr(S(100) &gt; 120)\\). 6.9 Solutions to Tutorial 5 Aggregate claims \\(S\\) from a risk in a given time have a compound Poisson distribution \\(S \\sim \\mathcal{CP}(10,F_X)\\) where \\(X \\sim \\mathcal{Pa}(\\alpha,\\beta) = \\mathcal{Pa}(3,2000)\\). Using the expected value principle, the insurer sets a premium before reinsurance \\(P = (1 + \\theta)\\mathrm{E}[S]\\) with relative security loading of \\(\\theta = 0.15\\). The insurer’s expected profit before reinsurance can be obtained from \\[\\begin{aligned} \\mathrm{E}[\\text{Profit}] &amp;= \\mathrm{E}[P-S] \\\\ &amp;= P- \\mathrm{E}[S] \\\\ &amp;= (1 + \\theta)\\mathrm{E}[S] - \\mathrm{E}[S] \\\\ &amp;= \\theta\\mathrm{E}[S] \\end{aligned}\\] Note that \\(\\mathrm{E}[S] = \\lambda \\mathrm{E}[X] = (10)(1000) = 10^{4}\\). Hence \\(\\mathrm{E}[\\text{Profit}] = 1500\\). 2. The insurer is considering effecting excess of loss reinsurance with retention limit $M = 1200$. The reinsurance premium would be calculated using the same principle with relative security loading of \\(\\theta_R = 0.2\\). The insurer’s expected profit after reinsurance can be obtained from (in terms of \\(\\mathrm{E}[S]\\) and \\(\\mathrm{E}[S_R]\\)) \\[\\begin{aligned} \\mathrm{E}[\\text{Profit (after reinsurance)}] &amp;= \\mathrm{E}[P- P_R - S_I] \\\\ &amp;= P- P_R - \\mathrm{E}[S_I] \\\\ &amp;= P- P_R - \\mathrm{E}[S - S_R] \\\\ &amp;= (1 + \\theta)\\mathrm{E}[S] - (1 + \\theta_R)\\mathrm{E}[S_R] - \\mathrm{E}[S] + \\mathrm{E}[S_R]\\\\ &amp;= \\theta\\mathrm{E}[S] - \\theta_R\\mathrm{E}[S_R] \\end{aligned},\\] where \\(P_R\\) is the reinsurer premium. The total claim amount paid by reinsurer \\(S_R \\sim \\mathcal{CP}(10 \\pi_M,F_W)\\), where \\(\\pi_M = \\Pr(X &gt; M)\\) is the proportion of claims involved the reinsurer, \\(W \\sim X - M|X &gt; M\\) and \\(F_W \\sim \\mathcal{Pa}(\\alpha,\\beta + M) = \\mathcal{Pa}(3,3200)\\). It follows that \\[\\mathrm{E}[S_R] = (10)(0.2441406)\\mathrm{E}[W] = (10)(0.2441406)(1600) = 3906.25.\\] Substituting this into the above equation yields \\[ \\mathrm{E}[\\text{Profit (after reinsurance)}] = 718.75.\\] Consider the variance of the profit, firstly without reinsurance. The insurer’s profit is equal to premiums charged less claims paid. Since only the claims are random, the variance of the profit (before reinsurance) is the same as the variance of the total claims. \\[ \\mathrm{Var}[\\text{Profit (without reinsurance)}] = 4\\times 10^{7}.\\] With reinsurance, the insurer’s profit is equal to premiums charged less the reinsurance premium less the net claims paid. So if the insurer’s aggregate net claims paid are \\(S_I\\) , then the variance of the profit is equal to the variance of \\(S_I\\). \\[ \\mathrm{Var}[\\text{Profit (with reinsurance)}] = 5.625\\times 10^{6}.\\] The percentage reduction in the expected profit is 52.08\\(\\%\\). The percentage reduction in the standard deviation of the profit is 62.5\\(\\%\\). Note that here the reinsurance has a greater effect on the variability of the claim size than on the average, ie the standard deviation is reduced by a greater percentage than the mean. This is very often the case for excess-of-loss reinsurance. Given \\(X \\sim \\text{Exp}(\\beta)\\) with \\(\\beta = 1/10\\), The aggregate claim amount paid by the direct insurer \\(S_I\\) is \\[S_I \\sim \\mathcal{CP}(80,F_Y), \\quad Y= \\min(X,M)\\] The distribution and its first two moments of \\(Y\\) can be found as shown in the lecture note (Section 3.4 Excess of Loss Reinsurance) or by using the moment generating function. Here we will use the moment generating function. From \\(X \\sim \\mathrm{Exp}(\\beta) = \\mathrm{Exp}(1/\\mu)\\) (Note that \\(\\mu\\) is the expected value of \\(X\\)), \\[ M_Y(t) = \\frac{1}{1- \\mu t} ( 1 - \\mu p t e^{Mt}),\\] where \\(p = \\Pr(X &gt; M) = e^{-\\lambda M} = e^{-\\lambda/\\mu}\\) is the proportion of claims which involve the reinsurer (see the link for more helps) It follows that \\[\\begin{aligned} \\mathrm{E}[Y] &amp;= M_Y&#39;(0) = (1 - p)\\mu = 8.6466472 \\\\ \\mathrm{E}[Y^2] &amp;= M_Y&#39;&#39;(0) = -2 \\mu (M p + (-1 + p) \\mu) = 118.7988301. \\end{aligned} \\] The total expected total claim payout of the insurer and its variance are \\[ \\mathrm{E}[S_I] = \\lambda \\mathrm{E}[Y] = 691.7317734, \\quad \\mathrm{Var}[S_I] = \\lambda \\mathrm{E}[Y^2] = 9503.9064046.\\] The aggregate claim amount paid by the reinsurer \\(S_R\\) is \\[S_R \\sim \\mathcal{CP}(80,F_Z), \\quad Z= \\max(0,X-M)\\] It follows that \\[\\begin{aligned} \\mathrm{E}[Z] &amp;= p\\mu = 1.3533528 \\\\ \\mathrm{E}[Z^2] &amp;= 2 \\mu^2 p = 27.0670566. \\end{aligned} \\] The total expected total claim payout of the insurer and its variance are \\[ \\mathrm{E}[S_R] = \\lambda \\mathrm{E}[Z] = 108.2682266, \\quad \\mathrm{Var}[S_R] = \\lambda \\mathrm{E}[Z^2] = 2165.3645318.\\] 2. It follows that \\(\\mathrm{Var}[S_I] + \\mathrm{Var}[S_R] = 1.1669271\\times 10^{4} &lt; 1.6\\times 10^{4} = \\mathrm{Var}[S]\\). After excess of loss reinsurance arrangement, there is a reduction in the variability of the amount paid out by the insurer on claims. From Panjer’s recursion formula, \\[ g_r = \\frac{\\lambda}{r}\\sum_{j=1}^r j f_j g_{r-j}.\\] Therefore, \\[\\begin{aligned} g_0 &amp;= e^{-\\lambda} = 0.606531 \\\\ g_1 &amp;= \\lambda f_1 g_0 = 0.151633 \\\\ g_2 &amp;= (\\lambda/2)(f_1 g_1 + 2 f_2 g_0) = 0.09477 \\\\ g_3 &amp;= (\\lambda/3)(f_1 g_2 + 2 f_2 g_1 + 3 f_3 g_0) = 0.09635 \\\\ g_4 &amp;= (\\lambda/4)(f_1 g_3 + 2 f_2 g_2 + 3 f_3 g_1) = 0.026161 \\\\ &amp;\\vdots \\\\ g_r &amp;= (\\lambda/r)(f_1 g_{r-1} + 2 f_2 g_{r-2} + 3 f_3 g_{r-3}). \\end{aligned} \\] Also \\(g_5 - g_{10} = 0.013233, 0.007663, 0.002148, 9.27\\times 10^{-4}, 4.05\\times 10^{-4}, 1.14\\times 10^{-4}\\), respectively. 6.10 Tutorial 6 Suppose \\(S \\sim \\mathcal{CP}(\\lambda, F_X)\\) where individual claim amounts are distributed on the positive integers and \\(\\lambda = 0.5\\). An individual claim amounts \\(X\\) are either 1 or 2 with probability 2/3 and 1/3 respectively. Write down an expression for \\(E[S]\\) in terms of \\(\\lambda\\) and the mean of \\(X\\). Use Panjer’s recursion to show that \\[g_r = \\frac{1}{3r} (g_{r-1} + g_{r-2}), \\quad r = 2,3,\\ldots.\\] Calculate \\(g_r\\) for \\(r = 0,1,2, 3, 4\\). Verify that \\(\\sum_{r=0}^4 g_r &gt; 0.995\\). Compare \\(\\sum_{r=0}^4 r g_r\\) with the exact mean of \\(S\\) computed by using 1.1. Comment on the results. Consider a portfolio of 1000 life insurance policies over a one-year time period. For each policy at most one claim can occur in the year. The probability that a claim occurs is 0.04. Claim amounts are distributed \\(X \\sim Exp(1/2)\\). Calculate the mean and variance of the aggregate claims. Calculate the relative security loading \\(\\theta_1\\) such that the probability of a profit on this portfolio is 0.95. Suppose that the insurer imposes a deductible of 1. Calculate the mean and the variance of the aggregate claim paid by the insurer. Also calculate the relative security loading \\(\\theta_2\\) such that the probability of a profit on this portfolio is 0.95. Comment on the difference between \\(\\theta_1\\) and \\(\\theta_2\\). A portfolio of 5000 life insurance policies for one year term with the benefit amount as shown in the table Benefit amount 1 2 Number of policies 4000 1000 The policyholders can be assumed to be independent and the probability that a claim occurs is 0.03. Calculate the mean and variance of the aggregate claims. Use the normal approximation to compute \\(Pr(S &gt; 200)\\) The insurer aims to reduce the size of \\(Pr(S &gt; 200)\\). The insurer arranges excess loss reinsurance with retention 1.5. The reinsurer calculates the reinsurance premium \\(P_R\\) by using the relative security loading of 20%. Calculate the reinsurPrance premium. After reinsurance, calculate the mean and variance of the aggregate claims paid out by the insurer, i.e. \\(E[S_I]\\) and \\(E[S_I]\\). Calculate \\(Pr(S_I + P_R &gt; 200)\\). Comment on the results. An insurance company issues travel insurance policies. There are two types of claims with a maximum of one claim per policy. Type I claims for delay : Claim amounts follow an Exponential distribution with parameter \\(\\lambda = 0.002\\). Type II claims for a flight cancellation: Claim amounts follow a Uniform distribution \\(U(20,000, 50,000)\\). Suppose that 10% of policies result in a claim, 80% of which are Type I and the remaining are type II. Calculate the premium charged for each policy provided that a premium loading factor of 10% is applied. 6.11 Solutions to Tutorial 6 \\(S \\sim \\mathcal{CP}(\\lambda, F_X)\\) where \\(\\lambda = 0.5\\) and an individual claim amounts \\(X\\) are either 1 or 2 with probability 2/3 and 1/3 respectively. \\(E[S] = \\lambda \\cdot E[X]\\). The Panjer’s recursion formula \\(g_r\\) can be recursively calculated by \\(g_0 = p_0 = \\Pr(S = 0) = \\exp(-\\lambda)\\), \\(g_r= \\Pr(S = r) = \\frac{\\lambda}{r}\\sum_{j=1}^r j\\cdot f_j \\cdot g_{r-j} = = \\frac{\\lambda}{r}\\sum_{j=1}^2 j\\cdot f_j \\cdot g_{r-j}, \\quad r = 1,2 \\ldots.\\) This follows from \\(f_j = 0\\) for \\(j \\ge 3\\). Hence, \\[g_r = \\frac{1}{2r}(1\\cdot\\frac{2}{3}\\cdot g_{r-1} + 2\\cdot\\frac{1}{3}\\cdot g_{r-2}) = \\frac{1}{3r} (g_{r-1} + g_{r-2}),\\] for \\(r = 2,3,\\ldots\\). 3. Following the Panjer&#39;s recursion formula, we have \\[ \\begin{aligned} g_0 &amp;= 0.6065307 \\\\ g_1 &amp;= 0.2021769 \\\\ g_2 &amp;= 0.1347846 \\\\ g_3 &amp;= 0.0374402 \\\\ g_4 &amp;= 0.0143521. \\end{aligned} \\] 4. Clearly, \\(\\sum_{r=0}^4 g_r &gt; 0.995\\). 5. From 1.1, \\(E[S] = \\lambda \\cdot E[X] = \\frac{1}{2} \\cdot \\frac{4}{3} = \\frac{2}{3}\\). However, \\[\\sum_{r=0}^4 r \\cdot g_r \\approx 0.6418.\\] 6. Truncating the distribution of \\(S\\) at \\(r=4\\) gives more than 99.5% of the probability mass but only \\(\\frac{0.6418}{2/3} \\approx 96\\%\\) of the mean. The aggregate claim \\(S\\) in this portfolio has a compound binomial distribution, denoted by \\(\\mathcal{CB}(n,p,F_X)\\) with \\(n = 100\\), \\(p = 0.04\\) and \\(X \\sim Exp(\\lambda)\\), where \\(\\lambda = 1/2\\). From \\(X \\sim Exp(1/2)\\), \\[ \\begin{aligned} E[X] &amp;= 1/\\lambda = 2 \\\\ E[X^2] &amp;= 2/\\lambda^2 = 8. \\end{aligned} \\] It follows that \\[ \\begin{aligned} E[S] &amp;= n p m_1 = 80, \\\\ Var[S] &amp;= np m_2 - n p^2 m_1^2 = 313.6. \\end{aligned} \\] 2. The profit on this portfolio is \\[(1+\\theta)E[S] - S.\\] To calculate the relative security loading \\(\\theta_1\\) such that the probability of a profit on this portfolio is 0.95, we require \\[0.95 = \\Pr((1+\\theta)E[S] - S).\\] Suppose that the aggregate claims can be approximated by the normal distribution, i.e. \\(S \\sim \\mathcal{N}(\\mathrm{E}[S],\\mathrm{Var}[S]) = \\mathcal{N}(80,313.6)\\). Therefore, \\[ \\begin{aligned} 0.95 &amp;= \\Pr( P - S &gt; 0) \\\\ &amp;= \\Pr( ( 1 + \\theta_1)(80) - S &gt; 0) \\\\ &amp;= \\Pr( S &lt; ( 1 + \\theta_1)(80) ) \\\\ &amp;= \\Pr( Z &lt; \\frac{( 1 + \\theta_1)(80) - 80 }{\\sqrt{313.6}} ) \\\\ &amp;= \\Pr( Z &lt; \\frac{( \\theta_1)(80) }{\\sqrt{313.6}} ). \\end{aligned} \\] This gives \\(\\frac{( \\theta_1)(80) }{\\sqrt{313.6}} = 1.6448536\\) and \\[\\theta_1 = 0.3641039.\\] 3. Suppose that the insurer imposes a deductible of \\(d= 1\\). Let \\[Y^* = X-d|X&gt;d\\] be the claim amount with which the insurer is involved. Note that for \\(X \\sim Exp(\\lambda)\\), where \\(\\lambda = 1/2\\), \\(Y^* \\sim Exp(\\lambda) = Exp(1/2)\\) (due to the memorylessness property of the exponential distributions). Hence, \\[ \\begin{aligned} E[Y^*] &amp;= 1/\\lambda = 2 \\\\ E[(Y^*)^2] &amp;= 2/\\lambda^2 = 8. \\end{aligned} \\] With the deductible in place, the probability of a claim is \\[p^* = p \\cdot \\Pr(X &gt; d) = p \\cdot e^{-\\lambda d} = 0.0242612\\] Hence, \\[ \\begin{aligned} E[S^*] &amp;= n p^* E[Y^*] = 48.5224528, \\\\ Var[S^*] &amp;= np^* E[(Y^*)^2] - n (p^*)^2 (E[Y^*])^2 = 191.7353827. \\end{aligned} \\] Then, using the same argument as before, we have \\(\\theta_2 = 0.3641039.\\) 4. With the deductible, the security loading has gone up. The deductible has reduced the variability from \\(\\sqrt(313.6)\\) to \\(\\sqrt(191.7353827)\\). Moreover, the expected claim amount has been reduced by a greater factor from \\(80\\) to \\(48.5224528\\). Using a normal approximation, the relative security loading depends on the coefficient of variation, which is defined by the ratio of the standard deviation to the mean, \\[\\text{CV = Standard Deviation/Mean}.\\] The larger this is, the larger the relative security loading required, which can be varified by \\[\\frac{\\sqrt{313.6}}{80} &lt; \\frac{\\sqrt{191.7353827}}{48.5224528}.\\] From A portfolio of 5000 life insurance policies for one year term with the benefit amounts Benefit amount 1 2 Number of policies 4000 1000 The aggregate claims \\(S\\) is given by \\[S = 1\\cdot N1 +2\\cdot N2, \\] where \\(N_1 \\sim Bin(4000,0.03)\\) and \\(N_2 \\sim Bin(1000,0.03)\\) are the number of claims with the benefit amounts of 1 and 2, respectively. Therefore, \\[ \\begin{aligned} E[S] &amp;= 1\\cdot E[N1] +2\\cdot E[N2] = 180, \\\\ V[S] &amp;= 1^2\\cdot V[N1] +2^2\\cdot V[N2] = 232.8. \\end{aligned} \\] 2. Suppose that the aggregate claims can be approximated by the normal distribution, i.e. \\(S \\sim \\mathcal{N}(\\mathrm{E}[S],\\mathrm{Var}[S]) = \\mathcal{N}(180,232.8)\\). It follows that \\[ \\begin{aligned} \\Pr(S &gt; 200) &amp;= \\Pr(\\frac{S - E[S]}{\\sqrt{V[S]}} &gt; \\frac{200 - 180}{\\sqrt{232.8}}) \\\\ &amp;= \\Pr(Z &gt; 1.3108063) \\\\ &amp;= 0.0949616. \\end{aligned} \\] 3. Let \\(S_R\\) be the aggregate claim amount paid by the reinsurer. With the retention limit of 1.5, \\[E[S_R] = 1000 \\cdot (2 - 1.5) \\cdot p = 15.\\] Therefore, \\[P_R = (1 + \\theta_R) \\cdot E[S_R] = 18.\\] 4. After the reinsurance arrangement, \\[E[S_I] = E[S] - E[S_R] = 165.\\] By replacing 2 by 1.5 in 3.1, \\[V[S_I] = 181.875.\\] 5. To calculate \\(\\Pr(S_I + P_R &gt; 200)\\), we assume that the aggregate claims can be approximated by the normal distribution, i.e. \\(S_I \\sim \\mathcal{N}(\\mathrm{E}[S_I],\\mathrm{Var}[S_I]) = \\mathcal{N}(165,181.875)\\). It follows that \\[ \\begin{aligned} \\Pr(S_I + P_R &gt; 200) &amp;= \\Pr(S_I &gt; 200 - P_R) \\\\ &amp;= \\Pr(\\frac{S_I - E[S_I]}{\\sqrt{V[S_I]}} &gt; \\frac{200 - 18 - 180}{\\sqrt{232.8}}) \\\\ &amp;= \\Pr(Z &gt; 1.2605568) \\\\ &amp;= 0.1037343. \\end{aligned} \\] 6. The probability that \\(\\Pr(\\text{Cost} &gt; 200)\\) has increased from 0.0949616 to 0.1037343, i.e. about 9.2381258%. This reflects the fact that the cost of the reinsurance \\(P_R\\) is too expensive. Let \\(X\\) denote an individual claim amount. From the conditional expectation formula, it follows that \\[ \\begin{aligned} E[X] &amp;= E[E[X|\\text{type}]] \\\\ &amp;= \\Pr(\\text{Type I}) \\, E[X|\\text{Type I}] + \\Pr(\\text{Type II}) \\, E[X|\\text{Type II}] \\\\ &amp;= 0.8 \\cdot 500 + 0.2 \\cdot 3.5\\times 10^{4} \\\\ &amp;= 7400. \\end{aligned} \\] Furthermore, assuming that 10% of policies result in a claim and that a premium loading factor of 10% is applied, the premium is \\[0.1 \\cdot 7400\\cdot (1 + 0.15) = 851.\\] 6.12 Tutorial 7 An insurer has initial surplus \\(u\\) of 5.5 (in suitable units) and receives premium payments at a rate of 3 per year. Suppose claims from a portfolio of insurance over the first two years are as follows: Time (years) 0.3 0.8 1.5 Amount 4 6 2 Plot a surplus process and determine whether ruin occurs within the first two years in each of the following cases: Ruin was checked continuously. Ruin was checked only at the end of each year. Suppose that the insurer has arranged excess loss reinsurance with retention limit 3.5. The reinsurance premium is 1 per year to be paid continuously. Plot a surplus process and determine whether ruin occurs within the first two years n each of the following cases: Ruin was checked continuously. Ruin was checked only at the end of each year. Comment on the results. The aggregate claims process for a risk is compound Poisson with Poisson parameter 0.1 per year. Individual claim amounts \\(X\\) have the following distribution: \\(x\\) 50 75 120 \\(Pr(X = x)\\) 0.7 0.25 0.05 The insurer’s initial surplus is 100 (in suitable units) and the insurer calculate the premium using a relative security loading of 10% on the expected amount of annual aggregate claim at the beginning of each year. Calculate the probability that the insurer’s surplus at time 2 will be negative. The aggregate claims process for a risk is compound Poisson with Poisson parameter 0.1 per year. Individual claim amounts \\(X\\) have the following distribution: \\(x\\) 1 2 \\(Pr(X = x)\\) 0.7 0.3 The insurer’s initial surplus is 0.3 (in suitable units) and the premium rate is 0.4 per year, received continuously. Calculate the following probabilities of ruin. \\(\\psi(0.3,1).\\) \\(\\psi(0.3,2).\\) 6.13 Solutions to Tutorial 7 The insurer’s surplus (or cash flow) at any future time \\(t\\) (&gt; 0) is a random variable, since its value depends on the claims experience up to time \\(t\\). The insurer’s surplus at time \\(t\\) is a random variable. The insurer’s surplus at time \\(t\\) is denoted \\(U(t)\\). The following formula for \\(U(t)\\) can be written as \\[\\begin{equation} U(t) = u + ct - S(t) = 5.5 + 3 t - S(t), \\end{equation}\\] where the aggregate claim amount up to time \\(t\\), \\(S(t)\\) is \\[\\begin{equation} S(t) = \\sum_{i = 1}^{N(t)} X_i . \\end{equation}\\] The following table summarises the values of the surplus function at the time when claims occurs. Time Surplus (before claim) Surplus (after claim) 0 5.5 5.5 0.3 6.4 2.4 0.8 3.9 -2.1 1.5 0 -2 The surplus function increases at a constant rate \\(c\\) until there is a claim and the surplus drops by the amount of the claim. The surplus then increases again at the same rate \\(c\\) and drops are repeated when claims occur. In this example, ruin occurs at time 1.5. The plot of the surplus process is given in the following figure. Figure 6.1: The surplus process befor reinsurance arrangment. Ruin occurs at time 0.8 when ruin is checked continuously. Similarly, we have \\(U(1) = -1.5\\) and \\(U(2) = -0.5\\). Therefore, ruin occurs at time 1 and 2 when ruin is checked at the end of each year. The insurer’s net premium income is 2 per year. The insurer’s cash flow or surplus process is now given by \\[\\begin{equation} U_I(t) = u + (c - c_r)t - S_I(t) = 5.5 + (3 - 1) t - S_I(t), \\end{equation}\\] where \\(c_r\\) is the reinsurance premium rate. Claims that are involved the insurer after are Time (year) 0.3 0.8 1.5 Amount 3.5 3.5 2 The following table summarises the values of the surplus function at the time when claims occurs. Time Surplus (before claim) Surplus (after claim) 0 5.5 5.5 0.3 6.1 2.6 0.8 3.6 0.1 1.5 1.5 -0.5 Figure 6.2: The surplus process under a reinsurance arrangement. Under the reinsurance arrangement, Ruin occurs at time 1.5 when ruin is checked continuously. Similarly, we have \\(U(1) = 0.5\\) and \\(U(2) = 0.5\\). Therefore, ruin does not occur when ruin is checked at the end of each year. According to the property of the aggregate claims process \\(S(t)\\), the aggregate claims in the \\(n\\)th year, for \\(n = 1,2, \\ldots\\) are \\(S(n) - S(n-1) \\sim \\mathcal{CP}(\\lambda, F_X(x))\\), all of them have the same compound Poisson distribution with the same parameters. Hence, the premium rate per year will be constant which can be obtained from \\[c = (1 + \\theta)\\text{E}[S],\\] where \\(\\theta = 0.1\\). Note that \\(\\text{E}[S] = \\lambda \\text{E}[X] = 0.1 \\cdot 59.75 = 5.975\\) and hence \\(c = 6.5725.\\) The surplus at time 2 is \\[U(2) = u + ct - S(2) = 100 + 6.5725 \\cdot 2 - S(2) = 113.145 - S(2).\\] So the required probability is \\[\\Pr(U(2) &lt; 0) = \\Pr(S(2) &gt; 113.145) = 1- \\Pr(S(2) \\le 113.145).\\] We consider all possibilities that \\(S(2) \\le s0\\). According to the information from the following table, Number of claims Amount of claims 0 claim 0 1 claim 50 or 75 2 claims 100 = 50 + 50 It follows that \\[ \\begin{aligned} \\Pr(S(2) \\le 113.145) &amp;= \\Pr(N(2) = 0) + \\Pr(N(2) = 1 \\text{ and } X_1 = 50) \\\\ &amp;+ \\Pr(N(2) = 1 \\text{ and } X_1 = 70) + \\Pr(N(2) = 2 \\text{ and } X_1 = X_2 = 50).\\\\ \\end{aligned} \\] Note that \\[ \\begin{aligned} \\Pr(N(2) = 0) &amp;= 0.8187308 \\\\ \\Pr(N(2) = 1 \\text{ and } X_1 = 50) &amp;= \\Pr(N(2) = 1) \\cdot \\Pr(X_1 = 50) = (0.1637462)(0.7) = 0.1146223 \\\\ \\Pr(N(2) = 1 \\text{ and } X_1 = 75) &amp;= \\Pr(N(2) = 1) \\cdot \\Pr(X_1 = 75) = (0.1637462)(0.25) = 0.0409365 \\\\ \\Pr(N(2) = 2 \\text{ and } X_1 = X_2 = 50) &amp;= \\Pr(N(2) = 2) \\cdot \\Pr(X_1 = 50) \\cdot \\Pr(X_2 = 50)= (0.0163746)(0.7)^2 = 0.0080236 \\end{aligned} \\] Therefore, $(S(2) ) = 0.9823132 and \\[\\Pr(U(2) &lt; 0) = \\Pr(S(2) &gt; 113.145) = 1- \\Pr(S(2) \\le 113.145) = 1 - 0.9823132 = 0.0176868.\\] Ruin will occur in the first year if and only if a claim (of any amount) occurs. Therefore, \\[\\psi(0.3,1) = 1 - \\Pr(N(1) = 0) = 0.0951626.\\] In a two year time interval, ruin will not occur if and only if there are no claims before time 1.75 years (at which point the insurer’s premium income plus initial surplus is equal to 1) AND there are no claims or at most one claim of amount 1 between the time interval 1.75 to 2. \\[ \\begin{aligned} 1- \\psi(0.3,1) &amp;= \\Pr(N(1.75) = 0) \\cdot [ \\Pr(N(2) - N(1.75) = 0 \\text{ or } (N(2) - N(1.75) = 1 \\text{ and } X_1 = 1) ] \\\\ &amp;= \\Pr(N(1.75) = 0) \\cdot [ \\Pr(N(2) - N(1.75) = 0) + \\Pr(N(2) - N(1.75) = 1 \\text{ and } X_1 = 1) ]. \\end{aligned} \\] We have \\[ \\begin{aligned} \\Pr(N(1.75) = 0) &amp;= 0.839457 \\\\ \\Pr(N(2) - N(1.75) = 0) &amp;= 0.9753099 \\\\ \\Pr(N(2) - N(1.75) = 1 \\text{ and } X_1 = 1) &amp;= \\Pr(N(2) - N(1.75) = 1) \\cdot \\Pr(X_1 = 1) = (0.0243827) \\cdot (0.7) = 0.0170679. \\end{aligned} \\] Therefore, \\[1- \\psi(0.3,1) = 0.839457\\cdot (0.9753099 + 0.0170679) = 0.8330585, \\] and \\[\\psi(0.3,1) = 0.1669415.\\] 6.14 Tutorial 8 The table below gives the payments (in 000s THB) in cumulative form in successive development years in respect of a motor insurance portfolio. All claims are assumed to be fully settled by the end of development year 4. Use the chain ladder method to estimate the amount the insurer will pay in the calendar years \\(2018, 2019, 2020 ,2021\\). Development year 0 1 2 3 4 2013 750 768 844 929 1072 Accident 2014 820 876 946 1041 Year 2015 960 997 1096 2016 1040 1087 2017 1180 The table below shows the claims payments (in 000s THB) in cumulative form for a portfolio of insurance policies. All claims are assumed to be fully settled by the end of development year 4 and the payments are made at the middle of each calendar year. The past rates of inflation over the 12 months up to the middle of the given year are as follows: 2014 5% 2015 6% 2016 7% 2017 5% The future rate of inflation from mid-2017 is assumed to be 10% per year. Development year 0 1 2 3 4 2013 880 988 1046 1065 1262 Accident 2014 940 1034 1091 1095 Year 2015 1060 1161 1229 2016 1120 1221 2017 1240 Use the inflation-adjusted chain ladder method to calculate the outstanding claims payments in future years. Using an interest rate of 7% per year, calculate the outstanding claims reserve the insurer should have hold on 1 January 2018. The table below shows the cumulative claims payments and the cumulative number of claims (amounts appear above claim numbers) for a portfolio of insurance policies. All claims are assumed to be fully settled by the end of development year 5 and that the effects of claims-cost inflation have been removed from these data. Use the average cost per claim method to estimate the outstanding claims reserve which should be held at the end of 2017. Development year 0 1 2 3 4 5 2012 2800 2954 3005 3275 3624 3895 420 440 453 493 551 591 2013 3200 3379 3449 3760 4184 460 478 490 533 591 Accident 2014 3800 4004 4078 4454 Year 500 525 531 580 2015 4520 4749 4842 520 549 558 2016 5340 5587 560 589 2017 5840 570 The table below shows the cumulative claims payments and the premium income \\(P\\) for a portfolio of insurance policies. All claims are assumed to be fully settled by the end of development year 4 and that the effects of claims-cost inflation have been removed from these data. Use the Bornhuetter-Ferguson method to estimate the total reserve required to meet the outstanding claims. You may assume that the ultimate loss ratio for accident years 2014-2017 will be 95%. Development year 0 1 2 3 4 \\(P\\) 2013 3597 4226 4547 4807 4989 5937 Accident 2014 4174 4697 5317 5497 6122 Year 2015 4578 5082 5753 6221 2016 4634 5343 6365 2017 5203 6510 6.15 Solutions to Tutorial 8 See the Excel solution file from the Google Classroom. 6.16 Tutorial 9 (Taken from Gray and Pitts) Suppose the number of claims which arise in a year on a group of policies is modelled as \\(X|\\lambda \\sim Poisson(\\lambda)\\) and that we observe a total of 14 claims over a six year period. Suppose also we adopt a \\(\\mathcal{G}(6, 3)\\) distribution as a prior distribution for \\(\\lambda\\). State the maximum likelihood estimate of \\(\\lambda\\) and the prior mean. State the posterior distribution of \\(\\lambda\\), find the mode of this distribution, and hence state the Bayesian estimate of \\(\\lambda\\) under all or nothing loss. Note that if \\(Y \\sim \\mathcal{G}(\\alpha,\\beta)\\) and \\(2\\alpha\\) is an integer, then \\(2\\beta Y \\sim \\mathcal{G}(\\alpha,1/2)\\); that is \\(2\\beta Y \\sim \\chi^2\\) with \\(2 \\alpha\\) degrees of freedom. Using this fact, find the Bayesian estimate of \\(\\lambda\\) under absolute error loss. Find an equal-tailed 95% Bayesian interval estimate of \\(\\lambda\\), that is an interval \\((\\lambda_L, \\lambda_U)\\), such that \\(Pr( \\lambda &gt; \\lambda_U | \\underline{x}) = Pr( \\lambda &lt; \\lambda_L | \\underline{x}) = 0.025\\). Find the credibility estimate (the Bayesian estimate under squared-error loss) of \\(\\lambda\\). Recall that the data \\(x_1, x_2, \\ldots, x_n\\) are available on \\(X | \\lambda\\). Suppose we observe \\(\\sum x_i = 13\\) when \\(n = 50\\). Based on the Poisson\\(-\\)Gamma model, the number of claims which arise in a year on a group of policies is modelled as \\(X|\\lambda \\sim Poisson(\\lambda)\\) and the prior distribution on the claim rate \\(\\lambda\\) is a \\(\\mathcal{G}(\\alpha,\\beta)\\) distribution. Calculate the value of the maximum likelihood estimate of \\(\\lambda\\) Calculate the values of prior means and the prior variance in two cases (i) the prior is \\(\\mathcal{G}(6,30)\\) and (ii) the prior is \\(\\mathcal{G}(2,10)\\). Comment on the results. For those two prior distributions, calculate the posterior mean of \\(\\lambda\\) given such data. Suppose the annual claims which arise under a risk, \\(X\\), in units of 1000THB, as \\(X | \\theta \\sim \\mathcal{N}(\\theta,0.36)\\). From experience with other business, an insurer adopt a \\(\\mathcal{N}(2, 0.04)\\) prior for \\(\\theta\\). The insurer observe claim amounts for the past seven years : \\(2369, 2341, 2284, 2347, 2332, 2300, 2267\\) THB. Using the normal\\(-\\)normal model: Find the credibility factor and the credibility premium for the risk. Find an equal-tailed 95% Bayesian interval estimate of \\(\\theta\\). Consider a collective of five separate risks from portfolios of general insurance policies, each of which has been in existence for at least ten years. The mean and variance of the aggregate claims adjusted for inflation over the past ten years are given in the table. Use EBCT Model 1 to calculate the credibility premiums for all five risks. Risk Within risk mean Within risk variance 1 138 259 2 98 179 3 120 239 4 104 168 5 119 185 Consider the aggregate claims in five successive years from comparable insurance policies (in units of 1000 THB). \\[TableRisks\\] Year \\(j\\) 1 2 3 4 5 Risk \\(i\\) 1 68 65 77 76 74 2 54 59 56 50 62 3 81 95 83 82 89 4 64 70 77 66 73 Use the EBCT Model 1 to calculate the credibility premium for each risk \\(i\\). Explain why the credibility premiums depend almost entirely on the means for the individual risks. 6.17 Solutions to Tutorial 9 Based on the lecture note, the data consist of \\(n\\) observations \\(x_1, x_2, \\ldots, x_n\\) of random variables \\(X_1, \\ldots , X_n\\), where, given \\(\\lambda\\), the \\(X_i\\) are iid Poisson random variables with parameter \\(\\lambda\\) for \\(i = 1,\\ldots,n\\). The likelihood is given by \\[ f(\\underline{x}|\\lambda) = \\Pi_{i=1}^n \\frac{e^{-\\lambda} \\lambda^{x_i}}{x_i!} \\propto e^{-n\\lambda} \\lambda^{\\sum x_i}. \\] Therefore, the data-based estimator of \\(\\lambda\\) based on the maximum likelihood estimator is \\[\\hat{\\lambda} = \\frac{\\sum_i x_i}{n} = \\frac{14}{6} = 2.3333333.\\] Without any data from the risk, a reasonable estimate value of \\(\\lambda\\) is the mean of the prior distribution with both parameters known and with density function \\[ f(\\lambda) = \\frac{\\beta^\\alpha}{\\Gamma(\\alpha)} \\lambda^{\\alpha -1} e^{-\\beta\\lambda}, \\quad \\alpha &gt;0, \\, \\beta &gt; 0, \\, \\lambda &gt; 0.\\] It follows that the estimate of \\(\\lambda\\) using the prior mean is \\[ \\tilde{\\lambda} = \\frac{\\alpha}{\\beta} = \\frac{6}{3} = 2.\\] The posterior density is proportional to \\[ \\begin{aligned} f(\\lambda| \\underline{x}) &amp;\\propto (\\lambda^{\\alpha -1} e^{-\\beta\\lambda}) (e^{-n\\lambda} \\lambda^{\\sum x_i}) \\\\ &amp;= \\lambda^{\\alpha + \\sum x_i -1} e^{-(\\beta + n) \\lambda} \\end{aligned} \\] This is the functional part of a gamma density. The posterior distribution is \\[ \\lambda | \\underline{x} \\sim \\mathcal{G}(\\alpha + \\sum x_i, \\beta + n) = \\mathcal{G}(20, 9).\\] The Bayesian estimator of \\(\\lambda\\) under the all or nothing loss is the mode of the distribution, which is given by \\[\\frac{19}{9} = 2.1111111.\\] Under absolute error loss, the median of\\(\\mathcal{G}(20, 9)\\) can be found by using the following R syntax \\[\\text{qgamma}(0.5, \\text{shape}= 20, \\text{rate}=9) = 2.1852969\\] Moreover, we can get \\[\\lambda_L = \\text{qgamma}(0.025, \\text{shape}= 20, \\text{rate}=9) = 1.3573911\\] and \\[\\lambda_U = \\text{qgamma}(0.975, \\text{shape}= 20, \\text{rate}=9) = 3.2967615.\\] The credibility estimate (i.e. the mean of \\(\\mathcal{G}(20, 9)\\)) is \\[ \\begin{aligned} \\lambda^* &amp;= \\frac{\\alpha + \\sum x_i}{ \\beta + n} = \\frac{20}{9} = 2.2222222. \\end{aligned}, \\] where \\(Z = n/(n+\\beta)\\). This can be expressed in the form of a credibility estimate. \\end{enumerate} From the Poisson-Gamma model, Therefore, the data-based estimator of \\(\\lambda\\) based on the maximum likelihood estimator is \\[\\hat{\\lambda} = \\frac{\\sum_i x_i}{n} = \\frac{13}{50} = 0.26.\\] For \\(\\lambda \\sim \\mathcal{G}(\\alpha,\\beta)\\), we have \\[\\text{E}[\\lambda] = \\frac{\\alpha}{\\beta} \\text{ and } \\text{Var}[\\lambda] = \\frac{\\alpha}{\\beta^2}.\\] For \\(\\mathcal{G}(6, 30)\\), the prior mean and prior variance are 0.2 and 0.0066667, respectively. For \\(\\mathcal{G}(2, 10)\\), the prior mean and prior variance are 0.2 and 0.02, respectively. The variance of the prior distributions are 0.0066667 and 0.02 in (i) and (ii), respectively. There is more uncertainty in the prior distribution of (ii) which leads to the prior mean getting lower weight. Therefore, \\(Z\\) should be larger in (ii). The posterior mean of \\(\\lambda\\) (also denoted by CP) is \\[ \\begin{aligned} \\text{CP} &amp;= (Z) \\left( \\frac{\\sum x_i}{n} \\right) +(1-Z) \\left( \\frac{\\alpha}{\\beta} \\right) \\end{aligned}, \\] where \\(Z = n/(n+\\beta)\\). This can be expressed in the form of a credibility estimate. In this case, \\(Z = \\frac{50}{50 + 30} = 0.625\\) and \\(\\text{CP} = 0.2375\\). In this case, \\(Z = \\frac{50}{50 + 10} = 0.8333333\\) and \\(\\text{CP} = 0.25\\). We have \\(\\sum_{i=1}^7 x_i = `r `sumx`\\). The credibility factor \\(Z\\) is given by \\[ Z = \\frac{n}{n + \\frac{\\sigma^2}{{\\sigma_0^2}}} = 0.4375.\\] The credibility premium is \\[\\text{CP} = Z\\cdot\\frac{\\sum x_i}{n} + (1-Z)\\cdot \\mu_0 = 2140.\\] The posterior probability distribution function is \\(\\mathcal{N}(\\mu^*,\\sigma^{*2})\\), where (in unit of 1000) \\[\\mu^* = 2.14 \\text{ and } \\sigma^{*2} = \\frac{\\sigma_0^2\\sigma^2}{n\\sigma_0^2 + \\sigma^2} = 0.0225.\\] Therefore, using the following R commands, \\[\\mu_L = \\text{qnorm}(0.025,2.14,\\sqrt{0.0225}) = 1.8460054,\\] and \\[\\mu_U = \\text{qnorm}(0.975,2.14,\\sqrt{0.0225}) = 2.4339946.\\] Not in the Final Examination. Not in the Final Examination. "],["project-2021-risk-theory.html", "Chapter 7 Project 2021 Risk Theory", " Chapter 7 Project 2021 Risk Theory Instructions Form a group of 2 members. You will receive R and Excel files for the project. Use R to generate an array of independent values \\(\\{\\{Z_{i \\,j} \\}_{j=1}^5 \\}_{i=1}^{1000}\\), each from a \\(U(0,1)\\) distribution (details are given below in the question section). Remember to set the argument to set.seed(xxxx) where the argument, xxxx, of the set.seed function is the final four digits of the lower student identification number, e.g. if students’ I.D. are 6105389 and 6105395, then use set.seed(5389). Then use your preferred software, EXCEL, R or other reasonable software to do the subsequent computation. In case that you choose to use EXCEL, you will need to copy and paste the array \\(\\{\\{Z_{i \\,j} \\}_{j=1}^5 \\}_{i=1}^{1000}\\) generated from R into EXCEL by hands. Each group submission consists of (1) a report in PDF format, together with print-outs of your calculations (also in PDF) and (2) an R or EXCEL file (one file only) with answers to questions with required numerical answers (i.e. excluding questions asking for comments). The report should not exceed four A4 pages in length (not including the print-outs of the calculations). The report, R (or EXCEL) file names should be in the format project6105389-6105395. Submit the group report and R (or Excel) files in Canvas to the student account with the lower student ID. Failure to personalize your project with set.seed will result in a project mark of 0. Columns or variable names in your print-out should be clearly labeled. When using EXCEL, R or any other reasonable software, to simulate values of the surplus using a translated gamma approximation, use the exact value of the parameters \\(\\alpha, \\beta\\) and \\(k\\) held by the software, not the rounded values presented in your report. For example, suppose you are using EXCEL to simulate \\(S(1)\\), that a \\(U(0,1)\\) value is held in cell A1 and your calculated values of \\(\\alpha, \\beta\\) and \\(k\\) are in cells A2, A3 and A4, respectively. Suppose further that the values of these parameters, to 5 decimal places, are 1.12345, 0.12345 and $-$123.12345. Note that EXCEL will be holding these values to a far greater degree of accuracy. To simulate a value of \\(S(1)\\), you should use the command = GAMMAINV(A1,A2,1/A3) + A4 not the command: = GAMMAINV(A1,1.12345,1/0.12345) \\(-\\) 123.12345. Questions Suppose the aggregate claims process for a portfolio \\(\\{ S(t) \\}_{t \\ge 0}\\) is a compound Poisson process with Poisson parameter 10 and individual claim amounts \\(X\\) have the following distribution \\(x\\) 10 100 500 1000 \\(\\Pr(X = x)\\) 0.5 0.3 0.15 0.05 In the simulations below, the seed number has been set to be set.seed(5377). Calculate the first three non-central moments of \\(X\\), i.e. \\(\\text{E}[X]\\), \\(\\text{E}[X^2]\\) and \\(\\text{E}[X^3]\\). \\[ \\begin{aligned} \\text{E}[X] &amp;= 10 \\cdot 0.5 + 100 \\cdot 0.3 + 500 \\cdot 0.15 + 1000 \\cdot 0.05 = 160 \\\\ \\text{E}[X^2] &amp;= 100 \\cdot 0.5 + 10^{4} \\cdot 0.3 + 2.5\\times 10^{5} \\cdot 0.15 + 10^{6} \\cdot 0.05 = 9.055\\times 10^{4} \\\\ \\text{E}[X^3] &amp;= 1000 \\cdot 0.5 + 10^{6} \\cdot 0.3 + 1.25\\times 10^{8} \\cdot 0.15 + 10^{9} \\cdot 0.05 = 6.90505\\times 10^{7}. \\\\ \\end{aligned} \\] Calculate the mean, variance and coefficient of skewness of the aggregate claims at time \\(t = 1\\), i.e. \\(\\text{E}[S(1)]\\), \\(\\text{Var}[S(1)]\\) and \\(\\text{Sk}[S(1)]\\). \\[ \\begin{aligned} \\text{E}[S(1)] &amp;= \\lambda \\text{E}[X] = 1600 \\\\ \\text{Var}[S(1)] &amp;= \\lambda \\text{E}[X^2] = 9.055\\times 10^{5} \\\\ \\text{Sk}[S(1)] &amp;= \\frac{\\lambda \\text{E}[X^3]}{(\\text{Var}[S(1)])^{3/2}} = 0.801372. \\\\ \\end{aligned} \\] Calculate \\(\\text{E}[S(5)]\\) and \\(\\text{Var}[S(5)]\\). \\[ \\begin{aligned} \\text{E}[S(5)] &amp;= 5 \\lambda \\text{E}[X] = 8000 \\\\ \\text{Var}[S(5)] &amp;= 5 \\lambda \\text{E}[X^2] = 4.5275\\times 10^{6}. \\\\ \\end{aligned} \\] Assume that \\(S(1)\\) can be approximated by \\(Y + k\\) where \\(Y \\sim \\mathcal{G}(\\alpha,\\beta)\\) and \\(k\\) is a constant. Calculate \\(\\alpha\\), \\(\\beta\\) and \\(k\\). \\[ \\begin{aligned} \\alpha &amp;= \\left(\\frac{2}{\\text{Sk}[S(1)]}\\right)^2 = 6.228618 \\\\ \\beta &amp;= \\sqrt{\\frac{\\alpha}{\\text{Var}[S(1)]}} = 0.0026227 \\\\ k &amp;= \\text{E}[S(1)] - \\frac{\\alpha}{\\beta} = -774.8712899. \\\\ \\end{aligned} \\] Comment on the values obtained in 4. The negativity of \\(k\\) implies that negative aggregate claims can occur in the approximation. This is an unrealistic effect of which we must be aware in what follows. The insurer sets the annual premium to be charged for this portfolio using the expected value principle (EVP) with the relative security loading \\(\\theta = 0.2\\) so that the annual premium before reinsurance is \\(c\\), where \\[c = ( 1 + \\theta)\\text{E}[S(1)].\\] Calculate the premium rate \\(c\\). \\[c = ( 1 + \\theta)\\text{E}[S(1)] =( 1 + \\theta)\\lambda \\text{E}[X] = 1920 .\\] Let \\(U(n)\\) denote the insurer’s surplus at time \\(n\\), \\(n = 1,2, \\ldots, 5\\) so that \\[U(n) = u + n c - S(n),\\] where \\(u\\) is the insurer’s initial surplus. Use R to generate an array of independent values \\(\\{\\{Z_{i \\,j} \\}_{j=1}^5 \\}_{i=1}^{1000}\\), each from a \\(U(0,1)\\) distribution. Remember to set the argument to set.seed(xxxx) where the argument, xxxx, of the set.seed function is the final four digits of your student identification number, e.g. if your student I.D. is 6105389, then use set.seed(5389). Then use your preferred software, EXCEL, R or other reasonable software to do the subsequent computation. In case that you choose to use EXCEL, you will need to copy and paste the array \\(\\{\\{Z_{i \\,j} \\}_{j=1}^5 \\}_{i=1}^{1000}\\) generated from R into EXCEL by hands. Let \\(\\hat{U_i}(5), \\, i = 1,2,\\ldots, 1000\\), denote the simulated surplus after five years calculated using the five values \\(Z_{i \\,1}, Z_{i \\,2}, \\ldots, Z_{i \\,5}\\) and the translated gamma approximations to \\(S(1), S(2) - S(1), \\ldots, S(5) - S(4)\\) as discussed in the lecture. Calculate \\(E[U(5)]\\) and \\(\\text{Var}[U(5)]\\), given that \\(u = 3500\\). \\[ \\begin{aligned} \\text{E}[U(5)] &amp;= \\text{E}[3500 + 5c - S(5)] = 5100 \\\\ \\text{Var}[U(5)] &amp;= \\text{Var}[3500 + 5c - S(5)] = \\text{Var}[S(5)] = 4.5275\\times 10^{6} \\\\ \\end{aligned} \\] Calculate \\(\\sum_{i=1}^{1000} \\hat{U_i}(5)/1000\\), given that \\(u = 3500\\). We have \\[\\sum_{i=1}^{1000} \\hat{U_i}(5)/1000 = 5171.9715293\\] Comment on your answers to questions 7 and 8. The value in 8 is an estimator for E[U(5)] based on an approximation by simulation and an approximation by the translated gamma distribution. The estimation error is relatively small, but not completely negligible, so our simulation results in this coursework must be interpreted with care. Estimate the ruin probabilities \\(\\psi_1(3500,5)\\) and \\(\\psi_1(4000,5)\\) from the simulated surplus paths \\((\\hat{U_i}(n))_{i = 1,2,\\ldots 1000, \\, n = 1,2, \\ldots, 5}\\). In the 1000 simulations, we observe 17 and 11 times a ruin. \\[ \\begin{aligned} \\psi_1(3500,5) &amp;= \\frac{17}{1000} = 0.017 \\\\ \\psi_1(4000,5) &amp;= \\frac{11}{1000} = 0.011. \\end{aligned} \\] Comment on your answers to questions 10, taking into consideration your answer to question 7. As expected from the theory, the probability of ruin is lower in the second case, where the initial capital is higher. The direct insurer is considering entering into an excess of loss reinsurance contract with retention \\(900\\). The reinsurer uses a relative security loading \\(\\theta_R\\) to calculate its reinsurance premium. After taking account of reinsurance, the subscript \\(I\\), for example \\(X_I\\), \\(S_I(1)\\), denotes the relevant quantities for the insurer. The probability of ruin for the insurer, checking for ruin at the end of each year for 5 years and given initial surplus 3500 is \\(\\psi_{I,1}(3500,5)\\). Calculate the first three non-central moments of \\(X\\), i.e. \\(\\text{E}[X_I]\\), \\(\\text{E}[X_I^2]\\) and \\(\\text{E}[X_I^3]\\). The distribution of claim amounts paid by the insurer, \\(F_{X_I}(x)\\) is given by \\(x\\) 10 100 500 900 \\(\\Pr(X_I = x)\\) 0.5 0.3 0.15 0.05 where \\(X_I = \\min(X,M)\\). Hence, \\[ \\begin{aligned} \\text{E}[X_I] &amp;= 10 \\cdot 0.5 + 100 \\cdot 0.3 + 500 \\cdot 0.15 + 900 \\cdot 0.05 = 155 \\\\ \\text{E}[X_I^2] &amp;= 100 \\cdot 0.5 + 10^{4} \\cdot 0.3 + 2.5\\times 10^{5} \\cdot 0.15 + 8.1\\times 10^{5} \\cdot 0.05 = 8.105\\times 10^{4} \\\\ \\text{E}[X_I^3] &amp;= 1000 \\cdot 0.5 + 10^{6} \\cdot 0.3 + 1.25\\times 10^{8} \\cdot 0.15 + 7.29\\times 10^{8} \\cdot 0.05 = 5.55005\\times 10^{7}. \\\\ \\end{aligned} \\] Calculate the mean, variance and coefficient of skewness of the aggregate claims \\(S_I(1)\\) at time \\(t = 1\\), i.e. \\(\\text{E}[S_I(1)]\\), \\(\\text{Var}[S_I(1)]\\) and \\(\\text{Sk}[S_I(1)]\\). \\[ \\begin{aligned} \\text{E}[S_I(1)] &amp;= \\lambda \\text{E}[X_I] = 1550 \\\\ \\text{Var}[S_I(1)] &amp;= \\lambda \\text{E}[X_I^2] = 8.105\\times 10^{5} \\\\ \\text{Sk}[S_I(1)] &amp;= \\frac{\\lambda \\text{E}[X_I^3]}{(\\text{Var}[S_I(1)])^{3/2}} = 0.7606193. \\\\ \\end{aligned} \\] Assume that \\(S_I(1)\\) can be approximated by \\(Y_I + k_I\\) where \\(Y_I \\sim \\mathcal{G}(\\alpha_I,\\beta_I)\\) and \\(k_I\\) is a constant. Calculate \\(\\alpha_I\\), \\(\\beta_I\\) and \\(k_I\\). \\[ \\begin{aligned} \\alpha_I &amp;= \\left(\\frac{2}{\\text{Sk}[S_I(1)]}\\right)^2 = 6.9139344 \\\\ \\beta_I &amp;= \\sqrt{\\frac{\\alpha_I}{\\text{Var}[S_I(1)]}} = 0.0029207 \\\\ k_I &amp;= \\text{E}[S_I(1)] - \\frac{\\alpha_I}{\\beta_I} = -817.2228178. \\\\ \\end{aligned} \\] Calculate \\(E[U_I(5)]\\) and \\(\\text{Var}[U_I(5)]\\), given that \\(u = 3500\\) and assuming: \\(\\theta_R = 3\\theta\\). \\(\\theta_R = 2\\theta\\). \\(\\theta_R = \\theta\\). The insurer’s surplus process can be calculated from \\[ U_I(t) = u + (c - c_r)t - S_I(t),\\] where \\(c_R = (1 + \\theta_R)\\text{E}[S - S_I]\\) is the reinsurance premium rate. For \\(\\theta_R = 3\\theta\\), \\[ \\begin{aligned} \\text{E}[U_I(5)] &amp;= \\text{E}[U(0) + 5(c - c_R) - S_I(5)] = 4950 \\\\ \\text{Var}[U_I(5)] &amp;= \\text{Var}[U(0) + 5(c - c_R) - S_I(5)] = \\text{Var}[S_I(5)] = 4.0525\\times 10^{6}. \\\\ \\end{aligned} \\] For \\(\\theta_R = 2\\theta\\), \\[ \\begin{aligned} \\text{E}[U_I(5)] &amp;=5000 \\\\ \\text{Var}[U_I(5)] &amp;= 4.0525\\times 10^{6}. \\\\ \\end{aligned} \\] For \\(\\theta_R = 1\\theta\\), \\[ \\begin{aligned} \\text{E}[U_I(5)] &amp;=5050 \\\\ \\text{Var}[U_I(5)] &amp;= 4.0525\\times 10^{6}. \\\\ \\end{aligned} \\] It should be emphasised that the value of \\(\\text{Var}[U_I(5)]\\) is not affected by the (net) premium income and so is not affected by the values of \\(\\theta\\) or \\(\\theta_R\\). Using \\(\\{\\{Z_{i \\,j} \\}_{j=1}^5 \\}_{i=1}^{1000}\\) and the translated gamma approximation, estimate \\(\\psi_{I,1}(3500,5)\\) assuming: \\(\\theta_R = 3\\theta\\). \\(\\theta_R = 2\\theta\\). \\(\\theta_R = \\theta\\). For \\(\\theta_R = 3\\theta\\), \\(\\theta_R = 2\\theta\\) and \\(\\theta_R = 1\\theta\\), in the 1000 simulations, we observe 14, 13 and 13 times a ruin, respectively. \\[ \\begin{aligned} \\psi_1(3500,5) &amp;= \\begin{cases} 0.014, &amp; \\text{ if } \\theta_R = 3\\theta \\\\ 0.013, &amp; \\text{ if } \\theta_R = 2\\theta \\\\ 0.013, &amp; \\text{ if } \\theta_R = 1 \\theta. \\end{cases} \\end{aligned} \\] 0.014, 0.013 0.013, Comment on your answers to questions 10 and 16, taking into consideration the answers to question 15. The excess of loss reinsurance has reduced the amount of the largest possible claim. This makes the portfolio much safer for the insurer. However, the standard deviation of the surplus at the end of 5 years has been reduced by only a factor of about 1.0569823. This reduced risk is reflected in the ruin probabilities, which are smaller than the value in question 10. The more expensive the reinsurance (= the higher the value of \\(\\theta_R\\)), the lower the insurer’s net premium income and the higher the (estimated) ruin probability. This reduced risk is “paid for” by the insurer’s expected surplus. This has fallen substantially (from 5100 to 4950 (\\(\\theta_R = 3 \\theta\\)) and to 5050 (\\(\\theta_R = \\theta\\))). Clearly, the insurer would prefer \\(\\theta_R = \\theta\\), as this implies the lowest cost of reinsurance and hence the highest expected net surplus and the lowest probability of ruin. Suppose that \\(\\theta_R = 2\\theta\\). Estimate the probability of ruin \\(\\psi_{I,1}(3500,5)\\) for the reinsurer, given the retention limit is \\(M = 550, 600, 650, \\ldots, 900\\). Identify the largest \\(M \\in \\{550, 600, 650, \\ldots, 900 \\}\\) such that the corresponding estimated probability of ruin is not greater than 1%. The estimates the probability of ruin \\(\\psi_{I,1}(3500,5)\\) for the reinsurer, given the retention limit is \\(M = 550, 600, 650, \\ldots, 900\\) are 0.01, 0.01, 0.01, 0.011, 0.011, 0.011, 0.011, 0.013. Hence, the largest \\(M \\in \\{550, 600, 650, \\ldots, 900 \\}\\) such that the corresponding estimated probability of ruin is not greater than 1% is \\(M = 650\\). The results are also illustrated in the figure below. Comment on your answers to questions 18. It is possible to get the estimated probability of ruin below 1% even in the case that the reinsurance is “expensive”, i.e. the reinsurance risk loading is higher than the risk loading the insurer charges on the original insurance contracts. While before reinsurance the average profit per year was \\(c - \\text{E}[S(1)] = ((1+\\theta)−1) \\times \\text{E}[S(1)] = 320\\). To run a sustainable business in the long run, the annual cost of capital should not be higher than the average annual profit, i.e. not higher than \\[ \\frac{320}{3500} = 9.1428571\\%.\\] This return looks large enough to attract investors. With the results in 18, adding excess of loss reinsurance with \\(\\theta_R = 2\\theta\\) and the retention limit \\(M = 650\\) reduces the average profit to \\[ c - c_R - \\text{E}[S_I(1)] = (1+\\theta) \\text{E}[S(1)] - (1+\\theta_R) ( \\text{E}[S(1)] - \\text{E}[S_I(1)]) - \\text{E}[S_I(1)]) = 250.\\] The insurer can still make a profit provided the surplus will drift to \\(\\infty\\), but ruin could still occur. The rate at which premium income comes in is greater than the rate at which claims are paid out and reinsurance premium charged. It should be noted that the average profit per year after the excess of loss reinsurance with \\(\\theta_R = 2\\theta\\) is an increasing function of \\(M\\) as shown in the figure below: "],["interactive-lecture.html", "Chapter 8 Interactive Lecture 8.1 DataCamp Light", " Chapter 8 Interactive Lecture Some significant applications are demonstrated in this chapter. 8.1 DataCamp Light By default, tutorial will convert all R chunks. eyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiJhIDwtIDJcbmIgPC0gM1xuYSArIGIifQ== eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImxpYnJhcnkoc3RhdHMpXG5saWJyYXJ5KE1BU1MpXG5saWJyYXJ5KGdncGxvdDIpXG5kYXQgPC0gYygzMS4wODk0MjE1Niw5MTUuMDI1OTM2MiwzMi4wMjM3OTU2Miw4ODUuODc1NDUxLDkzMTQuMTAwNzk3LDcwNy4xNzM4ODY2LDIxMTQuMzYyNDg2LDYwMS41ODI3ODY2LDQzNS4zNzg4MTM1LDQ5LjgwMTc5NjE5LDE4MDIuMzgzODIsMjExLjYzNjQzOSwxNTMuNTk4NDcxOSw2MC4wNTk2Njk5Miw0OC4xNzE1NzY5Nyw5NDguNzIzNDYyNiwxMzIuNDI3MzEwOSwxNTEuNzEwODE1LDI5NjcuOTYxMDM2LDczNS40MTQ5MzMyLDMwNC41ODA3NTg3LDUwLjUzMzExMDY5LDIyNC43NjY1NTQ2LDM1Ni4xODA5NDM4LDQ3NS43NjY4NDQxLDMwNDQuMTQ5NTEzLDEzLjUwNjY0ODk0LDY3Ljk4Mjc0NDQ5LDMwNC4xNDM5OTY2LDIzOC4wMDAxMDUsMzk5LjA3OTgyNjMsMTQ5LjI4MDc4LDEyOC4yODQ4Mzc5LDIxLjQyMDI3NzE4LDczLjMxNDI2NzMyLDQ5LjQ2ODgyNzkxLDY2Ny41MzI3Mjc1LDQ0LjY3MzYwMTg1LDE0ODk0LjA3ODM5LDY2MC43NjE0MzA3LDEwMC43NjI4NjI4LDYzMi4yODEyMzkxLDQyLjkwODg0Nzc3LDY2LjE3NjkzMTM1LDUwLjY5NDU0MTMyLDE4Ni44NzgxNjY3LDE2OC41NDA4NjE1LDE1MS43Mzk5NzgsMjQxOS41MzIzNTQsNDM0LjQ1NjQwMzIsNjkuMDM0NjAyMzIsMTYyLjY2OTg1OTMsMjI2LjYxMTAzOTUsMzMuNjE1MDM0OTUsMjMzLjAyNzk5NiwzMjQ0Ljk0NTg5MywzNTQuMjUzNDgxMyw3OC42MTA1Mjc0NCwyMzEuNTY2NjE0LDI4My4wMjA2NDkxLDQ1Ny42Nzg1NDI2LDEzNC4yOTMzMDU4LDYxLjM0MjY1MDYzLDM4LjI1NjkxOTEyLDE1NzguOTA5MDQ4LDQ0MS42MTk5ODI2LDc2MS40MTc3Nzc3LDI3NS42OTc4NTg4LDUyMS4wMzU1OTE2LDIxODkuNjI3ODMsMTE3LjI2Njc4ODUsMjQwLjM0MDMxNTMsNjcyLjQ1MTI5MzgsNzUzLjg5NTgwMTksODQuOTg4ODMwNzksMzY2NS40MTc5NzYsNjAuMzU5Nzc1MTUsNC4wMTkzMzMwOSwxNC45NTk1MTM2NiwxOTYuNzE0NjQwMywxNTMuNzEzMzE2NSw5OC4zMTg3NTA1MywxMDQuNDQ4NjMyNCwzNTguOTIwNTg3OCwyLjI1NDk4NjMzMSwyMDU5LjYwMzk1OSwzNy42Mzg5ODYwOCw1Ni40ODk0NDAzNSwxMTQzLjA4Mjk0OCw0MTAuNzU4NTUxNiwxMi42NTQwMjk4NiwxOS44MzMyMjUxNCwxMzA1LjEzNDc5NywyMDE5LjM2MDczNSwxMjg2Ljk4NDc5LDg4OTIuMTgyMTMxLDUuODE0NTE4NzQ5LDI5Ni4xNTUxMjk1LDg2Ljc1MzA4MTYxLDQ4Ni43ODUxNDA1LDcuNDkxMzg5Nzk4LDE4MC4zMjU1MjgxLDE0MTQuMjk3NzQ4LDUyNC40NjI4MjA4LDEwNDIuNjkwMzM0LDEyOTEuNDgxNDc0LDExNS40OTUwOTk4LDM2MC42MzEwNzM3LDMyMzMuNzE2ODM4LDE0OS41MTkxMDM5LDguODQ1ODM3NDczLDgzLjg3Mjk2MzI0LDQyLjk5NjE0NTE3LDYyMy45NzA0ODUzLDQ1Ljc0OTkwMDc0LDE0NC4yNDQ5NzkzLDM2OC41NzU2NDIsODY2LjkyNzI1NDUsNTcuNjE1OTI5MjEsMTgxMi4yMzEzMTUsMjIyOS45OTg3NTQsMzQ0OC4zMzI4ODgsMTEzMTMuMzQ3MjEsMTQ5Mi40OTg4NTYsMTk2LjcyNjI1NzEsNzEuMTE4MTc2MDEsNDI1LjA2MTQ0ODMsMzguMjg2NTMwNDgsNDQuNTA5MDAxNiwzMDguODc4MTY1NywxOTA4MC41MTc0OSw4Mi4wNzYxMzkzLDI1MC4wODM1MjMsNzkuMDc0OTIwNDIsMTgzLjg2OTc2ODYsMzMuODMxNjAzOTEsMjIuNzgyMTgyOTksNjk4Ljk1NDE2NDgsMzIuNzU0MjcwMDMsNDU3LjAxMDQ5MTksMTEyLjE3MTU1NjcsMzk2LjcxNTUyMzQsMTk1LjAyNDA3ODEsMTg2My4xODUzODUsMTgxLjY0NDExMjEsNTkuMDg3MzM2NTUsOTYuMzkwMDQxOTEsODI0LjczMDE4NCwxNTUuODIxNTE2MiwxMS44NTUxMDY2MSw4NzAuODY3OTUwMiw0MjUuMzEzMzA0NSw4NTQuNzI5NjQ3NCwyNTQuMzEwODg5Miw2NjQuMzMyMDEwNyw1Ni4yNjEyMDc1MiwzNzguMjQ0MDE2LDIwNjkuNDMxNDk1LDMxMjEuMDkwMSw4NDQuNDMzNzU5NCw3NDYuMzg1MzY3NSwxODUxLjQ2OTYzMyw0MzEuNzA2MDIzMiwzMzMuMzI1NDgxLDIyLjIzOTcwMTAyLDY2Mi4zODE2ODg4LDExNy43NTkwMDU3LDU3MC40NDEyODI5LDExMjcuMDM1MzA2LDI0Ni4yNjg2MTgzLDE0NjcuNTY4ODY3LDM0Ljg5MTg3MTEyLDIzNy41NzYxNjkzLDM0OS40NTAzOTY3LDIyOS4zMzYyODQ5LDkzNC42OTI2NTYxLDE2Mi45MjU0NDA4LDU4LjI4NDk3MTcyLDEyODAzLjA0NzI2LDE1Ljk0OTA0MTg5LDk1OS45NTQzNDAyLDU4NTMuODc4OTc5LDUzNy4zOTc0MjUzLDc1LjMwNTcyODgzLDcxOC42NTk3NTIxLDYzMy44MjE0NDM4LDM2My4wMzM4MDc2LDk1Ljg0NzYyNjYsODAuMzE3ODY1MywyODYuNzEyMTc2Myw2MzY3LjQ1MzQwOCwzMjEuNTY3NzExLDIxLjUxODM4MDIyLDU5OS40NzEyOTU4LDI0Ni43MDA3MDczLDEzODYzLjc4MTgxLDIxNC43MzQyNTk3LDIzNC4zMjEyOTUyLDk1OC45MTYxNzksMTY1LjI1MjEzODUpXG5kYXQgPC0gZGF0YS5mcmFtZShjbGFpbXMgPSBkYXQpIiwic2FtcGxlIjoiIyBGaWxsIHlvdXIgY29kZSBoZXJlXG5uYW1lcyhkYXQpIiwic29sdXRpb24iOiJnZ3Bsb3QoZGF0KSArIFxuICBnZW9tX2hpc3RvZ3JhbShhZXMoeCA9IGNsYWltcywgeSA9IC4uZGVuc2l0eS4uKSwgYmlucyA9IDkwICwgZmlsbCA9IFwiZ3JleVwiLCBjb2xvciA9IFwiYmxhY2tcIikgKyBcbiAgc3RhdF9mdW5jdGlvbihmdW49ZGV4cCwgZ2VvbSA9XCJsaW5lXCIsIGFyZ3MgPSAocmF0ZSA9IDEvbWVhbihkYXQkY2xhaW1zKSksIGFlcyhjb2xvdXIgPSBcIkV4cFwiKSkgK1xuICBzY2FsZV9jb2xvcl9kaXNjcmV0ZShuYW1lPVwiRml0dGVkIERpc3RyaWJ1dGlvbnNcIikifQ== "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
